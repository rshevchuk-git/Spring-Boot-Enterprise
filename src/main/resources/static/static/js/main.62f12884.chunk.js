(this["webpackJsonpb1.0"]=this["webpackJsonpb1.0"]||[]).push([[0],{165:function(e,t,r){},21:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"g",(function(){return a})),r.d(t,"k",(function(){return o})),r.d(t,"o",(function(){return i})),r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return c})),r.d(t,"q",(function(){return l})),r.d(t,"j",(function(){return d})),r.d(t,"s",(function(){return u})),r.d(t,"u",(function(){return m})),r.d(t,"t",(function(){return b})),r.d(t,"r",(function(){return p})),r.d(t,"b",(function(){return j})),r.d(t,"e",(function(){return v})),r.d(t,"d",(function(){return f})),r.d(t,"a",(function(){return O})),r.d(t,"p",(function(){return h})),r.d(t,"f",(function(){return g})),r.d(t,"n",(function(){return x})),r.d(t,"m",(function(){return y})),r.d(t,"l",(function(){return w}));var n="ADD_ORDER",a="LOAD_ORDERS",o="SET_AUTHENTICATED",i="SET_UNAUTHENTICATED",s="RESET_SELECTIONS",c="SELECT_CUSTOMER",l="UNSELECT_CUSTOMER",d="SET_ACTIVE_SORTING",u="UPDATE_MAIN_SORTING",m="UPDATE_SORT_SORTING",b="UPDATE_PAYMENT_SORTING",p="UPDATE_FILTER_SORTING",j="ADD_MAIN_SORTING",v="ADD_SORT_SORTING",f="ADD_PAYMENT_SORTING",O="ADD_FILTER_SORTING",h="SHOW_CUSTOMER_MODAL",g="CLOSE_CUSTOMER_MODAL",x="SET_MAIN_TAB",y="SET_FILTER_OPENED",w="SET_FILTER_CLOSED"},225:function(e,t,r){},226:function(e,t,r){},382:function(e,t,r){},402:function(e,t,r){"use strict";r.r(t);var n=r(30),a=r(7),o=r(21),i={mainPageOrderList:[],sortPageOrderList:[],isLoading:!0};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.c:return Object(a.a)(Object(a.a)({},e),{},{mainPageOrderList:[].concat(Object(n.a)(e.mainPageOrderList),[t.payload]),sortPageOrderList:[].concat(Object(n.a)(e.sortPageOrderList),[t.payload])});case o.g:return t.payload?Object(a.a)(Object(a.a)({},e),{},{mainPageOrderList:t.payload,sortPageOrderList:t.payload,isLoading:!1}):e;default:return e}}},404:function(e,t,r){},407:function(e,t,r){},411:function(e,t,r){},412:function(e,t,r){},413:function(e,t,r){},414:function(e,t,r){"use strict";r.r(t);var n=r(34),a=r(7),o=r(1),i=r(241),s=r(481),c=r(242),l=r(482),d=r(240),u=r(49),m=r(485),b=r(0),p=r.n(b),j=r(27),v=r.n(j),f=r(243),O=r(490),h=r(148),g=r(227),x=r(16),y=r(93),w=r(40),N=r(11),S=r(120),C=r(122),k=r(473),T=(r(165),r(467)),_=r(425),I=r(121),L=r(465),E=r(466),D=r(468),R=r(88),F=r.n(R),M=r(9),P=r(12),A=(r(382),r(51)),Q=r(5),B=r(244),K=r(486),U=r(151),z=r(21),q=function(e,t,r,n,a,o){return{type:z.k,payload:{token:e,employee:t,customer:r,username:n,roles:a,fullName:o}}},G=function(e){return{type:z.j,payload:e}},H=function(e,t){var r;switch(t){case"main":r=z.s;break;case"sort":r=z.u;break;case"payment":r=z.t;break;case"filter":r=z.r}return{type:r,payload:e}},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:z.p,payload:e}},V=function(e){return{type:z.n,payload:e}},J=function(){return{type:z.f}};function $(e){e.m2=(e.width*e.height/1e6*e.amount).toFixed(3)||0}var Y=function(e,t,r){e.price>=0?t.shrink||r({shrink:!0}):t.shrink&&r({shrink:!1})},X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((function(e){return 0===e.orderId?(e.id=t,e.customerId=t):e.id=e.customerId,e}))},Z=function(e){return $(e),e.m2>0?Math.ceil(+e.m2*e.price+ +e.fees):Math.ceil(e.price*e.amount+ +e.fees)},ee=Object(Q.a)({root:{"& .MuiInputLabel-marginDense":{transform:"translate(14px, 9px) scale(1)"},"& .MuiInputLabel-shrink":{transform:"translate(14px, -4px) scale(0.75)"},"& .MuiAutocomplete-endAdornment":{top:"inherit"},"& .MuiAutocomplete-inputRoot[class*='MuiOutlinedInput-root'] .MuiAutocomplete-endAdornment":{right:5}},inputRoot:{'&&[class*="MuiOutlinedInput-root"] $input':{padding:2},'&&[class*="MuiOutlinedInput-root"]':{paddingRight:"40px!important"}},input:{}})(K.a);var te=function(e){var t=e.label,r=e.getName,n=e.sortKey,i=e.error,s=e.validator,c=e.kindNameSetter,l=void 0!==c&&c,d=e.typeNameSetter,u=void 0!==d&&d,m=e.setEntrepreneur,b=void 0!==m&&m,p=e.setDimensions,j=void 0!==p&&p,v=e.setPrice,f=void 0!==v&&v,O=e.action,g=void 0!==O&&O,y=e.sortPage,w=void 0===y?"":y,N=(e.textFieldProps,Object(A.a)(e,["label","getName","sortKey","error","validator","kindNameSetter","typeNameSetter","setEntrepreneur","setDimensions","setPrice","action","sortPage","textFieldProps"])),S=N.form.setFieldValue,C=Object(M.f)().values.order,k=Object(U.a)(N),T=Object.assign({},k),_=T.name,I=Object(x.b)(),L=Object(h.b)();return Object(o.jsx)(ee,Object(a.a)(Object(a.a)({},N),{},{size:"small",error:"",value:T.value,autoHighlight:!0,getOptionLabel:r,onKeyPress:function(e){"="!==e.key&&"+"!==e.key||(e.preventDefault(),g&&g())},onChange:function(e,t){if(n){var r={};r[n]=t,I(function(e,t){var r;switch(t){case"main":r=z.b;break;case"sort":r=z.e;break;case"payment":r=z.d;break;case"filter":r=z.a}return{type:r,payload:e}}(r,w))}if(b){var o,i=(null===(o=L.getQueryData("ce-links").find((function(e){return e.customer.customerId===(null===t||void 0===t?void 0:t.customerId)})))||void 0===o?void 0:o.entrepreneur)||null;S("order.entrepreneur",i)}if(S(_,t),f){var c,l,d;if(!t)return;var u,m,p=C.width,v=C.height;if(t.customerId)l=t.customerId,d=null===(u=C.orderKind)||void 0===u?void 0:u.kindId;else l=null===(m=C.customer)||void 0===m?void 0:m.customerId,d=t.kindId,p=t.width||p,v=t.height||v;if(!l||!d)return;var O=(null===(c=L.getQueryData("cp-links").find((function(e){var t,r;return(null===(t=e.customer)||void 0===t?void 0:t.customerId)===l&&(null===(r=e.orderKind)||void 0===r?void 0:r.kindId)===d})))||void 0===c?void 0:c.price)||0;S("order.price",O);var h=Z(Object(a.a)(Object(a.a)({},C),{},{price:O,width:p,height:v}));h&&S("order.finalSum",h)}j&&t&&t.width&&t.height&&(S("order.width",t.width),S("order.height",t.height)),s(_)},renderInput:function(e){return Object(o.jsx)(B.a,Object(a.a)(Object(a.a)({},e),{},{error:!!i,onChange:function(e){u?u(e.target.value):l&&l(e.target.value)},label:t,variant:"outlined"}))}}))},re=r(17),ne=r.n(re),ae=r(29),oe=r.n(ae),ie=r(45),se=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r,n;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.a.post("/api/auth/signin",t);case 2:return r=e.sent,n=r.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){he.dispatch({type:z.o}),he.dispatch({type:z.h})},le={isAuthenticated:!1,loggedUser:null,customer:null,roles:[]};var de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z.k:return localStorage.setItem("token",t.payload.token),localStorage.setItem("username",t.payload.username),localStorage.setItem("fullName",t.payload.fullName),localStorage.setItem("roles",t.payload.roles),t.payload.customer?localStorage.setItem("customer",JSON.stringify({customerId:t.payload.customer.customerId,customerName:t.payload.customer.customerName,money:t.payload.customer.money})):localStorage.setItem("customer",null),localStorage.setItem("loggedUser",JSON.stringify(t.payload.employee)),ne.a.defaults.headers.common.Authorization="Bearer ".concat(t.payload.token),ne.a.interceptors.response.use((function(e){return e}),(function(e){var t;throw 401===(null===(t=e.response)||void 0===t?void 0:t.status)?ce():console.error(e),e})),{isAuthenticated:!0,loggedUser:t.payload.employee,customer:t.payload.customer,roles:t.payload.roles};case z.o:return localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("fullName"),localStorage.removeItem("roles"),localStorage.removeItem("customer"),localStorage.removeItem("loggedUser"),le;default:return e}},ue={customer:null,status:null,dateFrom:null,dateTill:null,orderKind:null,orderType:null,employee:null,details:""},me={entrepreneur:null,customer:null,status:null,employee:null,dateFrom:null,dateTill:null,payDateFrom:null,payDateTill:null,orderKind:null,orderType:null,receiver:""},be={active:"main",mainTab:0,main:ue,sort:ue,payment:ue,filter:me,filterTab:!1};var pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z.h:return be;case z.j:return Object(a.a)(Object(a.a)({},e),{},{active:t.payload});case z.b:return Object(a.a)(Object(a.a)({},e),{},{main:Object(a.a)(Object(a.a)({},e.main),t.payload)});case z.e:return Object(a.a)(Object(a.a)({},e),{},{sort:Object(a.a)(Object(a.a)({},e.sort),t.payload)});case z.d:return Object(a.a)(Object(a.a)({},e),{},{payment:Object(a.a)(Object(a.a)({},e.payment),t.payload)});case z.a:return Object(a.a)(Object(a.a)({},e),{},{filter:Object(a.a)(Object(a.a)({},e.filter),t.payload)});case z.s:return Object(a.a)(Object(a.a)({},e),{},{main:t.payload});case z.u:return Object(a.a)(Object(a.a)({},e),{},{sort:t.payload});case z.t:return Object(a.a)(Object(a.a)({},e),{},{payment:t.payload});case z.r:return Object(a.a)(Object(a.a)({},e),{},{filter:t.payload});case z.n:return Object(a.a)(Object(a.a)({},e),{},{mainTab:t.payload});case z.m:return Object(a.a)(Object(a.a)({},e),{},{filterTab:!0});case z.l:return Object(a.a)(Object(a.a)({},e),{},{filterTab:!1});default:return e}},je={customerId:0,customerName:"",customerGroup:"",money:0,payLog:"",debtor:!1,city:"",info:"",firstPerson:"",firstPhone:"",firstEmail:"",secondPerson:"",secondPhone:"",secondEmail:"",thirdPerson:"",thirdPhone:"",thirdEmail:""},ve={show:!1,customer:je};var fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z.p:return{show:!0,customer:t.payload};case z.f:return{show:!1,customer:{}};default:return e}},Oe=r(174),he=(0,Oe.createStore)((0,Oe.combineReducers)({auth:de,orders:r(402).default,sortSelections:pe,showCustomerModal:fe})),ge=r(494);var xe=r(492),ye=r(488);var we=function(e){var t=e.open,r=e.onClose,n=e.message;return"success"===e.type?Object(o.jsx)(xe.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t,autoHideDuration:3e3,onClose:r,children:Object(o.jsx)(ye.a,{onClose:r,variant:"filled",severity:"success",children:n})}):Object(o.jsx)(xe.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t,autoHideDuration:3e3,onClose:r,children:Object(o.jsx)(ye.a,{onClose:r,variant:"filled",severity:"error",children:n})})},Ne=Object(Q.a)({root:{"& .MuiInputLabel-marginDense":{transform:"translate(14px, 9px) scale(1)"},"& .MuiOutlinedInput-input":{padding:8},"& .MuiInputLabel-shrink":{transform:"translate(14px, -4px) scale(0.75)"}}})(B.a),Se=function(e){var t=e.label,r=e.field,n=e.error,i=e.readonly,s=void 0!==i&&i,c=e.validator,l=e.disableCalculation,d=void 0!==l&&l,u=e.numeric,m=void 0===u||u,b=e.phone,p=void 0!==b&&b,j=Object(A.a)(e,["label","field","error","readonly","validator","disableCalculation","numeric","phone"]),v=j.form.setFieldValue,f=Object(M.f)().values,O=r.onChange,h=r.name;return Object(o.jsx)(Ne,Object(a.a)(Object(a.a)(Object(a.a)({},j),r),{},{error:!!n,size:"small",variant:"outlined",autoComplete:"off",label:t,InputProps:{readOnly:s},onChange:function(e){m||O(e),(e.target.value.match(/^\d*\.?\d*$/)||0===e.target.value.length)&&O(e),c(h)},onKeyUp:function(e){if(m&&!p&&f.order&&!d){$(f.order);var t=Z(f.order);t&&v("order.finalSum",t)}}}))},Ce={kindId:0,typeId:0,kindName:"",width:0,height:0},ke={orderId:0,billNo:0,date:"",employee:{userID:60},entrepreneur:null,customer:null,orderType:null,orderKind:null,width:0,height:0,amount:0,m2:0,price:0,fees:0,finalSum:0,paySum:0,status:{id:1},comment:""},Te={typeId:0,typeName:""},_e=r(420),Ie=r(419),Le=function(e){var t=e.label,r=e.isChecked,n=Object(A.a)(e,["label","isChecked"]),i=Object(M.e)(n),s=Object(N.a)(i,1)[0];return Object(o.jsx)(_e.a,{control:Object(o.jsx)(Ie.a,Object(a.a)(Object(a.a)(Object(a.a)({},n),s),{},{checked:r,color:"primary"})),label:t})},Ee=Object(I.a)((function(){return{root:{display:"flex",flexWrap:"wrap",borderRadius:4,backgroundColor:"white",margin:"0 auto",width:"52%"},lock:{padding:0,width:"5px",backgroundColor:"white !important",minWidth:0,"&:hover":{backgroundColor:"white"}},svg:{fill:"rgba(0, 0, 0, 0.23)","&:hover":{fill:"black"}},clear:{backgroundColor:"#fff",minWidth:0,justifySelf:"flex-end",margin:"0px 0px 1px 0",width:"2.4rem"}}})),De=P.c({order:P.c({entrepreneur:P.c().required(),customer:P.c().required(),orderType:P.c().required(),orderKind:P.c().required(),width:P.b().lessThan(2e9).positive().min(0).required(),height:P.b().lessThan(2e9).positive().min(0).required(),amount:P.b().lessThan(2e9).positive().min(0).required(),price:P.b().lessThan(2e9).positive().min(0).required(),fees:P.b().lessThan(2e9).positive().min(0).required(),finalSum:P.b().lessThan(2e9).positive().min(0).required(),comment:P.d().trim().max(255).required()})});function Re(){var e=Ee(),t=Object(x.b)(),r=Object(h.b)(),n=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.post("/api/orders/",e.newOrder)}),{onSuccess:function(t,r){r.setStatus({success:!0,error:!1}),e.invalidateQueries(["customers"]),r.isReset?he.dispatch(H(Object(a.a)({},ue),"main")):e.invalidateQueries(["orders"]),r.resetForm()},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),i=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.get("/api/ce-links/"+e.customerId+"/"+e.entrepreneurId)}),{onSuccess:function(t,r){e.invalidateQueries("ce-links"),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),s=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.get("/api/cp-links/"+e.customerId+"/"+e.orderKindId+"/"+e.price)}),{onSuccess:function(t,r){e.invalidateQueries("cp-links"),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),c=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.post("/api/order-kinds/",e.orderKind)}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(t,r){r.orderType.orderKinds.push(t.data),e.invalidateQueries(["orderTypes"]),r.setStatus({success:!0,error:!1})}})}(),l=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.post("/api/order-types/",e.orderType)}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(t,r){e.invalidateQueries(["orderTypes"]),r.setStatus({success:!0,error:!1})}})}(),d=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.put("/api/order-kinds/",e.orderKind)}),{onSuccess:function(t,r){e.invalidateQueries("orderTypes"),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),u=Object(b.useState)({}),m=Object(N.a)(u,2),p=m[0],j=m[1],v=Object(b.useState)({success:!1,error:!1}),f=Object(N.a)(v,2),O=f[0],g=f[1],y=Object(b.useState)({success:!1,error:!1}),w=Object(N.a)(y,2),S=w[0],k=w[1],I=Object(b.useState)({success:!1,error:!1}),R=Object(N.a)(I,2),P=R[0],A=R[1],Q=Object(b.useState)({success:!1,error:!1}),B=Object(N.a)(Q,2),K=B[0],U=B[1],z=Object(b.useState)({success:!1,error:!1}),q=Object(N.a)(z,2),G=q[0],V=q[1],J=Object(b.useState)({success:!1,error:!1}),$=Object(N.a)(J,2),X=$[0],Z=$[1],ee=Object(b.useState)(""),re=Object(N.a)(ee,2),ae=re[0],oe=re[1],ie=Object(b.useState)(""),se=Object(N.a)(ie,2),ce=se[0],le=se[1],de=function(){g({success:!1,error:!1}),k({success:!1,error:!1}),A({success:!1,error:!1}),U({success:!1,error:!1}),Z({success:!1,error:!1}),V({success:!1,error:!1})},me=function(){t(W(Object(a.a)({},je)))},be=function(){0!==ce.trim().length?l.mutate({orderType:Object(a.a)(Object(a.a)({},Te),{},{typeName:ce}),setStatus:V}):V({success:!1,error:!0})},pe=function(e,t,a){var o,i;o=e.isUrgently,i=e.order,o&&(.15*i.finalSum<10?i.finalSum=+i.finalSum+10:i.finalSum=Math.ceil(1.15*i.finalSum),i.comment="(\u0422\u0435\u0440\u043c\u0456\u043d\u043e\u0432\u043e) "+i.comment),function(e,t){t.status=e?r.getQueryData("statuses").find((function(e){return 1===e.id})):r.getQueryData("statuses").find((function(e){return 2===e.id}))}(e.onAcceptance,e.order),n.mutate({newOrder:e.order,isReset:e.clearFields,resetForm:e.clearFields?t:function(){return ve(e.order,a)},setStatus:g})},ve=function(e,t){var n;t("order.width",e.orderKind.width),t("order.height",e.orderKind.height),t("order.amount",0),t("order.price",(null===(n=r.getQueryData("cp-links").find((function(t){var r,n;return(null===(r=t.customer)||void 0===r?void 0:r.customerId)===e.customer.customerId&&(null===(n=t.orderKind)||void 0===n?void 0:n.kindId)===e.orderKind.kindId})))||void 0===n?void 0:n.price)||0),t("order.fees",0),t("order.finalSum",0),t("order.comment","")};return Object(o.jsxs)("div",{className:e.root,children:[Object(o.jsx)(M.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{order:Object(a.a)(Object(a.a)({},ke),{},{employee:JSON.parse(localStorage.getItem("loggedUser"))}),onAcceptance:!1,clearFields:!0,isUrgently:!1},onSubmit:function(e,t){var r=t.resetForm,n=t.setFieldValue;return pe(e,r,n)},validationSchema:De,children:function(t){var l,u,m,b,v,f,O,h,g,x,y,w,N,S,I=t.values,R=t.errors,P=t.validateField,Q=t.handleReset;return Object(o.jsxs)(M.b,{children:[Y(I.order,p,j),Object(o.jsxs)("div",{className:"row__one",children:[Object(o.jsx)(M.a,{name:"order.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===R||void 0===R||null===(l=R.order)||void 0===l?void 0:l.customer,validator:P,component:te,setEntrepreneur:!0,setPrice:!0,sortKey:"customer",sortPage:"main",action:me,disabled:n.isFetching,getName:function(e){return e.customerName||""},options:r.getQueryData("customers")||[]}),Object(o.jsx)(C.a,{tabIndex:-1,className:e.lock,disableRipple:!0,onClick:function(){return e=I.order.customer,t=I.order.entrepreneur,void(e&&t?i.mutate({customerId:e.customerId,entrepreneurId:t.entrepreneurId,setStatus:k}):k({success:!1,error:!0}));var e,t},children:Object(o.jsx)(L.a,{className:e.svg})}),Object(o.jsx)(M.a,{name:"order.entrepreneur",label:"\u041f\u0456\u0434\u043f\u0440\u0438\u0454\u043c\u0435\u0446\u044c",error:null===R||void 0===R||null===(u=R.order)||void 0===u?void 0:u.entrepreneur,validator:P,component:te,disabled:n.isFetching,getName:function(e){return e.fullName||""},options:r.getQueryData("entrepreneurs")||[]}),Object(o.jsx)(M.a,{name:"order.orderType",label:"\u0412\u0438\u0434",error:null===R||void 0===R||null===(m=R.order)||void 0===m?void 0:m.orderType,validator:P,component:te,typeNameSetter:le,action:be,disabled:n.isFetching,getName:function(e){return e.typeName||""},options:r.getQueryData("orderTypes")||[]}),Object(o.jsx)(M.a,{name:"order.orderKind",label:"\u0422\u0438\u043f",error:null===R||void 0===R||null===(b=R.order)||void 0===b?void 0:b.orderKind,validator:P,component:te,setPrice:!0,setDimensions:!0,action:function(){return e=I.order.orderType,void(0!==ae.trim().length&&e?c.mutate({orderType:e,orderKind:Object(a.a)(Object(a.a)({},Ce),{},{typeId:e.typeId,kindName:ae}),setStatus:Z}):Z({success:!1,error:!0}));var e},kindNameSetter:oe,disabled:n.isFetching,getName:function(e){return e.kindName||""},options:("CTP"===(null===(v=I.order.orderType)||void 0===v?void 0:v.typeName)?(null===(f=I.order.orderType)||void 0===f?void 0:f.orderKinds.sort((function(e,t){return parseInt(e.kindName.substring(0,e.kindName.indexOf("\u0445")),10)>parseInt(t.kindName.substring(0,t.kindName.indexOf("\u0445")),10)?1:-1})))||[]:null===(O=I.order.orderType)||void 0===O?void 0:O.orderKinds)||[]})]}),Object(o.jsxs)("div",{className:"row__two",children:[Object(o.jsx)(M.a,{name:"order.width",label:"\u0428\u0438\u0440\u0438\u043d\u0430",error:null===R||void 0===R||null===(h=R.order)||void 0===h?void 0:h.width,validator:P,component:Se,disabled:n.isFetching}),Object(o.jsx)(C.a,{tabIndex:-1,className:e.lock,disableRipple:!0,onClick:function(){return e=I.order.orderKind,t=I.order.width,r=I.order.height,void(e&&t&&r?(e.width=t,e.height=r,d.mutate({orderKind:e,setStatus:A})):A({success:!1,error:!0}));var e,t,r},children:Object(o.jsx)(E.a,{className:e.svg})}),Object(o.jsx)(M.a,{name:"order.height",label:"\u0412\u0438\u0441\u043e\u0442\u0430",error:null===R||void 0===R||null===(g=R.order)||void 0===g?void 0:g.height,validator:P,component:Se,disabled:n.isFetching}),Object(o.jsx)(M.a,{name:"order.amount",label:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c",error:null===R||void 0===R||null===(x=R.order)||void 0===x?void 0:x.amount,validator:P,component:Se,disabled:n.isFetching}),Object(o.jsx)(_.a,{id:"outlined",size:"small",variant:"outlined",value:(I.order.width*I.order.height/1e6*I.order.amount).toFixed(3)||0,endAdornment:Object(o.jsx)(T.a,{position:"end",children:"\u043c\xb2"}),disabled:!0}),Object(o.jsx)(M.a,{name:"order.price",label:"\u0426\u0456\u043d\u0430",error:null===R||void 0===R||null===(y=R.order)||void 0===y?void 0:y.price,validator:P,InputLabelProps:p,component:Se,disabled:n.isFetching}),Object(o.jsx)(C.a,{tabIndex:-1,className:e.lock,disableRipple:!0,onClick:function(){return e=I.order.customer,t=I.order.orderKind,r=I.order.price,void(e&&t&&r?s.mutate({customerId:e.customerId,orderKindId:t.kindId,price:r,setStatus:U}):U({success:!1,error:!0}));var e,t,r},children:Object(o.jsx)(D.a,{className:e.svg})}),Object(o.jsx)(M.a,{name:"order.fees",label:"\u041f\u043e\u0441\u043b\u0443\u0433\u0438",error:null===R||void 0===R||null===(w=R.order)||void 0===w?void 0:w.fees,validator:P,component:Se,disabled:n.isFetching}),Object(o.jsx)(M.a,{name:"order.finalSum",label:"\u0421\u0443\u043c\u0430",error:null===R||void 0===R||null===(N=R.order)||void 0===N?void 0:N.finalSum,validator:P,component:Se,disableCalculation:!0,disabled:n.isFetching})]}),Object(o.jsx)("div",{className:"row__three",children:Object(o.jsx)(M.a,{name:"order.comment",label:"\u041e\u043f\u0438\u0441 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",error:null===R||void 0===R||null===(S=R.order)||void 0===S?void 0:S.comment,validator:P,numeric:!1,component:Se,disabled:n.isFetching})}),Object(o.jsxs)("div",{className:"row__four",children:[Object(o.jsxs)("div",{className:"controls",children:[Object(o.jsx)(Le,{name:"onAcceptance",isChecked:I.onAcceptance,label:"\u041d\u0430 \u043f\u043e\u0433\u043e\u0434\u0436\u0435\u043d\u043d\u0456",disabled:n.isFetching}),Object(o.jsx)(Le,{name:"clearFields",isChecked:I.clearFields,label:"\u041e\u0447\u0438\u0449\u0430\u0442\u0438 \u043f\u043e\u043b\u044f",disabled:n.isFetching}),Object(o.jsx)(Le,{name:"isUrgently",isChecked:I.isUrgently,label:"\u0422\u0435\u0440\u043c\u0456\u043d\u043e\u0432\u043e",disabled:n.isFetching})]}),Object(o.jsx)(C.a,{color:"primary",variant:"contained",disabled:n.isFetching,type:"submit",children:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"}),Object(o.jsx)(C.a,{className:e.clear,onClick:function(e){return function(e,t){r.invalidateQueries("customers"),r.invalidateQueries("ce-links"),r.invalidateQueries("cp-links"),he.dispatch(H(Object(a.a)({},ue),"main")),t(e)}(e,Q)},disabled:n.isFetching,variant:"contained",type:"button",children:Object(o.jsx)(F.a,{})})]})]})}}),Object(o.jsx)(we,{type:"success",open:O.success,onClose:de,message:"\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0434\u043e\u0434\u0430\u043d\u043e."}),Object(o.jsx)(we,{type:"error",open:O.error,onClose:de,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0434\u0430\u0432\u0430\u043d\u043d\u0456 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f."}),Object(o.jsx)(we,{type:"success",open:S.success,onClose:de,message:"\u0417\u0432'\u044f\u0437\u043e\u043a \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e."}),Object(o.jsx)(we,{type:"error",open:S.error,onClose:de,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0432'\u044f\u0437\u043a\u0443."}),Object(o.jsx)(we,{type:"success",open:P.success,onClose:de,message:"\u0420\u043e\u0437\u043c\u0456\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e."}),Object(o.jsx)(we,{type:"error",open:P.error,onClose:de,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0440\u043e\u0437\u043c\u0456\u0440\u0456\u0432."}),Object(o.jsx)(we,{type:"success",open:K.success,onClose:de,message:"\u0426\u0456\u043d\u0430 \u043f\u0440\u0438\u0432'\u044f\u0437\u0430\u043d\u0430."}),Object(o.jsx)(we,{type:"error",open:K.error,onClose:de,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0446\u0456\u043d\u0438."}),Object(o.jsx)(we,{type:"success",open:X.success,onClose:de,message:"\u0422\u0438\u043f \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u0438\u0439."}),Object(o.jsx)(we,{type:"error",open:X.error,onClose:de,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u0456 \u0442\u0438\u043f\u0443. \u041c\u043e\u0436\u043b\u0438\u0432\u043e \u043d\u0435 \u0432\u0438\u0431\u0440\u0430\u043d\u0438\u0439 \u0432\u0438\u0434."}),Object(o.jsx)(we,{type:"success",open:G.success,onClose:de,message:"\u0412\u0438\u0434 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u0438\u0439."}),Object(o.jsx)(we,{type:"error",open:G.error,onClose:de,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u0456 \u0432\u0438\u0434\u0443."})]})}var Fe=r(483),Me=Object(I.a)((function(){return{datepicker:{margin:0,"& .MuiButtonBase-root":{padding:2},"& .MuiOutlinedInput-input":{padding:8},"& .MuiInputLabel-outlined":{transform:"translate(14px, 10px) scale(1)"},"& .MuiInputLabel-shrink":{transform:"translate(14px, -4px) scale(0.75)"},"& .MuiOutlinedInput-adornedEnd":{paddingRight:3},"& .MuiInputAdornment-root":{width:"25%",marginLeft:0,justifyContent:"flex-end"}}}}));var Pe=function(e){var t=e.label,r=e.validator,n=e.onTouch,i=void 0!==n&&n,s=Object(A.a)(e,["label","validator","onTouch"]),c=Me(),l=s.form.setFieldValue,d=Object(U.a)(s),u=Object.assign({},d),m=u.name;return Object(o.jsx)(Fe.a,Object(a.a)(Object(a.a)(Object(a.a)({},s),u),{},{autoOk:!0,autoComplete:"off",helperText:"",className:c.datepicker,inputVariant:"outlined",variant:"inline",format:"dd/MM/yyyy",margin:"normal",label:t,onChange:function(e){l(m,e),i&&i(!0),r&&r(m)},KeyboardButtonProps:{"aria-label":"change date"}}))},Ae=Object(Q.a)({root:{"& .MuiInputLabel-marginDense":{transform:"translate(14px, 9px) scale(1)"},"& .MuiInputLabel-shrink":{transform:"translate(14px, -4px) scale(0.75)"}}})(B.a),Qe=function(e){var t=e.name,r=e.label,n=e.field,i=e.error,s=e.validator,c=(e.value,Object(A.a)(e,["name","label","field","error","validator","value"])),l=n.onChange,d=Object(M.f)(),u=d.values.payment,m=d.setFieldValue;return p.a.useEffect((function(){var e;u.paymentType?m("payment.percentage",null===(e=u.paymentType)||void 0===e?void 0:e.paymentPercentage):m("payment.percentage",0)}),[u.paymentType,m]),Object(o.jsx)(Ae,Object(a.a)(Object(a.a)(Object(a.a)({},c),n),{},{error:!!i,id:"metrics",size:"small",variant:"outlined",autoComplete:"off",label:r,onChange:function(e){(e.target.value.match(/^\d*\.?\d*$/)||0===e.target.value.length)&&(m("payment.percentage",e.target.value),l(e)),s(t)}}))};var Be=r(489),Ke=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r,n;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return r=re.CancelToken.source(),e.next=5,ne.a.get("/api/customers/",{cancelToken:r.token});case 5:return(n=e.sent).cancel=function(){return r.cancel("Query was cancelled by React Query")},e.abrupt("return",n.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,ne.a.get("/api/entrepreneurs/");case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ze=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,ne.a.get("/api/users/");case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,ne.a.get("/api/order-types/");case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ge=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,ne.a.get("/api/statuses/");case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),He=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,ne.a.get("/api/employees/");case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,ne.a.get("/api/customers/debtors/");case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(ie.a)(oe.a.mark((function e(){var t;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.a.get("/api/payments/");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Je=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r,n;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return r=re.CancelToken.source(),e.next=5,ne.a.get("/api/ce-links/",{cancelToken:r.token});case 5:return(n=e.sent).cancel=function(){return r.cancel("Query was cancelled by React Query")},e.abrupt("return",n.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$e=function(){var e=Object(ie.a)(oe.a.mark((function e(t){var r,n;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("ROLE_CUSTOMER")){e.next=2;break}return e.abrupt("return",[]);case 2:return r=re.CancelToken.source(),e.next=5,ne.a.get("/api/cp-links/",{cancelToken:r.token});case 5:return(n=e.sent).cancel=function(){return r.cancel("Query was cancelled by React Query")},e.abrupt("return",n.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Ye(){return Object(Be.a)("paymentMethods",Ve,{initialData:[],initialStale:!0,keepPreviousData:!0})}var Xe=Object(I.a)((function(){return{root:{display:"flex",flexWrap:"wrap",borderRadius:4,backgroundColor:"white",margin:"0 auto",width:"52%"},row__one:{display:"grid",gridColumnGap:"20px",gridTemplateColumns:"2fr 1fr",margin:".5rem auto 1rem auto"},row__two:{display:"grid",gridColumnGap:"20px",gridTemplateRows:"1fr",gridTemplateColumns:"1fr 1fr 0.05fr 1fr 1fr",margin:"1rem auto","& .MuiOutlinedInput-input":{padding:"8px 8px"}},button:{gridColumn:2,width:"16rem",height:"2.375rem",justifySelf:"center"},clear:{backgroundColor:"#fff",minWidth:0,justifySelf:"flex-end",margin:"0px 0px 1px 0",width:"2.4rem"},lock:{padding:0,width:"100%",backgroundColor:"white !important",minWidth:0,"&:hover":{backgroundColor:"white"}},svg:{fill:"rgba(0, 0, 0, 0.23)","&:hover":{fill:"black"}},successInfo:{display:"flex"},successText:{margin:"auto .5rem",color:"#27A637"},errorInfo:{display:"flex"},errorText:{margin:"auto .5rem",color:"#d2000a"},errorSvg:{fontSize:"2.54rem",fill:"#d2000a"},successSvg:{fontSize:"2.54rem",fill:"#27A637"}}})),Ze=P.c({payment:P.c({entrepreneur:P.c().nullable(),customer:P.c().required(),paymentDate:P.a().required(),sum:P.b().lessThan(2e9).positive().required(),percentage:P.b().lessThan(2e9).positive().min(0).required(),paymentType:P.c().required()})});var et=function(){var e=Xe(),t=Object(h.b)(),r=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.post("/api/payments/",e.payment)}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(t,r){r.setStatus({success:!0,error:!1}),e.invalidateQueries(["customers"]),e.invalidateQueries(["orders"]),r.payment.sum=0}})}(),n=Ye(),i=Object(x.c)((function(e){return e.sortSelections})),s=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.put("/api/payments/types/",e.paymentMethod)}),{onSuccess:function(t,r){e.invalidateQueries("paymentMethods"),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),c=p.a.useState({success:!1,error:!1}),l=Object(N.a)(c,2),d=l[0],u=l[1],m=p.a.useState({success:!1,error:!1}),b=Object(N.a)(m,2),j=b[0],v=b[1],f=function(){u({success:!1,error:!1}),v({success:!1,error:!1})};return Object(o.jsxs)("div",{className:e.root,children:[Object(o.jsx)(M.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{payment:Object(a.a)(Object(a.a)({},i.payment),{},{paymentDate:new Date})},validationSchema:Ze,onSubmit:function(e){!function(e){var t=new Date;e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds())}(e.payment.paymentDate),e.payment.receiver=e.payment.paymentType.typeName,r.mutate({payment:e.payment,setStatus:u})},children:function(i){var c,l,d,u,m,b=i.values,p=i.errors,j=i.validateField,f=i.setFieldValue;return Object(o.jsxs)(M.b,{style:{margin:"0 auto"},children:[Object(o.jsxs)("div",{className:e.row__one,children:[Object(o.jsx)(M.a,{name:"payment.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===p||void 0===p||null===(c=p.payment)||void 0===c?void 0:c.customer,component:te,validator:j,sortKey:"customer",sortPage:"payment",disabled:r.isLoading,getName:function(e){return e.customerName||""},options:t.getQueryData("customers")||[]}),Object(o.jsx)(M.a,{name:"payment.entrepreneur",label:"\u041f\u0456\u0434\u043f\u0440\u0438\u0454\u043c\u0435\u0446\u044c",error:null===p||void 0===p||null===(l=p.payment)||void 0===l?void 0:l.entrepreneur,validator:j,component:te,sortKey:"entrepreneur",sortPage:"payment",disabled:r.isLoading,getName:function(e){return e.fullName||""},options:t.getQueryData("entrepreneurs")||[]})]}),Object(o.jsxs)("div",{className:e.row__two,children:[Object(o.jsx)(M.a,{component:Pe,label:"\u0414\u0430\u0442\u0430",name:"payment.paymentDate",validator:j,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"payment.paymentType",label:"\u0422\u0438\u043f \u043e\u043f\u043b\u0430\u0442\u0438",error:null===p||void 0===p||null===(d=p.payment)||void 0===d?void 0:d.paymentType,component:te,validator:j,disabled:r.isLoading,getName:function(e){return e.typeName||""},options:(null===n||void 0===n?void 0:n.data)||[]}),Object(o.jsx)(C.a,{className:e.lock,disableRipple:!0,onClick:function(){return e=b.payment.paymentType,t=b.payment.percentage,e.paymentPercentage=t,void s.mutate({paymentMethod:e,setStatus:v});var e,t},children:Object(o.jsx)(E.a,{className:e.svg})}),Object(o.jsx)(M.a,{name:"payment.percentage",label:"\u0412\u0456\u0434\u0441\u043e\u0442\u043e\u043a",error:null===p||void 0===p||null===(u=p.payment)||void 0===u?void 0:u.percentage,validator:j,component:Qe,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"payment.sum",label:"\u0421\u0443\u043c\u0430",error:null===p||void 0===p||null===(m=p.payment)||void 0===m?void 0:m.sum,validator:j,component:Se,disabled:r.isLoading})]}),Object(o.jsxs)("div",{className:"sort__row__three",children:[Object(o.jsx)(C.a,{color:"primary",variant:"contained",disabled:r.isLoading,className:e.button,type:"submit",children:"\u041e\u043f\u043b\u0430\u0442\u0438\u0442\u0438"}),Object(o.jsx)(C.a,{className:e.clear,onClick:function(e){return function(e){t.invalidateQueries("customers"),he.dispatch(H(Object(a.a)({},ue),"payment")),e("payment.customer",null),e("payment.entrepreneur",null),e("payment.paymentDate",new Date),e("payment.paymentType",null),e("payment.percentage",0),e("payment.sum",null)}(f)},disabled:r.isLoading,variant:"contained",type:"button",children:Object(o.jsx)(F.a,{})})]})]})}}),Object(o.jsx)(we,{type:"success",open:d.success,onClose:f,message:"\u041e\u043f\u043b\u0430\u0442\u0430 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0432\u043d\u0435\u0441\u0435\u043d\u0430."}),Object(o.jsx)(we,{type:"error",open:d.error,onClose:f,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0432\u043d\u0435\u0441\u0435\u043d\u043d\u0456 \u043e\u043f\u043b\u0430\u0442\u0438."}),Object(o.jsx)(we,{type:"success",open:j.success,onClose:f,message:"\u0417\u0432'\u044f\u0437\u043e\u043a \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u0438\u0439."}),Object(o.jsx)(we,{type:"error",open:j.error,onClose:f,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0432'\u044f\u0437\u043a\u0443."})]})},tt=(r(225),Object(I.a)((function(){return{root:{display:"flex",flexWrap:"wrap",borderRadius:4,backgroundColor:"white",margin:"0 auto",width:"52%"},button:{width:"16rem",justifySelf:"center"},clear:{backgroundColor:"#fff",minWidth:0,justifySelf:"flex-end",margin:"0px 0px 1px 0",width:"2.4rem"}}}))),rt=P.c({sort:P.c({customer:P.c().nullable(),status:P.c().nullable(),dateFrom:P.a().nullable(),dateTill:P.a().nullable(),orderKind:P.c().nullable(),orderType:P.c().nullable(),details:P.d().trim().max(255).nullable()})});var nt=function(){var e=tt(),t=Object(x.b)(),r=Object(h.b)(),n=Object(x.c)((function(e){return e.auth})),i=Object(x.c)((function(e){return e.sortSelections}));return Object(b.useEffect)((function(){"sort"!==i.active&&t(G("sort"))}),[]),Object(o.jsx)("div",{className:e.root,children:Object(o.jsx)(M.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{sort:i.sort,showUserOrders:!1},onSubmit:function(e){e.showUserOrders?e.sort.employee=n.loggedUser:e.sort.employee=null,e.sort.details=e.sort.details.trim(),t(H(e.sort,"sort"))},validationSchema:rt,children:function(n){var i,s,c,l,d,u,m,b,p,j,v,f=n.values,O=n.errors,h=n.validateField,g=n.setFieldValue;return Object(o.jsxs)(M.b,{children:[Object(o.jsxs)("div",{className:"sort__row__one",children:[Object(o.jsx)(M.a,{name:"sort.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===O||void 0===O||null===(i=O.sort)||void 0===i?void 0:i.customer,component:te,validator:h,getName:function(e){return e.customerName||""},options:r.getQueryData("customers")||[]}),Object(o.jsx)(M.a,{name:"sort.orderType",label:"\u0412\u0438\u0434",error:null===O||void 0===O||null===(s=O.sort)||void 0===s?void 0:s.orderType,component:te,validator:h,getName:function(e){return e.typeName||""},options:r.getQueryData("orderTypes")||[]}),Object(o.jsx)(M.a,{name:"sort.orderKind",label:"\u0422\u0438\u043f",error:null===O||void 0===O||null===(c=O.sort)||void 0===c?void 0:c.orderKind,component:te,validator:h,getName:function(e){return e.kindName||""},options:("CTP"===(null===(l=f.sort)||void 0===l||null===(d=l.orderType)||void 0===d?void 0:d.typeName)?(null===(u=f.sort)||void 0===u||null===(m=u.orderType)||void 0===m?void 0:m.orderKinds.sort((function(e,t){return parseInt(e.kindName.substring(0,e.kindName.indexOf("\u0445")),10)>parseInt(t.kindName.substring(0,t.kindName.indexOf("\u0445")),10)?1:-1})))||[]:null===(b=f.sort)||void 0===b||null===(p=b.orderType)||void 0===p?void 0:p.orderKinds)||[]})]}),Object(o.jsxs)("div",{className:"sort__row__two",children:[Object(o.jsxs)("div",{className:"datepickers",children:[Object(o.jsx)(M.a,{component:Pe,disabled:!1,label:"\u0412\u0456\u0434",name:"sort.dateFrom"}),Object(o.jsx)(M.a,{component:Pe,disabled:!1,label:"\u0414\u043e",name:"sort.dateTill"})]}),Object(o.jsx)(M.a,{name:"sort.status",label:"\u0421\u0442\u0430\u0442\u0443\u0441",error:null===O||void 0===O||null===(j=O.sort)||void 0===j?void 0:j.status,component:te,validator:h,getName:function(e){return e.name||""},options:r.getQueryData("statuses")||[]}),Object(o.jsx)(M.a,{name:"sort.details",label:"\u041e\u043f\u0438\u0441 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",error:null===O||void 0===O||null===(v=O.sort)||void 0===v?void 0:v.details,numeric:!1,component:Se,validator:h})]}),Object(o.jsxs)("div",{className:"sort__row__three",children:[Object(o.jsx)(Le,{name:"showUserOrders",isChecked:f.showUserOrders,label:"\u041b\u0438\u0448\u0435 \u043c\u043e\u0457 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"}),Object(o.jsx)(C.a,{color:"primary",variant:"contained",className:e.button,type:"submit",children:"\u0421\u043e\u0440\u0442\u0443\u0432\u0430\u0442\u0438"}),Object(o.jsx)(C.a,{className:e.clear,onClick:function(e){return function(e){t(H(Object(a.a)({},ue),"sort")),e("sort.customer",null),e("sort.orderType",null),e("sort.orderKind",null),e("sort.dateFrom",null),e("sort.dateTill",null),e("sort.status",null),e("sort.details",""),e("showUserOrders",!1),r.invalidateQueries("customers")}(g)},variant:"contained",type:"button",children:Object(o.jsx)(F.a,{})})]})]})}})})};function at(){var e=Object(x.b)(),t=Object(x.c)((function(e){return e.auth})),r=Object(x.c)((function(e){return e.sortSelections})),n=function(t){r.mainTab===t?e(V(0)):e(V(t))},a=function(e){return!e.some((function(e){return t.roles.includes(e)}))},i=function(t){r.active!==t&&e(G(t))};return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{className:"action_bar_container",children:[Object(o.jsxs)("div",{className:"action__bar",children:[Object(o.jsx)("div",{className:"action__bar__info",children:function(){var e,t,n,a;if(r[r.active].customer)return Object(o.jsxs)(S.a,{variant:"subtitle1",children:[(null===(e=r[r.active].customer)||void 0===e?void 0:e.debtor)&&Object(o.jsx)("img",{className:"debtor-mark",src:"img/Blackmark.svg",width:"19",height:"19",alt:"blackmark"}),Object(o.jsx)("strong",{children:null===(t=r[r.active].customer)||void 0===t?void 0:t.customerName})," ",null===(n=r[r.active].customer)||void 0===n?void 0:n.customerGroup,":"," ",null===(a=r[r.active].customer)||void 0===a?void 0:a.info]})}()}),Object(o.jsxs)("div",{className:"action__bar__button",children:[a(["ROLE_GROUNDFLOOR","ROLE_UVPRINT","ROLE_CUSTOMER"])&&Object(o.jsx)(C.a,{variant:"contained",color:1===r.mainTab?"":"primary",onClick:function(){return n(1)},children:"\u0414\u043e\u0434\u0430\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"}),a(["ROLE_CUSTOMER"])&&Object(o.jsx)(C.a,{style:{marginLeft:".5rem"},variant:"contained",color:2===r.mainTab?"":"primary",onClick:function(){return n(2)},children:"\u0421\u043e\u0440\u0442\u0443\u0432\u0430\u043d\u043d\u044f"}),a(["ROLE_GROUNDFLOOR","ROLE_UVPRINT","ROLE_CUSTOMER"])&&Object(o.jsx)(C.a,{style:{marginLeft:".5rem"},variant:"contained",color:3===r.mainTab?"":"primary",onClick:function(){return n(3)},children:"\u0412\u043d\u0435\u0441\u0442\u0438 \u043e\u043f\u043b\u0430\u0442\u0443"})]})]}),Object(o.jsx)(k.a,{in:1===r.mainTab,timeout:300,onEntered:function(){return i("main")},unmountOnExit:!0,children:Object(o.jsx)(Re,{})}),Object(o.jsx)(k.a,{in:2===r.mainTab,timeout:300,onEntered:function(){return i("sort")},unmountOnExit:!0,children:Object(o.jsx)(nt,{})}),Object(o.jsx)(k.a,{in:3===r.mainTab,timeout:300,onEntered:function(){return i("payment")},unmountOnExit:!0,children:Object(o.jsx)(et,{})})]})})}var ot=Object(I.a)((function(){return{root:{display:"flex",flexWrap:"wrap",borderRadius:4,backgroundColor:"white",margin:"0 auto",width:"60%"},row:{gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr"},button:{width:"16rem",justifySelf:"center",gridColumn:2},clear:{backgroundColor:"#fff",minWidth:0,justifySelf:"flex-end",margin:"0px 0px 1px 0",width:"2.4rem"}}})),it=P.c({sort:P.c({entrepreneur:P.c().nullable(),customer:P.c().nullable(),employee:P.c().nullable(),dateFrom:P.a().nullable(),dateTill:P.a().nullable(),orderKind:P.c().nullable(),orderType:P.c().nullable(),details:P.d().trim().max(255).nullable(),receiver:P.d().trim().max(255).nullable()})});var st=function(){var e=ot(),t=Object(x.b)(),r=Object(h.b)(),n=Ye(),i=Object(x.c)((function(e){return e.sortSelections}));return Object(o.jsx)("div",{className:e.root,children:Object(o.jsx)(M.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{sort:i.filter},onSubmit:function(e){return t(H(e.sort,"filter"))},validationSchema:it,children:function(i){var s,c,l,d,u,m,b,p,j,v,f=i.values,O=i.errors,h=i.validateField,g=i.setFieldValue;return Object(o.jsxs)(M.b,{children:[Object(o.jsxs)("div",{className:"".concat(e.row," sort__row__one"),children:[Object(o.jsx)(M.a,{name:"sort.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===O||void 0===O||null===(s=O.sort)||void 0===s?void 0:s.customer,component:te,validator:h,getName:function(e){return e.customerName||""},options:r.getQueryData("customers")||[]}),Object(o.jsx)(M.a,{name:"sort.entrepreneur",label:"\u041f\u0456\u0434\u043f\u0440\u0438\u0454\u043c\u0435\u0446\u044c",error:null===O||void 0===O||null===(c=O.sort)||void 0===c?void 0:c.entrepreneur,component:te,validator:h,getName:function(e){return e.fullName||""},options:r.getQueryData("entrepreneurs")||[]}),Object(o.jsx)(M.a,{name:"sort.orderType",label:"\u0412\u0438\u0434",error:null===O||void 0===O||null===(l=O.sort)||void 0===l?void 0:l.orderType,component:te,validator:h,getName:function(e){return e.typeName||""},options:r.getQueryData("orderTypes")||[]}),Object(o.jsx)(M.a,{name:"sort.orderKind",label:"\u0422\u0438\u043f",error:null===O||void 0===O||null===(d=O.sort)||void 0===d?void 0:d.orderKind,component:te,validator:h,getName:function(e){return e.kindName||""},options:("CTP"===(null===(u=f.sort.orderType)||void 0===u?void 0:u.typeName)?(null===(m=f.sort.orderType)||void 0===m?void 0:m.orderKinds.sort((function(e,t){return parseInt(e.kindName.substring(0,e.kindName.indexOf("\u0445")),10)>parseInt(t.kindName.substring(0,t.kindName.indexOf("\u0445")),10)?1:-1})))||[]:null===(b=f.sort.orderType)||void 0===b?void 0:b.orderKinds)||[]}),Object(o.jsx)(M.a,{name:"sort.receiver",label:"\u041e\u0442\u0440\u0438\u043c\u0443\u0432\u0430\u0447",error:null===O||void 0===O||null===(p=O.sort)||void 0===p?void 0:p.receiver,component:te,validator:h,options:(null===(j=r.getQueryData("employees"))||void 0===j?void 0:j.map((function(e){return e.name})).concat(null===n||void 0===n?void 0:n.data.map((function(e){return e.typeName}))).filter((function(e){return!["\u0413\u043e\u0442\u0456\u0432\u043a\u0430","\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u043d\u043e","\u0420\u043e\u043c\u0430\u043d"].includes(e)})))||[]})]}),Object(o.jsxs)("div",{className:"".concat(e.row," sort__row__two"),children:[Object(o.jsx)(M.a,{component:Pe,disabled:!1,label:"\u0412\u0456\u0434",name:"sort.dateFrom"}),Object(o.jsx)(M.a,{component:Pe,disabled:!1,label:"\u0414\u043e",name:"sort.dateTill"}),Object(o.jsx)(M.a,{component:Pe,disabled:!1,label:"\u041e\u043f\u043b\u0430\u0442\u0430 \u0432\u0456\u0434",name:"sort.payDateFrom"}),Object(o.jsx)(M.a,{component:Pe,disabled:!1,label:"\u041e\u043f\u043b\u0430\u0442\u0430 \u0434\u043e",name:"sort.payDateTill"}),Object(o.jsx)(M.a,{name:"sort.employee",label:"\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440",error:null===O||void 0===O||null===(v=O.sort)||void 0===v?void 0:v.employee,component:te,validator:h,getName:function(e){return e.name||""},options:r.getQueryData("employees")||[]})]}),Object(o.jsxs)("div",{className:"sort__row__three",children:[Object(o.jsx)(C.a,{color:"primary",variant:"contained",className:e.button,type:"submit",children:"\u0421\u043e\u0440\u0442\u0443\u0432\u0430\u0442\u0438"}),Object(o.jsx)(C.a,{className:e.clear,onClick:function(e){return function(e){t(H(Object(a.a)({},me),"filter")),e("sort.customer",null),e("sort.orderType",null),e("sort.orderKind",null),e("sort.dateFrom",null),e("sort.dateTill",null),e("sort.payDateFrom",null),e("sort.payDateTill",null),e("sort.status",null),e("sort.employee",null),e("sort.receiver",""),e("sort.details",""),e("showUserOrders",!1),r.invalidateQueries("customers")}(g)},variant:"contained",type:"button",children:Object(o.jsx)(F.a,{})})]})]})}})})};function ct(){var e=Object(x.b)(),t=Object(x.c)((function(e){return e.sortSelections}));return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{className:"action_bar_container",children:[Object(o.jsxs)("div",{className:"action__bar",children:[Object(o.jsx)("div",{className:"action__bar__info"}),Object(o.jsx)("div",{className:"action__bar__button",children:Object(o.jsx)(C.a,{style:{marginLeft:".5rem"},variant:"contained",color:t.filterTab?"":"primary",onClick:function(){return t.filterTab?e({type:z.l}):e({type:z.m})},children:"\u0421\u043e\u0440\u0442\u0443\u0432\u0430\u043d\u043d\u044f"})})]}),Object(o.jsx)(k.a,{in:t.filterTab,timeout:300,onEntered:function(){return r="filter",void(t.active!==r&&e(G(r)));var r},unmountOnExit:!0,children:Object(o.jsx)(st,{})})]})})}var lt=Object(I.a)((function(){return{root:{backgroundColor:"white",padding:20},row:{display:"grid",width:"45%",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"1fr 1fr",gap:"10px 20px",margin:"0 auto"},submit:{width:"30%",gridColumn:"1/3",margin:"0 auto"}}})),dt=P.c({user:P.c().nullable(),customer:P.c().nullable()});function ut(){var e=lt(),t=Object(h.b)(),r=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.get("/api/users/"+e.form.user.id+"/"+e.form.customer.customerId)}),{onSuccess:function(t,r){e.invalidateQueries("users"),r.resetForm(),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),n=p.a.useState({success:!1,error:!1}),a=Object(N.a)(n,2),i=a[0],s=a[1],c=function(){s({success:!1,error:!1})};return Object(o.jsxs)("div",{className:e.root,children:[Object(o.jsx)(M.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{user:null,customer:null},onSubmit:function(e,t){return r.mutate({form:e,setStatus:s,resetForm:t.resetForm})},validationSchema:dt,children:function(r){var n=r.errors,a=r.validateField;return Object(o.jsx)(M.b,{children:Object(o.jsxs)("div",{className:e.row,children:[Object(o.jsx)(M.a,{name:"user",label:"\u041a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447",error:null===n||void 0===n?void 0:n.user,component:te,validator:a,getName:function(e){return e.fullName||""},options:t.getQueryData("users")||[]}),Object(o.jsx)(M.a,{name:"customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===n||void 0===n?void 0:n.customer,component:te,validator:a,getName:function(e){return e.customerName||""},options:t.getQueryData("customers")||[]}),Object(o.jsx)(C.a,{className:e.submit,color:"primary",variant:"contained",type:"submit",children:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438"})]})})}}),Object(o.jsx)(we,{type:"success",open:i.success,onClose:c,message:"\u0417\u0432'\u044f\u0437\u043e\u043a \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u0438\u0439."}),Object(o.jsx)(we,{type:"error",open:i.error,onClose:c,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0432'\u044f\u0437\u043a\u0443."})]})}r(404);var mt=r(474),bt=r(101);r(226);var pt=[{field:"customerName",headerName:"\u041d\u0430\u0437\u0432\u0430 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430",flex:3,renderCell:function(e){return Object(o.jsx)(mt.a,{className:"name-link",onClick:function(){return he.dispatch(W(e.row))},children:Object(o.jsx)("b",{children:e.value})})}},{field:"debtor",headerName:"\u0411\u043e\u0440\u0436\u043d\u0438\u043a",flex:1.4,cellClassName:"centered",renderCell:function(e){return e.value?Object(o.jsx)("img",{src:"img/Blackmark.svg",width:"19",height:"19",alt:"blackmark"}):Object(o.jsx)("div",{})}},{field:"customerGroup",headerName:"\u0413\u0440\u0443\u043f\u0430",flex:5},{field:"firstPerson",headerName:"\u041e\u0441\u043e\u0431\u0430 1",flex:2},{field:"firstPhone",headerName:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d 1",flex:2.5},{field:"firstEmail",headerName:"Email 1",flex:4},{field:"city",headerName:"\u041c\u0456\u0441\u0442\u043e",flex:1.3},{field:"info",headerName:"\u0406\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0456\u044f",flex:6}];function jt(){var e=Object(h.b)(),t=Object(ge.a)((function(e){return ne.a.post("api/customers/export/",{customers:e},{responseType:"arraybuffer"})}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(e,t){var r=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r);else{var n=window.URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.download="\u041a\u043b\u0456\u0454\u043d\u0442\u0438.xlsx",a.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}}),r=Object(x.c)((function(e){return e.auth})),n=Object(b.useState)(""),a=Object(N.a)(n,2),i=a[0],s=a[1],c=function(e){return e.filter((function(e){var t,r,n,a,o,s,c;return(null===(t=e.customerName)||void 0===t?void 0:t.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(r=e.customerGroup)||void 0===r?void 0:r.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(n=e.firstPerson)||void 0===n?void 0:n.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(a=e.firstPhone)||void 0===a?void 0:a.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(o=e.firstEmail)||void 0===o?void 0:o.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(s=e.city)||void 0===s?void 0:s.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(c=e.info)||void 0===c?void 0:c.toString().toLowerCase().indexOf(i.toLowerCase()))>-1}))};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(B.a,{variant:"outlined",size:"small",placeholder:"\u0428\u0432\u0438\u0434\u043a\u0438\u0439 \u043f\u043e\u0448\u0443\u043a",onChange:function(e){return s(e.target.value)},InputProps:{endAdornment:r.roles.includes("ROLE_ADMIN")&&Object(o.jsx)(C.a,{className:"export-btn",variant:"outlined",onClick:function(){return t.mutate(c(X(e.getQueryData("customers")||[])))},children:"\u0415\u043a\u0441\u043f\u043e\u0440\u0442"})}}),Object(o.jsx)("div",{className:"x-grid",children:Object(o.jsx)("div",{className:"frame",children:Object(o.jsx)("div",{className:"grid-holder",children:Object(o.jsx)(bt.a,{className:"customers-grid",rows:c(X(e.getQueryData("customers")||[])),columns:pt,sortModel:[{field:"customerName",sort:"asc"}],loading:e.isFetching("customers"),rowHeight:35,headerHeight:35,pagination:!0,disableSelectionOnClick:!0})})})})]})}var vt=function(e){return e?new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(e):""},ft=[{field:"name",headerName:"\u041d\u0430\u0437\u0432\u0430 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430",flex:2,renderCell:function(e){return Object(o.jsx)("b",{children:e.value})}},{field:"lastOrderDate",type:"dateTime",headerName:"\u041e\u0441\u0442\u0430\u043d\u043d\u0454 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",flex:1,valueFormatter:function(e){return vt(e.value)}},{field:"lastPaymentDate",type:"string",headerName:"\u041e\u0441\u0442\u0430\u043d\u043d\u044f \u043e\u043f\u043b\u0430\u0442\u0430",flex:1,valueFormatter:function(e){return vt(e.value)}},{field:"debt",type:"number",headerName:"\u0411\u043e\u0440\u0433",cellClassName:"centered",valueFormatter:function(e){return e.value},renderCell:function(e){return Object(o.jsxs)("b",{children:[e.value," \u0433\u0440\u043d."]})},flex:1}],Ot=function(e){if(!e)return[];for(var t=0;t<e.length;t++)e[t].id=t,e[t].lastOrderDate=new Date(e[t].lastOrderDate),e[t].lastPaymentDate=e[t].lastPaymentDate?new Date(e[t].lastPaymentDate):"";return e};function ht(){var e=Object(h.b)();return Object(o.jsx)("div",{className:"x-grid",children:Object(o.jsx)("div",{className:"frame",children:Object(o.jsx)("div",{className:"grid-holder",children:Object(o.jsx)(bt.a,{className:"customers-grid",rows:Ot(e.getQueryData("debtors"))||[],columns:ft,loading:e.isFetching("debtors"),rowHeight:35,headerHeight:35,pagination:!0,disableSelectionOnClick:!0})})})})}var gt=r(421),xt=r(249),yt=r(253);var wt=Object(I.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"4px",boxShadow:e.shadows[5],padding:e.spacing(2,4),width:"40%","& .MuiOutlinedInput-inputMarginDense":{padding:"8px !important"}},link:{cursor:"pointer",color:e.palette.primary.main},h2:{textAlign:"center",fontWeight:"400",marginBottom:"1rem"},buttons:{display:"grid",gridTemplateColumns:"1fr 2fr 1fr",gap:"2rem"},clearButton:{backgroundColor:"rgb(210,0,10)",color:"white",marginRight:"1rem","&:hover":{backgroundColor:"rgb(190,0,10)"}},rowOne:{gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr 1fr 1fr",gridColumnGap:"15px",gridRowGap:"10px"},rowTwo:{gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"1fr 1fr 1fr",gridRowGap:"10px"},longTextField:{gridColumnStart:1,gridColumnEnd:3},billNo:{gridColumn:4},switchHolder:{gridColumn:3,justifySelf:"end","& .MuiFormControlLabel-root":{margin:0}},auxiliaryRow:{display:"grid",gridColumnGap:"20px",gridTemplateRows:"1fr",gridTemplateColumns:"1fr 1fr 1fr 1fr",margin:"2rem auto 1rem auto","& .MuiOutlinedInput-input":{padding:"8px"},"& .MuiButtonBase-root":{padding:"2px !important"},"& .MuiOutlinedInput-adornedEnd":{paddingRight:"3px"},"& #date-picker-inline-label":{transform:"translate(14px, 10px) scale(1)"}}}})),Nt=P.c({customer:P.c({customerName:P.d().required(),customerGroup:P.d().nullable(),city:P.d().nullable(),info:P.d().nullable(),firstPerson:P.d().trim().max(25).nullable(),firstPhone:P.d().max(10).min(10).nullable(),firstEmail:P.d().email().nullable(),secondPerson:P.d().trim().max(25).nullable(),secondPhone:P.d().max(10).min(10).nullable(),secondEmail:P.d().email().nullable(),thirdPerson:P.d().trim().max(25).nullable(),thirdPhone:P.d().max(10).min(10).nullable(),thirdEmail:P.d().email().nullable()})});function St(){var e=wt(),t=Object(x.c)((function(e){return e.showCustomerModal})),r=function(){var e=Object(h.b)(),t=Object(x.b)();return Object(ge.a)((function(e){return 0===e.customer.customerId?ne.a.post("/api/customers/",e.customer):ne.a.put("/api/customers/",e.customer)}),{onSuccess:function(r,n){e.invalidateQueries("customers"),t(J()),n.setStatus({success:!0,error:!1})},onError:function(e,t){console.log(e),t.setStatus({success:!1,error:!0})}})}(),n=Object(x.c)((function(e){return e.auth})),i=Object(x.b)(),s=p.a.useState({success:!1,error:!1}),c=Object(N.a)(s,2),l=c[0],d=c[1],u=function(){d({success:!1,error:!1})},m=function(){i(H(Object(a.a)(Object(a.a)({},ue),{},{customer:t.customer}),"sort")),i(V(2)),i(J())};return Object(o.jsxs)("div",{children:[Object(o.jsx)(yt.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:e.modal,open:t.show,onClose:function(){return i(J())},closeAfterTransition:!0,BackdropComponent:gt.a,BackdropProps:{timeout:500},children:Object(o.jsx)(xt.a,{in:t.show,children:Object(o.jsx)("div",{className:e.paper,children:Object(o.jsx)(M.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{customer:t.customer},onSubmit:function(e){r.mutate({customer:e.customer,setStatus:d})},validationSchema:Nt,children:function(a){var i,s,c,l,d,u,b,p,j,v,f,O,h,g=a.values,x=a.errors,y=a.validateField;return Object(o.jsxs)(M.b,{children:[Object(o.jsx)(S.a,{className:e.h2,component:"h2",variant:"h5",children:t.customer.customerName?t.customer.customerName:"\u041d\u043e\u0432\u0438\u0439 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a"}),Object(o.jsxs)("div",{className:"row__one ".concat(e.rowOne),children:[Object(o.jsx)(M.a,{className:e.longTextField,name:"customer.customerName",label:"\u041d\u0430\u0437\u0432\u0430 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430",error:null===x||void 0===x||null===(i=x.customer)||void 0===i?void 0:i.customerName,validator:y,component:Se,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.customerGroup",label:"\u0413\u0440\u0443\u043f\u0430",error:null===x||void 0===x||null===(s=x.customer)||void 0===s?void 0:s.customerGroup,validator:y,component:Se,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(M.a,{className:e.longTextField,name:"customer.info",label:"\u041f\u0440\u0438\u043c\u0456\u0442\u043a\u0430",error:null===x||void 0===x||null===(c=x.customer)||void 0===c?void 0:c.info,validator:y,component:Se,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.city",label:"\u041c\u0456\u0441\u0442\u043e",error:null===x||void 0===x||null===(l=x.customer)||void 0===l?void 0:l.city,validator:y,component:Se,numeric:!1,disabled:r.isLoading})]}),Object(o.jsxs)("div",{className:"".concat(e.rowTwo," row__two"),children:[Object(o.jsx)(M.a,{name:"customer.firstPerson",label:"\u041a\u043e\u043d\u0442. \u041e\u0441\u043e\u0431\u0430 1",error:null===x||void 0===x||null===(d=x.customer)||void 0===d?void 0:d.firstPerson,validator:y,component:Se,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.firstPhone",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d (\u0431\u0435\u0437 +38)",error:null===x||void 0===x||null===(u=x.customer)||void 0===u?void 0:u.firstPhone,validator:y,component:Se,phone:!0,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.firstEmail",label:"Email",error:null===x||void 0===x||null===(b=x.customer)||void 0===b?void 0:b.firstEmail,validator:y,component:Se,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.secondPerson",label:"\u041a\u043e\u043d\u0442. \u041e\u0441\u043e\u0431\u0430 2",error:null===x||void 0===x||null===(p=x.customer)||void 0===p?void 0:p.secondPerson,validator:y,component:Se,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.secondPhone",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d (\u0431\u0435\u0437 +38)",error:null===x||void 0===x||null===(j=x.customer)||void 0===j?void 0:j.secondPhone,validator:y,component:Se,phone:!0,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.secondEmail",label:"Email",error:null===x||void 0===x||null===(v=x.customer)||void 0===v?void 0:v.secondEmail,validator:y,component:Se,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.thirdPerson",label:"\u041a\u043e\u043d\u0442. \u041e\u0441\u043e\u0431\u0430 3",error:null===x||void 0===x||null===(f=x.customer)||void 0===f?void 0:f.thirdPerson,validator:y,component:Se,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.thirdPhone",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d (\u0431\u0435\u0437 +38)",error:null===x||void 0===x||null===(O=x.customer)||void 0===O?void 0:O.thirdPhone,validator:y,component:Se,phone:!0,disabled:r.isLoading}),Object(o.jsx)(M.a,{name:"customer.thirdEmail",label:"Email",error:null===x||void 0===x||null===(h=x.customer)||void 0===h?void 0:h.thirdEmail,validator:y,component:Se,numeric:!1,disabled:r.isLoading})]}),Object(o.jsxs)("div",{className:e.buttons,children:[g.customer.customerId&&Object(o.jsx)(C.a,{style:{gridColumn:1},color:"primary",variant:"contained",className:e.button,disabled:r.isLoading,onClick:m,children:"\u0412 \u0441\u043e\u0440\u0442\u0443\u0432\u0430\u043d\u043d\u044f"})||null,Object(o.jsx)(C.a,{style:{gridColumn:2},color:"primary",variant:"contained",className:e.button,disabled:r.isLoading,type:"submit",children:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430"}),g.customer.customerId&&n.roles.includes("ROLE_ADMIN")&&Object(o.jsx)("div",{className:e.switchHolder,children:Object(o.jsx)(Le,{name:"customer.debtor",label:"\u0411\u043e\u0440\u0436\u043d\u0438\u043a",isChecked:g.customer.debtor,disabled:r.isLoading})})||null]})]})}})})})}),Object(o.jsx)(we,{type:"success",open:l.success,onClose:u,message:"\u0417\u0430\u043c\u043e\u0432\u0438\u043d\u043a\u0430 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e."}),Object(o.jsx)(we,{type:"error",open:l.error,onClose:u,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430. \u041c\u043e\u0436\u043b\u0438\u0432\u043e \u043a\u043b\u0456\u0454\u043d\u0442 \u0437\u0456 \u0441\u0445\u043e\u0436\u043e\u044e \u0456\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0456\u0454\u044e \u0432\u0436\u0435 \u0456\u0441\u043d\u0443\u0454."})]})}var Ct=r(475),kt=r(487),Tt=r(472),_t=(r(407),Object(I.a)((function(){return{root:{flexGrow:1},logoutButton:{padding:0},logoutHolder:{display:"flex",justifyContent:"flex-end",alignItems:"baseline",whiteSpace:"nowrap"},tabs:{margin:"0 auto",cursor:"pointer"}}})));function It(e){var t=e.radius,r=_t(),n=Object(w.g)(),a=Object(x.c)((function(e){return e.auth})),i=Object(h.b)(),s=Object(x.b)(),c=Object(x.c)((function(e){return e.sortSelections})),l=p.a.useState(0),d=Object(N.a)(l,2),u=d[0],m=d[1];return Object(o.jsx)("div",{children:Object(o.jsx)("div",{className:"header__container",children:Object(o.jsx)("div",{className:"menu",style:{borderBottomLeftRadius:t,borderBottomRightRadius:t},children:Object(o.jsxs)(Tt.a,{children:[Object(o.jsx)(mt.a,{color:"inherit",href:"https://psdruk.com.ua/",children:Object(o.jsx)("img",{width:"110",height:"50",src:"/img/logo.svg",alt:"logo"})}),a.roles.includes("ROLE_CUSTOMER")?Object(o.jsx)("div",{className:r.tabs}):Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)(kt.a,{className:r.tabs,value:u,onChange:function(e,t){switch(m(t),t){case 0:n.push("/");break;case 1:r="filter",c.active!==r&&s(G(r)),n.push("/sort");break;case 2:i.invalidateQueries("customers"),n.push("/clients");break;case 3:i.invalidateQueries("users"),i.invalidateQueries("customers"),n.push("/users");break;case 4:i.invalidateQueries("debtors"),n.push("/debtors")}var r},TabIndicatorProps:{style:{background:"white"}},indicatorColor:"secondary","aria-label":"scrollable auto tabs example",children:[Object(o.jsx)(Ct.a,{label:"\u0413\u043e\u043b\u043e\u0432\u043d\u0430",value:0}),a.roles.includes("ROLE_ADMIN")&&Object(o.jsx)(Ct.a,{label:"\u0421\u043e\u0440\u0442\u0443\u0432\u0430\u043d\u043d\u044f",value:1}),Object(o.jsx)(Ct.a,{label:"\u041a\u043b\u0456\u0454\u043d\u0442\u0438",value:2}),a.roles.includes("ROLE_ADMIN")&&Object(o.jsx)(Ct.a,{label:"\u041a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456",value:3}),a.roles.includes("ROLE_ADMIN")&&Object(o.jsx)(Ct.a,{label:"\u0411\u043e\u0440\u0436\u043d\u0438\u043a\u0438",value:4})]})}),Object(o.jsxs)("div",{className:r.logoutHolder,children:[Object(o.jsxs)(S.a,{variant:"body1",style:{fontWeight:300},children:["\u0412\u0456\u0442\u0430\u0454\u043c\u043e, ",Object(o.jsx)("b",{children:localStorage.getItem("fullName")})]}),Object(o.jsx)(C.a,{color:"inherit",onClick:function(){ce(),n.push("/login")},className:r.logoutButton,children:"\u0412\u0438\u0439\u0442\u0438"})]})]})})})})}var Lt=r(493),Et=r(484),Dt=r(476),Rt=r(477),Ft=r(478),Mt=r(239),Pt=r.n(Mt);function At(){return Object(o.jsxs)(S.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(o.jsx)(mt.a,{color:"inherit",href:"https://psdruk.com.ua/",children:"psdruk.com.ua"})," ",(new Date).getFullYear(),"."]})}var Qt=Object(I.a)((function(e){return{paper:{marginTop:e.spacing(20),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function Bt(){var e=Qt(),t=Object(w.g)(),r=Object(x.b)(),n=Object(b.useState)({username:"",password:""}),i=Object(N.a)(n,2),s=i[0],c=i[1],l=Object(b.useState)(!1),d=Object(N.a)(l,2),u=d[0],m=d[1],p=Object(b.useState)(!1),j=Object(N.a)(p,2),v=j[0],f=j[1],O=Object(b.useState)(!1),h=Object(N.a)(O,2),g=h[0],y=h[1],S=function(){m(!1),f(!1)};return Object(o.jsxs)(Dt.a,{component:"main",maxWidth:"xs",children:[Object(o.jsx)(Rt.a,{}),Object(o.jsxs)("div",{className:e.paper,children:[Object(o.jsx)(Lt.a,{className:e.avatar,children:Object(o.jsx)(Pt.a,{})}),Object(o.jsxs)("form",{className:e.form,onSubmit:function(e){e.preventDefault(),y(!0),se(s).then((function(e){e.employee||e.customer?(r(q(e.token,e.employee,e.customer,e.username,e.roles,e.fullName)),t.push("/")):m(!0)})).catch((function(e){console.log(e),y(!1),f(!0)}))},children:[Object(o.jsx)(B.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",onChange:function(e){return c(Object(a.a)(Object(a.a)({},s),{},{username:e.target.value}))},label:"Email",name:"email",autoComplete:"off",autoFocus:!0}),Object(o.jsx)(B.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",id:"password",onChange:function(e){return c(Object(a.a)(Object(a.a)({},s),{},{password:e.target.value}))},autoComplete:"off"}),Object(o.jsx)(C.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,disabled:g,children:"\u0412\u0445\u0456\u0434"}),Object(o.jsxs)(Ft.a,{container:!0,children:[Object(o.jsx)(Ft.a,{item:!0,xs:!0,children:Object(o.jsx)(mt.a,{href:"http://plg-site.32server.in.ua/",variant:"body2",children:"\u0417\u0430\u0431\u0443\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"})}),Object(o.jsx)(Ft.a,{item:!0,children:Object(o.jsx)(mt.a,{href:"http://plg-site.32server.in.ua/",variant:"body2",children:"\u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u0443\u0432\u0430\u0442\u0438\u0441\u044c"})})]})]})]}),Object(o.jsx)(Et.a,{mt:8,children:Object(o.jsx)(At,{})}),Object(o.jsx)(we,{type:"error",open:u,onClose:S,message:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0449\u0435 \u043d\u0435 \u043f\u0440\u043e\u0439\u0448\u043e\u0432 \u043f\u0435\u0440\u0435\u0432\u0456\u0440\u043a\u0443."}),Object(o.jsx)(we,{type:"error",open:v,onClose:S,message:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0456 \u0434\u0430\u043d\u0456 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0443."})]})}var Kt=r(469),Ut=r(479),zt=r(470),qt=r(480),Gt=r(471);var Ht=r(251),Wt=Object(I.a)((function(e){return{arrow:{color:e.palette.primary.main},tooltip:{fontSize:12,backgroundColor:e.palette.primary.main}}}));var Vt=function(e){var t=e.title,r=(e.value,e.placement),n=void 0===r?"right-start":r,i=e.children,s=Object(A.a)(e,["title","value","placement","children"]),c=Wt();return Object(o.jsx)(Ht.a,Object(a.a)(Object(a.a)({title:t,placement:n,arrow:!0,classes:c},s),{},{children:Object(o.jsx)("div",{className:"value",style:{lineHeight:"1.43"},children:i})}))},Jt=Object(I.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"4px",boxShadow:e.shadows[5],padding:e.spacing(2,4),width:"55%"},link:{cursor:"pointer",color:e.palette.primary.main},h2:{top:"-.9rem",position:"relative",marginTop:0,textAlign:"center",fontWeight:"400",gridColumnEnd:4,gridColumnStart:2},buttons:{display:"flex",justifyContent:"flex-end"},clearButton:{backgroundColor:"rgb(210,0,10)",color:"white",marginRight:"1rem","&:hover":{backgroundColor:"rgb(190,0,10)"}},rowOne:{gridTemplateColumns:"1fr 1fr 1fr 1fr"},rowTwo:{gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr 1fr 1fr"},rowThree:{"& .MuiInputBase-root.Mui-disabled":{color:"black"}},billNo:{gridColumn:4},auxiliaryRow:{display:"grid",gridColumnGap:"20px",gridTemplateRows:"1fr",gridTemplateColumns:"1fr 1fr 1fr 1fr",margin:"2rem auto 1rem auto","& .MuiOutlinedInput-input":{padding:"8px"},"& .MuiButtonBase-root":{padding:"2px !important"},"& .MuiOutlinedInput-adornedEnd":{paddingRight:"3px"},"& #date-picker-inline-label":{transform:"translate(14px, 10px) scale(1)"}}}})),$t=P.c({order:P.c({entrepreneur:P.c().required(),customer:P.c().required(),date:P.a().required(),orderType:P.c().required(),orderKind:P.c().required(),billNo:P.b().lessThan(2e9).positive().min(0),width:P.b().lessThan(2e9).positive().min(0).required(),height:P.b().lessThan(2e9).positive().min(0).required(),amount:P.b().lessThan(2e9).positive().min(0).required(),price:P.b().lessThan(2e9).positive().min(0).required(),fees:P.b().lessThan(2e9).positive().min(0).required(),finalSum:P.b().lessThan(2e9).positive().min(0).required(),comment:P.d().trim().max(255).required(),payLog:P.d()})});function Yt(e){var t=e.user,r=e.roles,n=e.order,a=Jt(),i=Object(h.b)(),s=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.delete("/api/orders/"+e.orderId)}),{onError:function(e,t){t.setStatus(!0)},onSuccess:function(t,r){e.invalidateQueries(["customers"]),e.invalidateQueries(["orders"]),r.setShowModal(!1)}})}(),c=function(){var e=null,t=Object(h.b)();return Object(ge.a)((function(e){return ne.a.put("/api/orders/",e.order)}),{onMutate:function(r){t.getQueryCache().findAll(["orders",1]).forEach((function(n){t.setQueryData(n.queryKey,n.state.data.map((function(t){return t.orderId===r.order.orderId?(e=t,r.order):t})))}))},onError:function(r,n){n.setStatus(!0),t.getQueryCache().findAll(["orders",1]).forEach((function(r){t.setQueryData(r.queryKey,r.state.data.map((function(t){return t.orderId===e.orderId?e:t})))}))},onSuccess:function(e,r){t.invalidateQueries(["customers"]),t.invalidateQueries(["orders"]),r.toggleModal()}})}(),l=p.a.useState(!1),d=Object(N.a)(l,2),u=d[0],m=d[1],b=p.a.useState(!1),j=Object(N.a)(b,2),v=j[0],f=j[1],O=p.a.useState(!1),g=Object(N.a)(O,2),x=g[0],y=g[1],w=p.a.useState(!1),k=Object(N.a)(w,2),I=k[0],L=k[1],E=function(){return m(!u)},D=function(){return!!t&&n.employee.employeeID!==t.employeeID},R=function(e){return r.includes(e)},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ROLE_ADMIN";return!t||!R("ROLE_ADMIN")&&(!R(e)&&D())};return Object(o.jsxs)("div",{children:[Object(o.jsx)(Vt,{title:n.employee.name,children:Object(o.jsx)(mt.a,{className:a.link,onClick:E,children:Object(o.jsx)("b",{children:n.orderId})})}),Object(o.jsx)(yt.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:a.modal,open:u,onClose:E,closeAfterTransition:!0,BackdropComponent:gt.a,BackdropProps:{timeout:500},children:Object(o.jsx)(xt.a,{in:u,children:Object(o.jsx)("div",{className:a.paper,children:Object(o.jsx)(M.c,{validateOnChange:!0,validateOnMount:!1,validateOnBlur:!1,initialValues:{order:n},onSubmit:function(e){c.mutate({order:e.order,toggleModal:E,setStatus:y})},validationSchema:$t,children:function(e){var r,s,l,d,u,m,b,p,j,O,h,g,w,N,k,I,E=e.values,D=e.errors,R=e.validateField;return Object(o.jsxs)(M.b,{children:[Object(o.jsx)(we,{type:"error",open:v,onClose:function(){return f(!1)},message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u0456 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f."}),Object(o.jsx)(we,{type:"error",open:x,onClose:function(){return y(!1)},message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f."}),Object(o.jsxs)("div",{className:a.auxiliaryRow,children:[Object(o.jsx)(M.a,{component:Pe,label:"\u0414\u0430\u0442\u0430",name:"order.date",error:null===D||void 0===D||null===(r=D.order)||void 0===r?void 0:r.date,validator:R,disabled:c.isLoading||F()}),Object(o.jsxs)(S.a,{className:a.h2,component:"h2",variant:"h5",children:["\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u044f \u2116 ",Object(o.jsx)("b",{children:n.orderId})]}),Object(o.jsx)(M.a,{className:a.billNo,name:"order.billNo",label:"\u2116 \u0420\u0430\u0445\u0443\u043d\u043a\u0443",disableCalculation:!0,error:null===D||void 0===D||null===(s=D.order)||void 0===s?void 0:s.billNo,validator:R,component:Se,disabled:c.isLoading||F("ROLE_MANAGER")})]}),Object(o.jsxs)("div",{className:"".concat(a.rowOne," row__one"),children:[Object(o.jsx)(M.a,{name:"order.entrepreneur",label:"\u041f\u0456\u0434\u043f\u0440\u0438\u0454\u043c\u0435\u0446\u044c",error:null===D||void 0===D||null===(l=D.order)||void 0===l?void 0:l.entrepreneur,validator:R,component:te,disabled:c.isLoading||F(),getName:function(e){return e.fullName||""},options:i.getQueryData("entrepreneurs")}),Object(o.jsx)(M.a,{name:"order.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===D||void 0===D||null===(d=D.order)||void 0===d?void 0:d.customer,validator:R,component:te,disabled:c.isLoading||F(),getName:function(e){return e.customerName||""},options:i.getQueryData("customers")}),Object(o.jsx)(M.a,{name:"order.orderType",label:"\u0412\u0438\u0434",error:null===D||void 0===D||null===(u=D.order)||void 0===u?void 0:u.orderType,validator:R,component:te,disabled:c.isLoading||F(),getName:function(e){return e.typeName||""},options:i.getQueryData("orderTypes")}),Object(o.jsx)(M.a,{name:"order.orderKind",label:"\u0422\u0438\u043f",error:null===D||void 0===D||null===(m=D.order)||void 0===m?void 0:m.orderKind,validator:R,component:te,disabled:c.isLoading||F(),getName:function(e){return e.kindName||""},options:(null===(b=E.order)||void 0===b||null===(p=b.orderType)||void 0===p?void 0:p.orderKinds)||[]})]}),Object(o.jsxs)("div",{className:"".concat(a.rowTwo," row__two"),children:[Object(o.jsx)(M.a,{name:"order.width",label:"\u0428\u0438\u0440\u0438\u043d\u0430",error:null===D||void 0===D||null===(j=D.order)||void 0===j?void 0:j.width,validator:R,component:Se,disabled:c.isLoading||F()}),Object(o.jsx)(M.a,{name:"order.height",label:"\u0412\u0438\u0441\u043e\u0442\u0430",error:null===D||void 0===D||null===(O=D.order)||void 0===O?void 0:O.height,validator:R,component:Se,disabled:c.isLoading||F()}),Object(o.jsx)(M.a,{name:"order.amount",label:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c",error:null===D||void 0===D||null===(h=D.order)||void 0===h?void 0:h.amount,validator:R,component:Se,disabled:c.isLoading||F()}),Object(o.jsx)(_.a,{id:"metrics",size:"small",variant:"outlined",value:(E.order.width*E.order.height/1e6*E.order.amount).toFixed(3)||0,endAdornment:Object(o.jsx)(T.a,{position:"end",children:"\u043c\xb2"}),disabled:!0}),Object(o.jsx)(M.a,{name:"order.price",label:"\u0426\u0456\u043d\u0430",error:null===D||void 0===D||null===(g=D.order)||void 0===g?void 0:g.price,validator:R,component:Se,disabled:c.isLoading||F()}),Object(o.jsx)(M.a,{name:"order.fees",label:"\u041f\u043e\u0441\u043b\u0443\u0433\u0438",error:null===D||void 0===D||null===(w=D.order)||void 0===w?void 0:w.fees,validator:R,component:Se,disabled:c.isLoading||F()}),Object(o.jsx)(M.a,{name:"order.finalSum",label:"\u0421\u0443\u043c\u0430",error:null===D||void 0===D||null===(N=D.order)||void 0===N?void 0:N.finalSum,validator:R,component:Se,disableCalculation:!0,disabled:c.isLoading||F()})]}),Object(o.jsx)("div",{className:"row__three",children:Object(o.jsx)(M.a,{name:"order.comment",label:"\u041e\u043f\u0438\u0441 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",error:null===D||void 0===D||null===(k=D.order)||void 0===k?void 0:k.comment,validator:R,numeric:!1,component:Se,disabled:c.isLoading||F("ROLE_MANAGER")})}),Object(o.jsx)("div",{className:"".concat(a.rowThree," row__three"),children:Object(o.jsx)(M.a,{name:"order.payLog",label:"\u0406\u0441\u0442\u043e\u0440\u0456\u044f \u043e\u043f\u043b\u0430\u0442",error:null===D||void 0===D||null===(I=D.order)||void 0===I?void 0:I.payLog,validator:R,numeric:!1,multiline:!0,component:Se,disabled:c.isLoading||F()})}),t&&Object(o.jsxs)("div",{className:a.buttons,children:[Object(o.jsx)(C.a,{className:a.clearButton,disabled:c.isLoading||F(),variant:"contained",type:"button",onClick:function(){return L(!0)},children:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438"}),Object(o.jsx)(C.a,{color:"primary",variant:"contained",className:a.button,disabled:c.isLoading||F("ROLE_MANAGER"),type:"submit",children:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"})]})]})}})})})}),Object(o.jsxs)(Kt.a,{fullScreen:!1,open:I,onClose:function(){return L(!1)},"aria-labelledby":"responsive-dialog-title",children:[Object(o.jsx)(Ut.a,{id:"responsive-dialog-title",children:"\u0412\u0438 \u0434\u0456\u0439\u0441\u043d\u043e \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0446\u0435 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f?"}),Object(o.jsx)(zt.a,{children:Object(o.jsx)(qt.a,{children:"\u041f\u043e\u0432\u0435\u0440\u043d\u0443\u0442\u0438 \u0439\u043e\u0433\u043e \u0437\u043c\u0456\u0441\u0442 \u0442\u0430 \u043e\u043f\u043b\u0430\u0442\u0438 \u0431\u0443\u0434\u0435 \u043d\u0435\u043c\u043e\u0436\u043b\u0438\u0432\u043e. \u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438?"})}),Object(o.jsxs)(Gt.a,{children:[Object(o.jsx)(C.a,{autoFocus:!0,onClick:function(){return L(!1)},variant:"contained",color:"primary",children:"\u041d\u0456"}),Object(o.jsx)(C.a,{onClick:function(){return e=n.orderId,L(!1),void s.mutate({orderId:e,setStatus:y,setShowModal:m});var e},variant:"contained",className:a.clearButton,autoFocus:!0,children:"\u0422\u0430\u043a"})]})]})]})}var Xt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((function(e){return 0===e.orderId?(e.id=t,e.orderId=t):e.id=e.orderId,e.date?e.date=new Date(e.date):e.date=new Date,e}))},Zt=function(){var e=Object(ie.a)(oe.a.mark((function e(t,r,n){var o,i,s,c;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={orderId:null,customer:null,entrepreneur:null,employee:null,status:null,dateFrom:null,dateTill:null,payDateFrom:null,payDateTill:null,receiver:null,orderKind:null,orderType:null,details:""},i=Object(a.a)(Object(a.a)({},o),{},{orderId:null===r||void 0===r?void 0:r.orderId,customer:null===r||void 0===r?void 0:r.customer,entrepreneur:null===r||void 0===r?void 0:r.entrepreneur,employee:null===r||void 0===r?void 0:r.employee,status:null===r||void 0===r?void 0:r.status,dateFrom:null===r||void 0===r?void 0:r.dateFrom,dateTill:null===r||void 0===r?void 0:r.dateTill,payDateFrom:null===r||void 0===r?void 0:r.payDateFrom,payDateTill:null===r||void 0===r?void 0:r.payDateTill,receiver:null===r||void 0===r?void 0:r.receiver,orderKind:null===r||void 0===r?void 0:r.orderKind,orderType:null===r||void 0===r?void 0:r.orderType,details:null===r||void 0===r?void 0:r.details}),!n){e.next=8;break}return e.next=5,ne.a.get("/api/orders/"+n.customerId);case 5:s=e.sent,e.next=18;break;case 8:if(1!==t){e.next=14;break}return e.next=11,ne.a.post("/api/orders/filter/",i);case 11:s=e.sent,e.next=18;break;case 14:if(2!==t){e.next=18;break}return e.next=17,ne.a.post("/api/orders/filter?stat=true",i);case 17:s=e.sent;case 18:if(!(c=s.data)||2!==t){e.next=21;break}return e.abrupt("return",Object(a.a)(Object(a.a)({},c),{},{listOfOrders:Xt(c.listOfOrders)}));case 21:if(!c){e.next=23;break}return e.abrupt("return",Xt(c));case 23:return e.abrupt("return",[]);case 24:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();var er=r(181);var tr=["","img/on-agreement.svg","img/in-progress.svg","img/ready.svg","img/completed.svg"],rr=Object(I.a)((function(e){return{container:{padding:e.spacing(1),textAlign:"center",backgroundColor:"#fff",boxShadow:"0 0 14px 2px rgba(0, 0, 0, 0.3)",borderRadius:"4px"},acceptanceButton:{width:"100%",margin:".2rem 0",backgroundColor:"#fff",border:"1px solid",borderColor:"#df16a0",color:"#df16a0","&:hover":{color:"#fff",backgroundColor:"#df16a0"}},inWorkButton:{width:"100%",margin:".2rem 0",backgroundColor:"#fff",border:"1px solid",borderColor:e.palette.primary.main,color:e.palette.primary.main,"&:hover":{color:"#fff",backgroundColor:e.palette.primary.main}},readyButton:{width:"100%",margin:".2rem 0",backgroundColor:"#fff",border:"1px solid",borderColor:"#28a745",color:"#28a745","&:hover":{color:"#fff",backgroundColor:"#28a745"}},completedButton:{width:"100%",margin:".2rem 0",backgroundColor:"#28a745",border:"1px solid",borderColor:"#28a745",color:"#fff","&:hover":{borderColor:"#218838",backgroundColor:"#218838"}},popper:{zIndex:1,marginLeft:"0.5rem",'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.9em",marginTop:"0.45rem",height:"3em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.background.paper," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.9em",marginTop:"0.45rem",height:"3em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.background.paper)}}},arrow:{position:"absolute",fontSize:7,width:"3em",height:"3em","&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}}}));var nr=function(e){var t=e.orderId,r=e.status,n=e.disabled,a=void 0!==n&&n,i=rr(),s=function(){var e=Object(h.b)();return Object(ge.a)((function(e){return ne.a.get("/api/statuses/"+e.orderId+"/"+e.statusId)}),{onSuccess:function(t,r){e.invalidateQueries("orders"),r.toggle()}})}(),c=p.a.useRef(null),l=p.a.useState(!0),d=Object(N.a)(l,1)[0],u=p.a.useState(!1),m=Object(N.a)(u,2),b=m[0],j=m[1],v=p.a.useState(null),f=Object(N.a)(v,2),O=f[0],g=f[1],x=b?"scroll-playground":null,y=function(){return j((function(e){return a?null:!e}))};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("img",{className:i.img,ref:c,src:tr[r],width:"19",height:"19",alt:"on-agreement","aria-describedby":x,variant:"contained",color:"primary",onClick:y}),Object(o.jsxs)(er.a,{id:x,open:b,anchorEl:c.current,placement:"right",disablePortal:!0,className:i.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{enabled:!0,element:O}},children:[d?Object(o.jsx)("span",{className:i.arrow,ref:g}):null,Object(o.jsxs)("div",{className:i.container,children:[Object(o.jsx)(C.a,{className:i.acceptanceButton,onClick:function(){return s.mutate({orderId:t,statusId:1,toggle:y})},children:"\u041d\u0430 \u043f\u043e\u0433\u043e\u0434\u0436\u0435\u043d\u043d\u0456"}),Object(o.jsx)("br",{}),Object(o.jsx)(C.a,{className:i.inWorkButton,onClick:function(){return s.mutate({orderId:t,statusId:2,toggle:y})},children:"\u0412 \u0440\u043e\u0431\u043e\u0442\u0456"}),Object(o.jsx)("br",{}),Object(o.jsx)(C.a,{className:i.readyButton,onClick:function(){return s.mutate({orderId:t,statusId:3,toggle:y})},children:"\u0413\u043e\u0442\u043e\u0432\u0435"}),Object(o.jsx)("br",{}),Object(o.jsx)(C.a,{className:i.completedButton,o:!0,onClick:function(){return s.mutate({orderId:t,statusId:4,toggle:y})},children:"\u0412\u0456\u0434\u0434\u0430\u043d\u043e"})]})]})]})};r(411);function ar(e,t){return e.localeCompare(t)}var or=function(e){return new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(e)};function ir(e){var t=e.tableID,r=Object(b.useState)({orderId:"desc"}),n=Object(N.a)(r,2),a=n[0],i=n[1],s=Object(b.useState)(""),c=Object(N.a)(s,2),l=c[0],d=c[1],u=Object(x.c)((function(e){return e.sortSelections})),m=Object(x.c)((function(e){return e.auth})),p=function(e,t,r){return Object(Be.a)(["orders",e,t],(function(){return Zt(e,t,r)}),{initialData:[],initialStale:!0,keepPreviousData:!1})}(t,u[u.active],m.customer),j=Object(h.b)(),v=Object(ge.a)((function(e){return ne.a.post("api/orders/export/",{orders:e},{responseType:"arraybuffer"})}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(e,t){var r=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r);else{var n=window.URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.download="\u0421\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u044c.xlsx",a.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}}),f=function(e){return e?e.filter((function(e){var t,r,n,a,o,i,s,c,d,u,m,b,p;return(null===(t=e.orderId)||void 0===t?void 0:t.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(r=e.billNo)||void 0===r?void 0:r.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||e.customer.customerName.toString().toLowerCase().indexOf(l.toLowerCase())>-1||(null===(n=or(e.date))||void 0===n?void 0:n.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(a=e.fees)||void 0===a?void 0:a.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(o=e.finalSum)||void 0===o?void 0:o.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(i=e.amount)||void 0===i?void 0:i.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(s=e.price)||void 0===s?void 0:s.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(c=e.height)||void 0===c?void 0:c.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(d=e.width)||void 0===d?void 0:d.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(u=e.m2)||void 0===u?void 0:u.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(m=e.orderKind.kindName)||void 0===m?void 0:m.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(b=e.orderType.typeName)||void 0===b?void 0:b.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(p=e.comment)||void 0===p?void 0:p.toString().toLowerCase().indexOf(l.toLowerCase()))>-1})):[]};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(B.a,{variant:"outlined",size:"small",placeholder:"\u0428\u0432\u0438\u0434\u043a\u0438\u0439 \u043f\u043e\u0448\u0443\u043a",onChange:function(e){return d(e.target.value)},InputProps:{endAdornment:m.roles.includes("ROLE_ORDERS_EXPORTER")&&Object(o.jsx)(C.a,{className:"export-btn",variant:"outlined",onClick:function(){return v.mutate(f(2!==t?p.data:p.data.listOfOrders))},children:"\u0415\u043a\u0441\u043f\u043e\u0440\u0442"})}}),Object(o.jsxs)("div",{className:"x-grid",children:[(u[u.active].customer||m.customer)&&Object(o.jsx)("div",{className:"action__bar__stat",children:Object(o.jsxs)("label",{children:["\u0421\u0443\u043c\u0430 \u0431\u043e\u0440\u0433\u0443 : ",Object(o.jsx)("b",{children:function(e){var r;m.roles.includes("ROLE_CUSTOMER")?r=m.customer:r=j.getQueryData("customers").find((function(t){return t.customerId===e.customerId}));var n,a,o=0;2===t?o=null===(n=p.data)||void 0===n||null===(a=n.listOfOrders)||void 0===a?void 0:a.reduce((function(e,t){return e+(t.finalSum-t.paySum)}),0):o=p.data.reduce((function(e,t){return e+(t.finalSum-t.paySum)}),0);return o-r.money}(u[u.active].customer)})," \u0433\u0440\u043d"]})}),2===t&&Object(o.jsxs)("div",{className:"action__bar__stat sort__info",children:[Object(o.jsxs)("label",{children:["\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c : ",Object(o.jsx)("b",{children:p.data.amount})]}),Object(o.jsxs)("label",{children:["M2 : ",Object(o.jsx)("b",{children:p.data.m2})]}),Object(o.jsxs)("label",{children:["\u041f\u043e\u0441\u043b\u0443\u0433\u0438 : ",Object(o.jsx)("b",{children:p.data.fees})]}),Object(o.jsxs)("label",{children:["\u0421\u0443\u043c\u0430 : ",Object(o.jsx)("b",{children:p.data.sum})]}),Object(o.jsxs)("label",{children:["\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043e : ",Object(o.jsx)("b",{children:p.data.paid})]})]}),Object(o.jsx)("div",{className:"frame",children:Object(o.jsx)("div",{className:"grid-holder",children:Object(o.jsx)(bt.a,{rows:f(2!==t?p.data:p.data.listOfOrders),columns:function(e){var t=[{field:"orderId",type:"number",headerName:"\u2116",flex:.8,renderCell:function(e){return Object(o.jsx)(Yt,{user:m.loggedUser,roles:m.roles,order:e.row})}},{field:"billNo",type:"number",headerName:"\u0420\u0430\u0445",flex:.6},{field:"customer",headerName:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",flex:2.2,sortComparator:function(e,t){return ar(e.customerName,t.customerName)},valueFormatter:function(e){return e.value.customerName},renderCell:function(e){return m.customer?Object(o.jsx)("b",{children:e.value.customerName}):Object(o.jsx)(mt.a,{className:"name-link",onClick:function(){return he.dispatch(W(e.row.customer))},children:e.value.info?Object(o.jsx)(Vt,{title:e.value.info,children:Object(o.jsx)("b",{children:e.value.customerName})}):Object(o.jsx)("b",{children:e.value.customerName})})}},{field:"date",type:"dateTime",headerName:"\u0414\u0430\u0442\u0430",flex:1.2,valueFormatter:function(e){return or(e.value)}},{field:"width",type:"number",headerName:"\u0428\u0438\u0440\u0438\u043d\u0430",valueFormatter:function(e){return e.value},flex:1.09},{field:"height",type:"number",headerName:"\u0412\u0438\u0441\u043e\u0442\u0430",valueFormatter:function(e){return e.value},flex:1},{field:"amount",type:"number",headerName:"\u041a-\u0441\u0442\u044c",valueFormatter:function(e){return e.value},flex:.85},{field:"m2",type:"number",headerName:"\u041c2",valueFormatter:function(e){return Number.parseFloat(e.value).toFixed(3)},flex:.9},{field:"price",type:"number",headerName:"\u0426\u0456\u043d\u0430",valueFormatter:function(e){return e.value},flex:.8},{field:"fees",type:"number",headerName:"\u041f\u043e\u0441\u043b\u0443\u0433\u0438",valueFormatter:function(e){return e.value},flex:1},{field:"finalSum",type:"number",headerName:"\u0421\u0443\u043c\u0430",flex:.9,renderCell:function(e){return Object(o.jsxs)("b",{children:[" ",e.value," "]})}},{field:"paid",headerName:"\u041e\u043f\u043b\u0430\u0442\u0430",sortable:!1,flex:1.1,cellClassName:"centered",renderCell:function(e){return e.row.paySum===e.row.finalSum?Object(o.jsx)(Vt,{title:or(new Date(e.row.payDate)),arrow:!0,children:Object(o.jsx)("img",{src:"img/completed.svg",width:"19",height:"19",alt:"paid"})}):e.row.paySum>0?Object(o.jsx)(Vt,{title:e.row.paySum+" \u0433\u0440\u043d, "+or(new Date(e.row.payDate)),arrow:!0,children:Object(o.jsx)("img",{src:"img/partly_paid.svg",width:"19",height:"19",alt:"partly__paid"})}):void 0}},{field:"status",headerName:"\u0421\u0442\u0430\u0442\u0443\u0441",flex:1.1,cellClassName:"centered",sortComparator:function(e,t){return e.id-t.id},renderCell:function(e){return m.customer?Object(o.jsx)(Vt,{title:e.row.status.name,arrow:!0,children:Object(o.jsx)(nr,{orderId:e.row.orderId,status:e.row.status.id,disabled:!0})}):Object(o.jsx)(nr,{orderId:e.row.orderId,status:e.row.status.id})}},{field:"orderType",type:"string",headerName:"\u0412\u0438\u0434",flex:1.8,sortComparator:function(e,t){return ar(e.typeName,t.typeName)},valueFormatter:function(e){return e.value.typeName}},{field:"orderKind",headerName:"\u0422\u0438\u043f",flex:1.8,sortComparator:function(e,t){return ar(e.kindName,t.kindName)},valueFormatter:function(e){return e.value.kindName}},{field:"comment",headerName:"\u041e\u043f\u0438\u0441 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",flex:6,sortComparator:function(e,t){return ar(e,t)},renderCell:function(e){return Object(o.jsx)(Vt,{title:e.value,placement:"left-start",children:e.value})}}];return Object.keys(e).forEach((function(r){return t.find((function(e){return e.field===r})).sortDirection=e[r]})),Object.values(t)}(a),onSortModelChange:function(e){var t,r,n={};e.sortModel.length>0?n[null===(t=e.sortModel[0])||void 0===t?void 0:t.field]=null===(r=e.sortModel[0])||void 0===r?void 0:r.sort:n.orderId="desc";i(n)},loading:p.isLoading,rowHeight:35,headerHeight:35,pagination:!0,disableSelectionOnClick:!0})})})]})]})}var sr=function(){var e,t,r=Object(b.useState)(0),n=Object(N.a)(r,2),a=n[0],i=n[1];return function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("customers",(function(){return Ke(e.roles)}),{refetchOnWindowFocus:!1})}(),function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("entrepreneurs",(function(){return Ue(e.roles)}),{initialData:[],initialStale:!0,keepPreviousData:!0,refetchOnWindowFocus:!1})}(),function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("employees",(function(){return He(e.roles)}),{refetchOnWindowFocus:!1})}(),function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("orderTypes",(function(){return qe(e.roles)}),{initialData:[],initialStale:!0,keepPreviousData:!0})}(),function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("statuses",(function(){return Ge(e.roles)}),{initialData:[],initialStale:!0,keepPreviousData:!0,refetchOnWindowFocus:!1})}(),function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("users",(function(){return ze(e.roles)}),{refetchOnWindowFocus:!1})}(),function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("ce-links",(function(){return Je(e.roles)}),{initialData:[],initialStale:!0,keepPreviousData:!0})}(),function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("cp-links",(function(){return $e(e.roles)}),{initialData:[],initialStale:!0,keepPreviousData:!0})}(),function(){var e=Object(x.c)((function(e){return e.auth}));Object(Be.a)("debtors",(function(){return We(e.roles)}),{refetchOnWindowFocus:!1})}(),Object(b.useEffect)((function(){var e,t,r,n;a||(document.getElementsByClassName("main__header")[0]?i(window.innerHeight-(32+(null===(e=document.getElementsByClassName("action__bar__button")[0])||void 0===e?void 0:e.clientHeight)+(null===(t=document.getElementsByClassName("main__header")[0])||void 0===t?void 0:t.clientHeight))):i(window.innerHeight-(32+(null===(r=document.getElementsByClassName("action__bar__button")[0])||void 0===r?void 0:r.clientHeight)+(null===(n=document.getElementsByClassName("sort__header")[0])||void 0===n?void 0:n.clientHeight))))}),[a]),Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)(y.a,{children:Object(o.jsxs)(w.d,{children:[Object(o.jsx)(w.b,{path:"/login",children:Object(o.jsx)(Bt,{})}),Object(o.jsx)(w.b,{exact:!0,path:"/",children:Object(o.jsxs)("div",{className:"main",children:[Object(o.jsxs)("div",{className:"main__header",children:[Object(o.jsx)(It,{radius:0}),Object(o.jsx)(at,{})]}),Object(o.jsx)("div",{className:"main__table",style:{height:a},children:Object(o.jsx)(ir,{tableID:1},1)})]})}),Object(o.jsx)(w.b,{path:"/clients",children:Object(o.jsxs)("div",{className:"clients",children:[Object(o.jsx)("div",{className:"clients__header",children:Object(o.jsx)(It,{radius:4})}),Object(o.jsx)("div",{className:"clients__table",style:{height:window.innerHeight-(62+(null===(e=document.getElementsByClassName("clients__header")[0])||void 0===e?void 0:e.clientHeight))},children:Object(o.jsx)(jt,{})})]})}),Object(o.jsx)(w.b,{path:"/sort",children:Object(o.jsxs)("div",{className:"sort",children:[Object(o.jsxs)("div",{className:"sort__header",children:[Object(o.jsx)(It,{radius:0}),Object(o.jsx)(ct,{})]}),Object(o.jsx)("div",{className:"sort__table",style:{height:a},children:Object(o.jsx)(ir,{tableID:2},2)})]})}),Object(o.jsx)(w.b,{path:"/users",children:Object(o.jsx)("div",{className:"users",children:Object(o.jsxs)("div",{className:"users__header",children:[Object(o.jsx)(It,{radius:0}),Object(o.jsx)(ut,{})]})})}),Object(o.jsx)(w.b,{path:"/debtors",children:Object(o.jsxs)("div",{className:"debtors",children:[Object(o.jsx)("div",{className:"debtors__header",children:Object(o.jsx)(It,{radius:4})}),Object(o.jsx)("div",{className:"debtors__table",style:{height:window.innerHeight-(32+(null===(t=document.getElementsByClassName("debtors__header")[0])||void 0===t?void 0:t.clientHeight))},children:Object(o.jsx)(ht,{})})]})})]})}),Object(o.jsx)(St,{})]})},cr=(r(412),r(152));r(413);var lr,dr,ur,mr,br,pr,jr,vr,fr,Or=function(){return Object(o.jsx)(cr.a,{elevation:3,className:"blue-holder",children:Object(o.jsxs)(cr.a,{elevation:3,className:"info",children:[Object(o.jsxs)("div",{className:"blank-page",children:[Object(o.jsx)(S.a,{variant:"h4",component:"h3",children:"\u0421\u0442\u043e\u0440\u0456\u043d\u043a\u0430 \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u0430"})," ",Object(o.jsx)(S.a,{variant:"h2",component:"h3",children:"404"})]}),Object(o.jsx)(Et.a,{mt:8,children:Object(o.jsxs)(S.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(o.jsx)(mt.a,{color:"inherit",href:"https://psdruk.com.ua/",children:"psdruk.com.ua"})," ",(new Date).getFullYear(),"."]})})]})})},hr=function(e){var t,r=e.component,n=Object(A.a)(e,["component"]),i=Object(x.c)((function(e){return e.auth})),s=localStorage.getItem("token"),c=localStorage.getItem("username"),l=localStorage.getItem("fullName"),d=(null===(t=localStorage.getItem("roles"))||void 0===t?void 0:t.split(","))||[],u=JSON.parse(localStorage.getItem("loggedUser")),m=JSON.parse(localStorage.getItem("customer"));return Object(o.jsx)(w.b,Object(a.a)(Object(a.a)({},n),{},{render:function(e){return i.isAuthenticated?Object(o.jsx)(r,Object(a.a)({},e)):s?(he.dispatch(q(s,u,m,c,d,l)),Object(o.jsx)(r,Object(a.a)({},e))):Object(o.jsx)(w.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},gr=Object(c.a)({palette:{primary:{light:"#fff",main:"rgba(0, 60, 170, 0.95)",dark:"rgba(0, 40, 170, 0.95)"},secondary:{main:"#f44336"}},typography:{useNextVariants:!0,fontSize:11,htmlFontSize:15}},d.ukUA),xr=gr.breakpoints,yr=Object(a.a)(Object(a.a)({},gr),{},{overrides:{MuiInputLabel:{root:(lr={fontSize:11},Object(n.a)(lr,xr.up("lg"),{fontSize:11}),Object(n.a)(lr,xr.down(1300),{fontSize:9}),lr)},MuiInputAdornment:{root:(dr={fontSize:11},Object(n.a)(dr,xr.up("lg"),{fontSize:11}),Object(n.a)(dr,xr.down(1300),{fontSize:9}),dr)},MuiInputBase:{root:(ur={fontSize:11},Object(n.a)(ur,xr.up("lg"),{fontSize:11}),Object(n.a)(ur,xr.down(1300),{fontSize:9}),ur)},MuiTypography:{root:(mr={fontSize:11},Object(n.a)(mr,xr.up("lg"),{fontSize:11}),Object(n.a)(mr,xr.down(1300),{fontSize:9}),mr),subtitle1:(br={fontSize:11},Object(n.a)(br,xr.up("lg"),{fontSize:11}),Object(n.a)(br,xr.down(1300),{fontSize:9}),br),body1:(pr={fontSize:12},Object(n.a)(pr,xr.up("lg"),{fontSize:12}),Object(n.a)(pr,xr.down(1300),{fontSize:10}),pr),button:(jr={fontSize:11},Object(n.a)(jr,xr.up("lg"),{fontSize:11}),Object(n.a)(jr,xr.down(1300),{fontSize:9}),jr)},MuiButton:{root:(vr={fontSize:11},Object(n.a)(vr,xr.up("lg"),{fontSize:11}),Object(n.a)(vr,xr.down(1300),{fontSize:9}),vr)},MuiTab:{root:(fr={fontSize:11},Object(n.a)(fr,xr.up("lg"),{fontSize:11}),Object(n.a)(fr,xr.down(1300),{fontSize:9}),fr)},MuiSvgIcon:{root:Object(n.a)({},xr.down(1300),{fontSize:15})}}});Date.prototype.toISOString=function(){var e=Object(s.a)(this);return e.substr(0,e.indexOf("+"))};var wr=new f.a,Nr=new O.a({queryCache:wr});v.a.render(Object(o.jsx)(l.a,{theme:yr,children:Object(o.jsxs)(h.a,{client:Nr,children:[Object(o.jsx)(u.a,{utils:i.a,locale:m.a,children:Object(o.jsx)(x.a,{store:he,children:Object(o.jsx)(y.a,{children:Object(o.jsxs)(w.d,{children:[Object(o.jsx)(w.b,{path:"/login",component:Bt}),Object(o.jsx)(hr,{path:"/",component:sr}),Object(o.jsx)(w.b,{path:"*",component:Or})]})})})}),Object(o.jsx)(g.ReactQueryDevtools,{})]})}),document.getElementById("root"))}},[[414,1,2]]]);
//# sourceMappingURL=main.62f12884.chunk.js.map