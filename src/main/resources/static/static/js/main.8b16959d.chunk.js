(this["webpackJsonpb1.0"]=this["webpackJsonpb1.0"]||[]).push([[0],{24:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"f",(function(){return a})),r.d(t,"i",(function(){return o})),r.d(t,"j",(function(){return i})),r.d(t,"g",(function(){return s})),r.d(t,"l",(function(){return c})),r.d(t,"h",(function(){return l})),r.d(t,"m",(function(){return d})),r.d(t,"o",(function(){return u})),r.d(t,"n",(function(){return m})),r.d(t,"a",(function(){return b})),r.d(t,"d",(function(){return p})),r.d(t,"c",(function(){return j})),r.d(t,"k",(function(){return v})),r.d(t,"e",(function(){return f}));var n="ADD_ORDER",a="LOAD_ORDERS",o="SET_AUTHENTICATED",i="SET_UNAUTHENTICATED",s="SELECT_CUSTOMER",c="UNSELECT_CUSTOMER",l="SET_ACTIVE_SORTING",d="UPDATE_MAIN_SORTING",u="UPDATE_SORT_SORTING",m="UPDATE_PAYMENT_SORTING",b="ADD_MAIN_SORTING",p="ADD_SORT_SORTING",j="ADD_PAYMENT_SORTING",v="SHOW_CUSTOMER_MODAL",f="CLOSE_CUSTOMER_MODAL"},281:function(e,t,r){},380:function(e,t,r){},400:function(e,t,r){"use strict";r.r(t);var n=r(28),a=r(9),o=r(24),i={mainPageOrderList:[],sortPageOrderList:[],isLoading:!0};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.b:return Object(a.a)(Object(a.a)({},e),{},{mainPageOrderList:[].concat(Object(n.a)(e.mainPageOrderList),[t.payload]),sortPageOrderList:[].concat(Object(n.a)(e.sortPageOrderList),[t.payload])});case o.f:return t.payload?Object(a.a)(Object(a.a)({},e),{},{mainPageOrderList:t.payload,sortPageOrderList:t.payload,isLoading:!1}):e;default:return e}}},402:function(e,t,r){},403:function(e,t,r){},406:function(e,t,r){},407:function(e,t,r){},411:function(e,t,r){},412:function(e,t,r){},413:function(e,t,r){},414:function(e,t,r){"use strict";r.r(t);var n=r(33),a=r(9),o=r(2),i=r(238),s=r(481),c=r(239),l=r(482),d=r(237),u=r(48),m=r(485),b=r(0),p=r.n(b),j=r(25),v=r.n(j),f=r(240),O=r(490),h=r(147),g=r(224),x=r(32),y=r(92),w=r(39),S=r(10),C=r(119),N=r(121),k=r(473),I=(r(281),r(467)),T=r(425),L=r(120),_=r(465),E=r(466),D=r(468),R=r(100),M=r.n(R),F=r(11),P=r(15),A=(r(380),r(50)),Q=r(5),B=r(241),z=r(486),K=r(151),U=r(24),q=function(e,t,r,n){return{type:U.i,payload:{token:e,employee:t,username:r,roles:n}}},G=function(e,t){var r;switch(t){case"main":r=U.m;break;case"sort":r=U.o;break;case"payment":r=U.n}return{type:r,payload:e}},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:U.k,payload:e}},H=function(){return{type:U.e}};function V(e){e.m2=(e.width*e.height/1e6*e.amount).toFixed(3)||0}var J=function(e,t,r){e.price>=0?t.shrink||r({shrink:!0}):t.shrink&&r({shrink:!1})},$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((function(e){return 0===e.orderId?(e.id=t,e.customerId=t):e.id=e.customerId,e}))},Y=function(e){return V(e),e.m2>0?Math.ceil(+e.m2*e.price+ +e.fees):Math.ceil(e.price*e.amount+ +e.fees)},X=Object(Q.a)({root:{"& .MuiInputLabel-marginDense":{transform:"translate(14px, 9px) scale(1)"},"& .MuiInputLabel-shrink":{transform:"translate(14px, -4px) scale(0.75)"},"& .MuiAutocomplete-endAdornment":{top:"inherit"},"& .MuiAutocomplete-inputRoot[class*='MuiOutlinedInput-root'] .MuiAutocomplete-endAdornment":{right:5}},inputRoot:{'&&[class*="MuiOutlinedInput-root"] $input':{padding:2},'&&[class*="MuiOutlinedInput-root"]':{paddingRight:"40px!important"}},input:{}})(z.a);var Z=function(e){var t=e.label,r=e.getName,n=e.sortKey,i=e.error,s=e.validator,c=e.kindNameSetter,l=void 0!==c&&c,d=e.typeNameSetter,u=void 0!==d&&d,m=e.setEntrepreneur,b=void 0!==m&&m,p=e.setDimensions,j=void 0!==p&&p,v=e.setPrice,f=void 0!==v&&v,O=e.action,g=void 0!==O&&O,y=e.sortPage,w=void 0===y?"":y,S=(e.textFieldProps,Object(A.a)(e,["label","getName","sortKey","error","validator","kindNameSetter","typeNameSetter","setEntrepreneur","setDimensions","setPrice","action","sortPage","textFieldProps"])),C=S.form.setFieldValue,N=Object(F.f)().values.order,k=Object(K.a)(S),I=Object.assign({},k),T=I.name,L=Object(x.b)(),_=Object(h.b)();return Object(o.jsx)(X,Object(a.a)(Object(a.a)({},S),{},{size:"small",error:"",value:I.value,autoHighlight:!0,getOptionLabel:r,onKeyPress:function(e){"="!==e.key&&"+"!==e.key||(e.preventDefault(),g&&g())},onChange:function(e,t){if(n){var r={};r[n]=t,L(function(e,t){var r;switch(t){case"main":r=U.a;break;case"sort":r=U.d;break;case"payment":r=U.c}return{type:r,payload:e}}(r,w))}if(b){var o,i=(null===(o=_.getQueryData("ce-links").find((function(e){return e.customer.customerId===(null===t||void 0===t?void 0:t.customerId)})))||void 0===o?void 0:o.entrepreneur)||null;C("order.entrepreneur",i)}if(C(T,t),f){var c,l,d;if(!t)return;var u,m,p=N.width,v=N.height;if(t.customerId)l=t.customerId,d=null===(u=N.orderKind)||void 0===u?void 0:u.kindId;else l=null===(m=N.customer)||void 0===m?void 0:m.customerId,d=t.kindId,p=t.width,v=t.height;if(!l||!d)return;var O=(null===(c=_.getQueryData("cp-links").find((function(e){var t,r;return(null===(t=e.customer)||void 0===t?void 0:t.customerId)===l&&(null===(r=e.orderKind)||void 0===r?void 0:r.kindId)===d})))||void 0===c?void 0:c.price)||0;C("order.price",O);var h=Y(Object(a.a)(Object(a.a)({},N),{},{price:O,width:p,height:v}));h&&C("order.finalSum",h)}j&&t&&t.width&&t.height&&(C("order.width",t.width),C("order.height",t.height)),s(T)},renderInput:function(e){return Object(o.jsx)(B.a,Object(a.a)(Object(a.a)({},e),{},{error:!!i,onChange:function(e){u?u(e.target.value):l&&l(e.target.value)},label:t,variant:"outlined"}))}}))},ee=r(18),te=r.n(ee),re=r(35),ne=r.n(re),ae=r(52),oe=function(){var e=Object(ae.a)(ne.a.mark((function e(t){var r,n;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.a.post("/api/auth/signin",t);case 2:return r=e.sent,n=r.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){ve.dispatch({type:U.j})},se={isAuthenticated:!1,loggedUser:null,roles:[]};var ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U.i:return localStorage.setItem("token",t.payload.token),localStorage.setItem("username",t.payload.username),localStorage.setItem("roles",t.payload.roles),localStorage.setItem("loggedUser",JSON.stringify(t.payload.employee)),te.a.defaults.headers.common.Authorization="Bearer ".concat(t.payload.token),te.a.interceptors.response.use((function(e){return e}),(function(e){var t;throw 401===(null===(t=e.response)||void 0===t?void 0:t.status)?ie():console.error(e),e})),{isAuthenticated:!0,loggedUser:t.payload.employee,roles:t.payload.roles};case U.j:return localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("roles"),localStorage.removeItem("loggedUser"),{isAuthenticated:!1,loggedUser:null};default:return e}},le={customer:null,status:null,dateFrom:null,dateTill:null,orderKind:null,orderType:null,employee:null,details:""},de={active:"main",main:le,sort:le,payment:le};var ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U.h:return Object(a.a)(Object(a.a)({},e),{},{active:t.payload});case U.a:return Object(a.a)(Object(a.a)({},e),{},{main:Object(a.a)(Object(a.a)({},e.main),t.payload)});case U.d:return Object(a.a)(Object(a.a)({},e),{},{sort:Object(a.a)(Object(a.a)({},e.sort),t.payload)});case U.c:return Object(a.a)(Object(a.a)({},e),{},{payment:Object(a.a)(Object(a.a)({},e.payment),t.payload)});case U.m:return Object(a.a)(Object(a.a)({},e),{},{main:t.payload});case U.o:return Object(a.a)(Object(a.a)({},e),{},{sort:t.payload});case U.n:return Object(a.a)(Object(a.a)({},e),{},{payment:t.payload});default:return e}},me={customerId:0,customerName:"",customerGroup:"",money:0,payLog:"",debtor:!1,city:"",info:"",firstPerson:"",firstPhone:"",firstEmail:"",secondPerson:"",secondPhone:"",secondEmail:"",thirdPerson:"",thirdPhone:"",thirdEmail:""},be={show:!1,customer:me};var pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U.k:return{show:!0,customer:t.payload};case U.e:return{show:!1,customer:{}};default:return e}},je=r(173),ve=(0,je.createStore)((0,je.combineReducers)({auth:ce,orders:r(400).default,sortSelections:ue,showCustomerModal:pe})),fe=r(494);var Oe=r(492),he=r(488);var ge=function(e){var t=e.open,r=e.onClose,n=e.message;return"success"===e.type?Object(o.jsx)(Oe.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t,autoHideDuration:3e3,onClose:r,children:Object(o.jsx)(he.a,{onClose:r,variant:"filled",severity:"success",children:n})}):Object(o.jsx)(Oe.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t,autoHideDuration:3e3,onClose:r,children:Object(o.jsx)(he.a,{onClose:r,variant:"filled",severity:"error",children:n})})},xe=Object(Q.a)({root:{"& .MuiInputLabel-marginDense":{transform:"translate(14px, 9px) scale(1)"},"& .MuiOutlinedInput-input":{padding:8},"& .MuiInputLabel-shrink":{transform:"translate(14px, -4px) scale(0.75)"}}})(B.a),ye=function(e){var t=e.label,r=e.field,n=e.error,i=e.readonly,s=void 0!==i&&i,c=e.validator,l=e.disableCalculation,d=void 0!==l&&l,u=e.numeric,m=void 0===u||u,b=e.phone,p=void 0!==b&&b,j=Object(A.a)(e,["label","field","error","readonly","validator","disableCalculation","numeric","phone"]),v=j.form.setFieldValue,f=Object(F.f)().values,O=r.onChange,h=r.name;return Object(o.jsx)(xe,Object(a.a)(Object(a.a)(Object(a.a)({},j),r),{},{error:!!n,size:"small",variant:"outlined",autoComplete:"off",label:t,InputProps:{readOnly:s},onChange:function(e){m||O(e),(e.target.value.match(/^\d*\.?\d*$/)||0===e.target.value.length)&&O(e),c(h)},onKeyUp:function(e){if(m&&!p&&f.order&&!d){V(f.order);var t=Y(f.order);t&&v("order.finalSum",t)}}}))},we={kindId:0,typeId:0,kindName:"",width:0,height:0},Se={orderId:0,billNo:0,date:"",employee:{userID:60},entrepreneur:null,customer:null,orderType:null,orderKind:null,width:0,height:0,amount:0,m2:0,price:0,fees:0,finalSum:0,paySum:0,status:{id:1},comment:""},Ce={typeId:0,typeName:""},Ne=r(420),ke=r(419),Ie=function(e){var t=e.label,r=e.isChecked,n=Object(A.a)(e,["label","isChecked"]),i=Object(F.e)(n),s=Object(S.a)(i,1)[0];return Object(o.jsx)(Ne.a,{control:Object(o.jsx)(ke.a,Object(a.a)(Object(a.a)(Object(a.a)({},n),s),{},{checked:r,color:"primary"})),label:t})},Te=Object(L.a)((function(){return{root:{display:"flex",flexWrap:"wrap",borderRadius:4,backgroundColor:"white",margin:"0 auto",width:"52%"},lock:{padding:0,width:"5px",backgroundColor:"white !important",minWidth:0,"&:hover":{backgroundColor:"white"}},svg:{fill:"rgba(0, 0, 0, 0.23)","&:hover":{fill:"black"}},clear:{backgroundColor:"#fff",minWidth:0,justifySelf:"flex-end",margin:"0px 0px 1px 0",width:"2.4rem"}}})),Le=P.c({order:P.c({entrepreneur:P.c().required(),customer:P.c().required(),orderType:P.c().required(),orderKind:P.c().required(),width:P.b().lessThan(2e9).positive().min(0).required(),height:P.b().lessThan(2e9).positive().min(0).required(),amount:P.b().lessThan(2e9).positive().min(0).required(),price:P.b().lessThan(2e9).positive().min(0).required(),fees:P.b().lessThan(2e9).positive().min(0).required(),finalSum:P.b().lessThan(2e9).positive().min(0).required(),comment:P.d().trim().max(255).required()})});function _e(){var e=Te(),t=Object(x.b)(),r=Object(h.b)(),n=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.post("/api/orders/",e.newOrder)}),{onSuccess:function(t,r){r.setStatus({success:!0,error:!1}),e.invalidateQueries(["customers"]),r.isReset?ve.dispatch(G(Object(a.a)({},le),"main")):e.invalidateQueries(["orders"]),r.resetForm()},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),i=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.get("/api/ce-links/"+e.customerId+"/"+e.entrepreneurId)}),{onSuccess:function(t,r){e.invalidateQueries("ce-links"),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),s=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.get("/api/cp-links/"+e.customerId+"/"+e.orderKindId+"/"+e.price)}),{onSuccess:function(t,r){e.invalidateQueries("cp-links"),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),c=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.post("/api/order-kinds/",e.orderKind)}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(t,r){r.orderType.orderKinds.push(t.data),e.invalidateQueries(["orderTypes"]),r.setStatus({success:!0,error:!1})}})}(),l=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.post("/api/order-types/",e.orderType)}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(t,r){e.invalidateQueries(["orderTypes"]),r.setStatus({success:!0,error:!1})}})}(),d=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.put("/api/order-kinds/",e.orderKind)}),{onSuccess:function(t,r){e.invalidateQueries("orderTypes"),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),u=Object(b.useState)({}),m=Object(S.a)(u,2),p=m[0],j=m[1],v=Object(b.useState)({success:!1,error:!1}),f=Object(S.a)(v,2),O=f[0],g=f[1],y=Object(b.useState)({success:!1,error:!1}),w=Object(S.a)(y,2),C=w[0],k=w[1],L=Object(b.useState)({success:!1,error:!1}),R=Object(S.a)(L,2),P=R[0],A=R[1],Q=Object(b.useState)({success:!1,error:!1}),B=Object(S.a)(Q,2),z=B[0],K=B[1],U=Object(b.useState)({success:!1,error:!1}),q=Object(S.a)(U,2),H=q[0],V=q[1],$=Object(b.useState)({success:!1,error:!1}),Y=Object(S.a)($,2),X=Y[0],ee=Y[1],re=Object(b.useState)(""),ne=Object(S.a)(re,2),ae=ne[0],oe=ne[1],ie=Object(b.useState)(""),se=Object(S.a)(ie,2),ce=se[0],de=se[1],ue=function(){g({success:!1,error:!1}),k({success:!1,error:!1}),A({success:!1,error:!1}),K({success:!1,error:!1}),ee({success:!1,error:!1}),V({success:!1,error:!1})},be=function(){t(W(Object(a.a)({},me)))},pe=function(){0!==ce.trim().length?l.mutate({orderType:Object(a.a)(Object(a.a)({},Ce),{},{typeName:ce}),setStatus:V}):V({success:!1,error:!0})},je=function(e,t,a){var o,i;o=e.isUrgently,i=e.order,o&&(.15*i.finalSum<10?i.finalSum=+i.finalSum+10:i.finalSum=Math.ceil(1.15*i.finalSum),i.comment="(\u0422\u0435\u0440\u043c\u0456\u043d\u043e\u0432\u043e) "+i.comment),function(e,t){t.status=e?r.getQueryData("statuses").find((function(e){return 1===e.id})):r.getQueryData("statuses").find((function(e){return 2===e.id}))}(e.onAcceptance,e.order),n.mutate({newOrder:e.order,isReset:e.clearFields,resetForm:e.clearFields?t:function(){return Oe(e.order,a)},setStatus:g})},Oe=function(e,t){var n;t("order.width",e.orderKind.width),t("order.height",e.orderKind.height),t("order.amount",0),t("order.price",(null===(n=r.getQueryData("cp-links").find((function(t){var r,n;return(null===(r=t.customer)||void 0===r?void 0:r.customerId)===e.customer.customerId&&(null===(n=t.orderKind)||void 0===n?void 0:n.kindId)===e.orderKind.kindId})))||void 0===n?void 0:n.price)||0),t("order.fees",0),t("order.finalSum",0),t("order.comment","")};return Object(o.jsxs)("div",{className:e.root,children:[Object(o.jsx)(F.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{order:Object(a.a)(Object(a.a)({},Se),{},{employee:JSON.parse(localStorage.getItem("loggedUser"))}),onAcceptance:!1,clearFields:!0,isUrgently:!1},onSubmit:function(e,t){var r=t.resetForm,n=t.setFieldValue;return je(e,r,n)},validationSchema:Le,children:function(t){var l,u,m,b,v,f,O,h,g,x,y,w,S=t.values,C=t.errors,L=t.validateField,R=t.handleReset;return Object(o.jsxs)(F.b,{children:[J(S.order,p,j),Object(o.jsxs)("div",{className:"row__one",children:[Object(o.jsx)(F.a,{name:"order.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===C||void 0===C||null===(l=C.order)||void 0===l?void 0:l.customer,validator:L,component:Z,setEntrepreneur:!0,setPrice:!0,sortKey:"customer",sortPage:"main",action:be,disabled:n.isFetching,getName:function(e){return e.customerName||""},options:r.getQueryData("customers")||[]}),Object(o.jsx)(N.a,{tabIndex:-1,className:e.lock,disableRipple:!0,onClick:function(){return e=S.order.customer,t=S.order.entrepreneur,void(e&&t?i.mutate({customerId:e.customerId,entrepreneurId:t.entrepreneurId,setStatus:k}):k({success:!1,error:!0}));var e,t},children:Object(o.jsx)(_.a,{className:e.svg})}),Object(o.jsx)(F.a,{name:"order.entrepreneur",label:"\u041f\u0456\u0434\u043f\u0440\u0438\u0454\u043c\u0435\u0446\u044c",error:null===C||void 0===C||null===(u=C.order)||void 0===u?void 0:u.entrepreneur,validator:L,component:Z,disabled:n.isFetching,getName:function(e){return e.fullName||""},options:r.getQueryData("entrepreneurs")||[]}),Object(o.jsx)(F.a,{name:"order.orderType",label:"\u0412\u0438\u0434",error:null===C||void 0===C||null===(m=C.order)||void 0===m?void 0:m.orderType,validator:L,component:Z,typeNameSetter:de,action:pe,disabled:n.isFetching,getName:function(e){return e.typeName||""},options:r.getQueryData("orderTypes")||[]}),Object(o.jsx)(F.a,{name:"order.orderKind",label:"\u0422\u0438\u043f",error:null===C||void 0===C||null===(b=C.order)||void 0===b?void 0:b.orderKind,validator:L,component:Z,setPrice:!0,setDimensions:!0,action:function(){return e=S.order.orderType,void(0!==ae.trim().length&&e?c.mutate({orderType:e,orderKind:Object(a.a)(Object(a.a)({},we),{},{typeId:e.typeId,kindName:ae}),setStatus:ee}):ee({success:!1,error:!0}));var e},kindNameSetter:oe,disabled:n.isFetching,getName:function(e){return e.kindName||""},options:(null===(v=S.order.orderType)||void 0===v?void 0:v.orderKinds.sort((function(e,t){return parseInt(e.kindName.substring(0,e.kindName.indexOf("\u0445")),10)>parseInt(t.kindName.substring(0,t.kindName.indexOf("\u0445")),10)?1:-1})))||[]})]}),Object(o.jsxs)("div",{className:"row__two",children:[Object(o.jsx)(F.a,{name:"order.width",label:"\u0428\u0438\u0440\u0438\u043d\u0430",error:null===C||void 0===C||null===(f=C.order)||void 0===f?void 0:f.width,validator:L,component:ye,disabled:n.isFetching}),Object(o.jsx)(N.a,{tabIndex:-1,className:e.lock,disableRipple:!0,onClick:function(){return e=S.order.orderKind,t=S.order.width,r=S.order.height,void(e&&t&&r?(e.width=t,e.height=r,d.mutate({orderKind:e,setStatus:A})):A({success:!1,error:!0}));var e,t,r},children:Object(o.jsx)(E.a,{className:e.svg})}),Object(o.jsx)(F.a,{name:"order.height",label:"\u0412\u0438\u0441\u043e\u0442\u0430",error:null===C||void 0===C||null===(O=C.order)||void 0===O?void 0:O.height,validator:L,component:ye,disabled:n.isFetching}),Object(o.jsx)(F.a,{name:"order.amount",label:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c",error:null===C||void 0===C||null===(h=C.order)||void 0===h?void 0:h.amount,validator:L,component:ye,disabled:n.isFetching}),Object(o.jsx)(T.a,{id:"outlined",size:"small",variant:"outlined",value:(S.order.width*S.order.height/1e6*S.order.amount).toFixed(3)||0,endAdornment:Object(o.jsx)(I.a,{position:"end",children:"\u043c\xb2"}),disabled:!0}),Object(o.jsx)(F.a,{name:"order.price",label:"\u0426\u0456\u043d\u0430",error:null===C||void 0===C||null===(g=C.order)||void 0===g?void 0:g.price,validator:L,InputLabelProps:p,component:ye,disabled:n.isFetching}),Object(o.jsx)(N.a,{tabIndex:-1,className:e.lock,disableRipple:!0,onClick:function(){return e=S.order.customer,t=S.order.orderKind,r=S.order.price,void(e&&t&&r?s.mutate({customerId:e.customerId,orderKindId:t.kindId,price:r,setStatus:K}):K({success:!1,error:!0}));var e,t,r},children:Object(o.jsx)(D.a,{className:e.svg})}),Object(o.jsx)(F.a,{name:"order.fees",label:"\u041f\u043e\u0441\u043b\u0443\u0433\u0438",error:null===C||void 0===C||null===(x=C.order)||void 0===x?void 0:x.fees,validator:L,component:ye,disabled:n.isFetching}),Object(o.jsx)(F.a,{name:"order.finalSum",label:"\u0421\u0443\u043c\u0430",error:null===C||void 0===C||null===(y=C.order)||void 0===y?void 0:y.finalSum,validator:L,component:ye,disableCalculation:!0,disabled:n.isFetching})]}),Object(o.jsx)("div",{className:"row__three",children:Object(o.jsx)(F.a,{name:"order.comment",label:"\u041e\u043f\u0438\u0441 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",error:null===C||void 0===C||null===(w=C.order)||void 0===w?void 0:w.comment,validator:L,numeric:!1,component:ye,disabled:n.isFetching})}),Object(o.jsxs)("div",{className:"row__four",children:[Object(o.jsxs)("div",{className:"controls",children:[Object(o.jsx)(Ie,{name:"onAcceptance",isChecked:S.onAcceptance,label:"\u041d\u0430 \u043f\u043e\u0433\u043e\u0434\u0436\u0435\u043d\u043d\u0456",disabled:n.isFetching}),Object(o.jsx)(Ie,{name:"clearFields",isChecked:S.clearFields,label:"\u041e\u0447\u0438\u0449\u0430\u0442\u0438 \u043f\u043e\u043b\u044f",disabled:n.isFetching}),Object(o.jsx)(Ie,{name:"isUrgently",isChecked:S.isUrgently,label:"\u0422\u0435\u0440\u043c\u0456\u043d\u043e\u0432\u043e",disabled:n.isFetching})]}),Object(o.jsx)(N.a,{color:"primary",variant:"contained",disabled:n.isFetching,type:"submit",children:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"}),Object(o.jsx)(N.a,{className:e.clear,onClick:function(e){return function(e,t){r.invalidateQueries("customers"),r.invalidateQueries("ce-links"),r.invalidateQueries("cp-links"),ve.dispatch(G(Object(a.a)({},le),"main")),t(e)}(e,R)},disabled:n.isFetching,variant:"contained",type:"button",children:Object(o.jsx)(M.a,{})})]})]})}}),Object(o.jsx)(ge,{type:"success",open:O.success,onClose:ue,message:"\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0434\u043e\u0434\u0430\u043d\u043e."}),Object(o.jsx)(ge,{type:"error",open:O.error,onClose:ue,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0434\u0430\u0432\u0430\u043d\u043d\u0456 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f."}),Object(o.jsx)(ge,{type:"success",open:C.success,onClose:ue,message:"\u0417\u0432'\u044f\u0437\u043e\u043a \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e."}),Object(o.jsx)(ge,{type:"error",open:C.error,onClose:ue,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0432'\u044f\u0437\u043a\u0443."}),Object(o.jsx)(ge,{type:"success",open:P.success,onClose:ue,message:"\u0420\u043e\u0437\u043c\u0456\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e."}),Object(o.jsx)(ge,{type:"error",open:P.error,onClose:ue,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0440\u043e\u0437\u043c\u0456\u0440\u0456\u0432."}),Object(o.jsx)(ge,{type:"success",open:z.success,onClose:ue,message:"\u0426\u0456\u043d\u0430 \u043f\u0440\u0438\u0432'\u044f\u0437\u0430\u043d\u0430."}),Object(o.jsx)(ge,{type:"error",open:z.error,onClose:ue,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0446\u0456\u043d\u0438."}),Object(o.jsx)(ge,{type:"success",open:X.success,onClose:ue,message:"\u0422\u0438\u043f \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u0438\u0439."}),Object(o.jsx)(ge,{type:"error",open:X.error,onClose:ue,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u0456 \u0442\u0438\u043f\u0443. \u041c\u043e\u0436\u043b\u0438\u0432\u043e \u043d\u0435 \u0432\u0438\u0431\u0440\u0430\u043d\u0438\u0439 \u0432\u0438\u0434."}),Object(o.jsx)(ge,{type:"success",open:H.success,onClose:ue,message:"\u0412\u0438\u0434 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u0438\u0439."}),Object(o.jsx)(ge,{type:"error",open:H.error,onClose:ue,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u0456 \u0432\u0438\u0434\u0443."})]})}var Ee=r(483),De=Object(L.a)((function(){return{datepicker:{margin:0,"& .MuiButtonBase-root":{padding:2},"& .MuiOutlinedInput-input":{padding:8},"& .MuiInputLabel-outlined":{transform:"translate(14px, 10px) scale(1)"},"& .MuiInputLabel-shrink":{transform:"translate(14px, -4px) scale(0.75)"},"& .MuiOutlinedInput-adornedEnd":{paddingRight:3},"& .MuiInputAdornment-root":{width:"25%",marginLeft:0,justifyContent:"flex-end"}}}}));var Re=function(e){var t=e.label,r=e.validator,n=e.onTouch,i=void 0!==n&&n,s=Object(A.a)(e,["label","validator","onTouch"]),c=De(),l=s.form.setFieldValue,d=Object(K.a)(s),u=Object.assign({},d),m=u.name;return Object(o.jsx)(Ee.a,Object(a.a)(Object(a.a)(Object(a.a)({},s),u),{},{autoOk:!0,autoComplete:"off",helperText:"",className:c.datepicker,inputVariant:"outlined",variant:"inline",format:"dd/MM/yyyy",margin:"normal",label:t,onChange:function(e){l(m,e),i&&i(!0),r&&r(m)},KeyboardButtonProps:{"aria-label":"change date"}}))},Me=Object(Q.a)({root:{"& .MuiInputLabel-marginDense":{transform:"translate(14px, 9px) scale(1)"},"& .MuiInputLabel-shrink":{transform:"translate(14px, -4px) scale(0.75)"}}})(B.a),Fe=function(e){var t=e.name,r=e.label,n=e.field,i=e.error,s=e.validator,c=(e.value,Object(A.a)(e,["name","label","field","error","validator","value"])),l=n.onChange,d=Object(F.f)(),u=d.values.payment,m=d.setFieldValue;return p.a.useEffect((function(){var e;u.paymentType?m("payment.percentage",null===(e=u.paymentType)||void 0===e?void 0:e.paymentPercentage):m("payment.percentage",0)}),[u.paymentType,m]),Object(o.jsx)(Me,Object(a.a)(Object(a.a)(Object(a.a)({},c),n),{},{error:!!i,id:"metrics",size:"small",variant:"outlined",autoComplete:"off",label:r,onChange:function(e){(e.target.value.match(/^\d*\.?\d*$/)||0===e.target.value.length)&&(m("payment.percentage",e.target.value),l(e)),s(t)}}))};var Pe=r(489),Ae=function(){var e=Object(ae.a)(ne.a.mark((function e(){var t,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ee.CancelToken.source(),e.next=3,te.a.get("/api/customers/",{cancelToken:t.token});case 3:return(r=e.sent).cancel=function(){return t.cancel("Query was cancelled by React Query")},e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Qe=function(){var e=Object(ae.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.a.get("/api/entrepreneurs/");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=Object(ae.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.a.get("/api/order-types/");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ze=function(){var e=Object(ae.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.a.get("/api/orders/statuses/");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(ae.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.a.get("/api/payments/");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(ae.a)(ne.a.mark((function e(){var t,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ee.CancelToken.source(),e.next=3,te.a.get("/api/ce-links/",{cancelToken:t.token});case 3:return(r=e.sent).cancel=function(){return t.cancel("Query was cancelled by React Query")},e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),qe=function(){var e=Object(ae.a)(ne.a.mark((function e(){var t,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ee.CancelToken.source(),e.next=3,te.a.get("/api/cp-links/",{cancelToken:t.token});case 3:return(r=e.sent).cancel=function(){return t.cancel("Query was cancelled by React Query")},e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var Ge={entrepreneur:null,customer:null,paymentDate:null,sum:0,percentage:0,paymentType:null,receiver:""},We=Object(L.a)((function(){return{root:{display:"flex",flexWrap:"wrap",borderRadius:4,backgroundColor:"white",margin:"0 auto",width:"52%"},row__one:{display:"grid",gridColumnGap:"20px",gridTemplateColumns:"2fr 1fr",margin:".5rem auto 1rem auto"},row__two:{display:"grid",gridColumnGap:"20px",gridTemplateRows:"1fr",gridTemplateColumns:"1fr 1fr 0.05fr 1fr 1fr",margin:"1rem auto","& .MuiOutlinedInput-input":{padding:"8px 8px"}},button:{gridColumn:2,width:"16rem",height:"2.375rem",justifySelf:"center"},clear:{backgroundColor:"#fff",minWidth:0,justifySelf:"flex-end",margin:"0px 0px 1px 0",width:"2.4rem"},lock:{padding:0,width:"100%",backgroundColor:"white !important",minWidth:0,"&:hover":{backgroundColor:"white"}},svg:{fill:"rgba(0, 0, 0, 0.23)","&:hover":{fill:"black"}},successInfo:{display:"flex"},successText:{margin:"auto .5rem",color:"#27A637"},errorInfo:{display:"flex"},errorText:{margin:"auto .5rem",color:"#d2000a"},errorSvg:{fontSize:"2.54rem",fill:"#d2000a"},successSvg:{fontSize:"2.54rem",fill:"#27A637"}}})),He=P.c({payment:P.c({entrepreneur:P.c().nullable(),customer:P.c().required(),paymentDate:P.a().required(),sum:P.b().lessThan(2e9).positive().required(),percentage:P.b().lessThan(2e9).positive().min(0).required(),paymentType:P.c().required()})});var Ve=function(){var e=We(),t=Object(h.b)(),r=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.post("/api/payments/",e.payment)}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(t,r){r.setStatus({success:!0,error:!1}),e.invalidateQueries(["customers"]),e.invalidateQueries(["orders"]),r.payment.sum=0}})}(),n=Object(Pe.a)("paymentMethods",Ke,{initialData:[],initialStale:!0,keepPreviousData:!0}),i=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.put("/api/payments/types/",e.paymentMethod)}),{onSuccess:function(t,r){e.invalidateQueries("paymentMethods"),r.setStatus({success:!0,error:!1})},onError:function(e,t){t.setStatus({success:!1,error:!0})}})}(),s=p.a.useState({success:!1,error:!1}),c=Object(S.a)(s,2),l=c[0],d=c[1],u=p.a.useState({success:!1,error:!1}),m=Object(S.a)(u,2),b=m[0],j=m[1],v=function(){d({success:!1,error:!1}),j({success:!1,error:!1})};return Object(o.jsxs)("div",{className:e.root,children:[Object(o.jsx)(F.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{payment:Object(a.a)(Object(a.a)({},Ge),{},{paymentDate:new Date})},validationSchema:He,onSubmit:function(e){!function(e){var t=new Date;e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds())}(e.payment.paymentDate),e.payment.receiver=e.payment.paymentType.typeName,r.mutate({payment:e.payment,setStatus:d})},children:function(s){var c,l,d,u,m,b=s.values,p=s.errors,v=s.handleReset,f=s.validateField;return Object(o.jsxs)(F.b,{style:{margin:"0 auto"},children:[Object(o.jsxs)("div",{className:e.row__one,children:[Object(o.jsx)(F.a,{name:"payment.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===p||void 0===p||null===(c=p.payment)||void 0===c?void 0:c.customer,component:Z,validator:f,sortKey:"customer",sortPage:"payment",disabled:r.isLoading,getName:function(e){return e.customerName||""},options:t.getQueryData("customers")||[]}),Object(o.jsx)(F.a,{name:"payment.entrepreneur",label:"\u041f\u0456\u0434\u043f\u0440\u0438\u0454\u043c\u0435\u0446\u044c",error:null===p||void 0===p||null===(l=p.payment)||void 0===l?void 0:l.entrepreneur,validator:f,component:Z,sortKey:"entrepreneur",sortPage:"payment",disabled:r.isLoading,getName:function(e){return e.fullName||""},options:t.getQueryData("entrepreneurs")||[]})]}),Object(o.jsxs)("div",{className:e.row__two,children:[Object(o.jsx)(F.a,{component:Re,label:"\u0414\u0430\u0442\u0430",name:"payment.paymentDate",validator:f,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"payment.paymentType",label:"\u0422\u0438\u043f \u043e\u043f\u043b\u0430\u0442\u0438",error:null===p||void 0===p||null===(d=p.payment)||void 0===d?void 0:d.paymentType,component:Z,validator:f,disabled:r.isLoading,getName:function(e){return e.typeName||""},options:(null===n||void 0===n?void 0:n.data)||[]}),Object(o.jsx)(N.a,{className:e.lock,disableRipple:!0,onClick:function(){return e=b.payment.paymentType,t=b.payment.percentage,e.paymentPercentage=t,void i.mutate({paymentMethod:e,setStatus:j});var e,t},children:Object(o.jsx)(E.a,{className:e.svg})}),Object(o.jsx)(F.a,{name:"payment.percentage",label:"\u0412\u0456\u0434\u0441\u043e\u0442\u043e\u043a",error:null===p||void 0===p||null===(u=p.payment)||void 0===u?void 0:u.percentage,validator:f,component:Fe,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"payment.sum",label:"\u0421\u0443\u043c\u0430",error:null===p||void 0===p||null===(m=p.payment)||void 0===m?void 0:m.sum,validator:f,component:ye,disabled:r.isLoading})]}),Object(o.jsxs)("div",{className:"sort__row__three",children:[Object(o.jsx)(N.a,{color:"primary",variant:"contained",disabled:r.isLoading,className:e.button,type:"submit",children:"\u041e\u043f\u043b\u0430\u0442\u0438\u0442\u0438"}),Object(o.jsx)(N.a,{className:e.clear,onClick:function(e){return function(e,r){t.invalidateQueries("customers"),ve.dispatch(G(Object(a.a)({},le),"payment")),r(e)}(e,v)},disabled:r.isLoading,variant:"contained",type:"button",children:Object(o.jsx)(M.a,{})})]})]})}}),Object(o.jsx)(ge,{type:"success",open:l.success,onClose:v,message:"\u041e\u043f\u043b\u0430\u0442\u0430 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0432\u043d\u0435\u0441\u0435\u043d\u0430."}),Object(o.jsx)(ge,{type:"error",open:l.error,onClose:v,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0432\u043d\u0435\u0441\u0435\u043d\u043d\u0456 \u043e\u043f\u043b\u0430\u0442\u0438."}),Object(o.jsx)(ge,{type:"success",open:b.success,onClose:v,message:"\u0417\u0432'\u044f\u0437\u043e\u043a \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u0438\u0439."}),Object(o.jsx)(ge,{type:"error",open:b.error,onClose:v,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0432'\u044f\u0437\u043a\u0443."})]})},Je=(r(402),Object(L.a)((function(){return{root:{display:"flex",flexWrap:"wrap",borderRadius:4,backgroundColor:"white",margin:"0 auto",width:"52%"},button:{width:"16rem",justifySelf:"center"},clear:{backgroundColor:"#fff",minWidth:0,justifySelf:"flex-end",margin:"0px 0px 1px 0",width:"2.4rem"}}}))),$e=P.c({sort:P.c({customer:P.c().nullable(),status:P.c().nullable(),dateFrom:P.a().nullable(),dateTill:P.a().nullable(),orderKind:P.c().nullable(),orderType:P.c().nullable(),details:P.d().trim().max(255).nullable()})});var Ye=function(){var e=Je(),t=Object(x.b)(),r=Object(h.b)(),n=Object(x.c)((function(e){return e.auth}));return Object(o.jsx)("div",{className:e.root,children:Object(o.jsx)(F.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{sort:le,showUserOrders:!1},onSubmit:function(e){e.showUserOrders?e.sort.employee=n.loggedUser:e.sort.employee=null,e.sort.details=e.sort.details.trim(),t(G(e.sort,"sort"))},validationSchema:$e,children:function(n){var i,s,c,l,d,u,m=n.values,b=n.errors,p=n.handleReset,j=n.validateField;return Object(o.jsxs)(F.b,{children:[Object(o.jsxs)("div",{className:"sort__row__one",children:[Object(o.jsx)(F.a,{name:"sort.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===b||void 0===b||null===(i=b.sort)||void 0===i?void 0:i.customer,component:Z,validator:j,getName:function(e){return e.customerName||""},options:r.getQueryData("customers")||[]}),Object(o.jsx)(F.a,{name:"sort.orderType",label:"\u0412\u0438\u0434",error:null===b||void 0===b||null===(s=b.sort)||void 0===s?void 0:s.orderType,component:Z,validator:j,getName:function(e){return e.typeName||""},options:r.getQueryData("orderTypes")||[]}),Object(o.jsx)(F.a,{name:"sort.orderKind",label:"\u0422\u0438\u043f",error:null===b||void 0===b||null===(c=b.sort)||void 0===c?void 0:c.orderKind,component:Z,validator:j,getName:function(e){return e.kindName||""},options:(null===(l=m.sort.orderType)||void 0===l?void 0:l.orderKinds)||[]})]}),Object(o.jsxs)("div",{className:"sort__row__two",children:[Object(o.jsxs)("div",{className:"datepickers",children:[Object(o.jsx)(F.a,{component:Re,disabled:!1,label:"\u0412\u0456\u0434",name:"sort.dateFrom"}),Object(o.jsx)(F.a,{component:Re,disabled:!1,label:"\u0414\u043e",name:"sort.dateTill"})]}),Object(o.jsx)(F.a,{name:"sort.status",label:"\u0421\u0442\u0430\u0442\u0443\u0441",error:null===b||void 0===b||null===(d=b.sort)||void 0===d?void 0:d.status,component:Z,validator:j,getName:function(e){return e.name||""},options:r.getQueryData("statuses")||[]}),Object(o.jsx)(F.a,{name:"sort.details",label:"\u041e\u043f\u0438\u0441 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",error:null===b||void 0===b||null===(u=b.sort)||void 0===u?void 0:u.details,numeric:!1,component:ye,validator:j})]}),Object(o.jsxs)("div",{className:"sort__row__three",children:[Object(o.jsx)(Ie,{name:"showUserOrders",isChecked:m.showUserOrders,label:"\u041b\u0438\u0448\u0435 \u043c\u043e\u0457 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"}),Object(o.jsx)(N.a,{color:"primary",variant:"contained",className:e.button,type:"submit",children:"\u0421\u043e\u0440\u0442\u0443\u0432\u0430\u0442\u0438"}),Object(o.jsx)(N.a,{className:e.clear,onClick:function(e){return function(e,n){r.invalidateQueries("customers"),t(G(Object(a.a)({},le),"sort")),n(e)}(e,p)},variant:"contained",type:"button",children:Object(o.jsx)(M.a,{})})]})]})}})})};function Xe(){var e=Object(x.b)(),t=Object(x.c)((function(e){return e.auth})),r=Object(x.c)((function(e){return e.sortSelections})),n=Object(b.useState)(0),a=Object(S.a)(n,2),i=a[0],s=a[1],c=function(e){return s(i===e?0:e)},l=function(e){return!e.some((function(e){return t.roles.includes(e)}))},d=function(t){var n;r.active!==t&&e((n=t,{type:U.h,payload:n}))};return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{className:"action_bar_container",children:[Object(o.jsxs)("div",{className:"action__bar",children:[Object(o.jsx)("div",{className:"action__bar__info",children:function(){var e,t,n,a;if(r[r.active].customer)return Object(o.jsxs)(C.a,{variant:"subtitle1",children:[(null===(e=r[r.active].customer)||void 0===e?void 0:e.debtor)&&Object(o.jsx)("img",{className:"debtor-mark",src:"img/Blackmark.svg",width:"19",height:"19",alt:"blackmark"}),Object(o.jsx)("strong",{children:null===(t=r[r.active].customer)||void 0===t?void 0:t.customerName})," ",null===(n=r[r.active].customer)||void 0===n?void 0:n.customerGroup,":"," ",null===(a=r[r.active].customer)||void 0===a?void 0:a.info]})}()}),Object(o.jsxs)("div",{className:"action__bar__button",children:[l(["ROLE_GROUNDFLOOR","ROLE_UVPRINT"])&&Object(o.jsx)(N.a,{variant:"contained",color:1===i?"":"primary",onClick:function(){return c(1)},children:"\u0414\u043e\u0434\u0430\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"}),Object(o.jsx)(N.a,{style:{marginLeft:".5rem"},variant:"contained",color:2===i?"":"primary",onClick:function(){return c(2)},children:"\u0421\u043e\u0440\u0442\u0443\u0432\u0430\u043d\u043d\u044f"}),l(["ROLE_GROUNDFLOOR","ROLE_UVPRINT"])&&Object(o.jsx)(N.a,{style:{marginLeft:".5rem"},variant:"contained",color:3===i?"":"primary",onClick:function(){return c(3)},children:"\u0412\u043d\u0435\u0441\u0442\u0438 \u043e\u043f\u043b\u0430\u0442\u0443"})]})]}),Object(o.jsx)(k.a,{in:1===i,timeout:300,onEntered:function(){return d("main")},unmountOnExit:!0,children:Object(o.jsx)(_e,{})}),Object(o.jsx)(k.a,{in:2===i,timeout:300,onEntered:function(){return d("sort")},unmountOnExit:!0,children:Object(o.jsx)(Ye,{})}),Object(o.jsx)(k.a,{in:3===i,timeout:300,onEntered:function(){return d("payment")},unmountOnExit:!0,children:Object(o.jsx)(Ve,{})})]})})}r(403);var Ze=r(474),et=r(150);r(406);var tt=[{field:"customerName",headerName:"\u041d\u0430\u0437\u0432\u0430 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430",flex:3,renderCell:function(e){return Object(o.jsx)(Ze.a,{className:"name-link",onClick:function(){return ve.dispatch(W(e.row))},children:Object(o.jsx)("b",{children:e.value})})}},{field:"debtor",headerName:"\u0411\u043e\u0440\u0436\u043d\u0438\u043a",flex:1.4,cellClassName:"centered",renderCell:function(e){return e.value?Object(o.jsx)("img",{src:"img/Blackmark.svg",width:"19",height:"19",alt:"blackmark"}):Object(o.jsx)("div",{})}},{field:"customerGroup",headerName:"\u0413\u0440\u0443\u043f\u0430",flex:5},{field:"firstPerson",headerName:"\u041e\u0441\u043e\u0431\u0430 1",flex:2},{field:"firstPhone",headerName:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d 1",flex:2.5},{field:"firstEmail",headerName:"Email 1",flex:4},{field:"city",headerName:"\u041c\u0456\u0441\u0442\u043e",flex:1.3},{field:"info",headerName:"\u0406\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0456\u044f",flex:6}];function rt(){var e=Object(h.b)(),t=Object(fe.a)((function(e){return te.a.post("api/customers/export/",{customers:e},{responseType:"arraybuffer"})}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(e,t){var r=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r);else{var n=window.URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.download="\u041a\u043b\u0456\u0454\u043d\u0442\u0438.xlsx",a.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}}),r=Object(x.c)((function(e){return e.auth})),n=Object(b.useState)(""),a=Object(S.a)(n,2),i=a[0],s=a[1],c=function(e){return e.filter((function(e){var t,r,n,a,o,s,c;return(null===(t=e.customerName)||void 0===t?void 0:t.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(r=e.customerGroup)||void 0===r?void 0:r.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(n=e.firstPerson)||void 0===n?void 0:n.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(a=e.firstPhone)||void 0===a?void 0:a.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(o=e.firstEmail)||void 0===o?void 0:o.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(s=e.city)||void 0===s?void 0:s.toString().toLowerCase().indexOf(i.toLowerCase()))>-1||(null===(c=e.info)||void 0===c?void 0:c.toString().toLowerCase().indexOf(i.toLowerCase()))>-1}))};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(B.a,{variant:"outlined",size:"small",placeholder:"\u0428\u0432\u0438\u0434\u043a\u0438\u0439 \u043f\u043e\u0448\u0443\u043a",onChange:function(e){return s(e.target.value)},InputProps:{endAdornment:r.roles.includes("ADMIN")&&Object(o.jsx)(N.a,{className:"export-btn",variant:"outlined",onClick:function(){return t.mutate(c($(e.getQueryData("customers")||[])))},children:"\u0415\u043a\u0441\u043f\u043e\u0440\u0442"})}}),Object(o.jsx)("div",{className:"x-grid",children:Object(o.jsx)("div",{className:"frame",children:Object(o.jsx)("div",{className:"grid-holder",children:Object(o.jsx)(et.a,{className:"customers-grid",rows:c($(e.getQueryData("customers")||[])),columns:tt,sortModel:[{field:"customerName",sort:"asc"}],loading:e.isFetching("customers"),rowHeight:35,headerHeight:35,pagination:!0,disableSelectionOnClick:!0})})})})]})}var nt=r(421),at=r(246),ot=r(250);var it=Object(L.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"4px",boxShadow:e.shadows[5],padding:e.spacing(2,4),width:"40%","& .MuiOutlinedInput-inputMarginDense":{padding:"8px !important"}},link:{cursor:"pointer",color:e.palette.primary.main},h2:{textAlign:"center",fontWeight:"400",marginBottom:"1rem"},buttons:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr"},clearButton:{backgroundColor:"rgb(210,0,10)",color:"white",marginRight:"1rem","&:hover":{backgroundColor:"rgb(190,0,10)"}},rowOne:{gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr 1fr 1fr",gridColumnGap:"15px",gridRowGap:"10px"},rowTwo:{gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"1fr 1fr 1fr",gridRowGap:"10px"},longTextField:{gridColumnStart:1,gridColumnEnd:3},billNo:{gridColumn:4},switchHolder:{gridColumn:3,justifySelf:"end","& .MuiFormControlLabel-root":{margin:0}},auxiliaryRow:{display:"grid",gridColumnGap:"20px",gridTemplateRows:"1fr",gridTemplateColumns:"1fr 1fr 1fr 1fr",margin:"2rem auto 1rem auto","& .MuiOutlinedInput-input":{padding:"8px"},"& .MuiButtonBase-root":{padding:"2px !important"},"& .MuiOutlinedInput-adornedEnd":{paddingRight:"3px"},"& #date-picker-inline-label":{transform:"translate(14px, 10px) scale(1)"}}}})),st=P.c({customer:P.c({customerName:P.d().required(),customerGroup:P.d().nullable(),city:P.d().nullable(),info:P.d().nullable(),firstPerson:P.d().trim().max(25).nullable(),firstPhone:P.d().max(10).min(10).nullable(),firstEmail:P.d().email().nullable(),secondPerson:P.d().trim().max(25).nullable(),secondPhone:P.d().max(10).min(10).nullable(),secondEmail:P.d().email().nullable(),thirdPerson:P.d().trim().max(25).nullable(),thirdPhone:P.d().max(10).min(10).nullable(),thirdEmail:P.d().email().nullable()})});function ct(){var e=it(),t=Object(x.c)((function(e){return e.showCustomerModal})),r=function(){var e=Object(h.b)(),t=Object(x.b)();return Object(fe.a)((function(e){return 0===e.customer.customerId?te.a.post("/api/customers/",e.customer):te.a.put("/api/customers/",e.customer)}),{onSuccess:function(r,n){e.invalidateQueries("customers"),t(H()),n.setStatus({success:!0,error:!1})},onError:function(e,t){console.log(e),t.setStatus({success:!1,error:!0})}})}(),n=Object(x.b)(),a=p.a.useState({success:!1,error:!1}),i=Object(S.a)(a,2),s=i[0],c=i[1],l=function(){c({success:!1,error:!1})};return Object(o.jsxs)("div",{children:[Object(o.jsx)(ot.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:e.modal,open:t.show,onClose:function(){return n(H())},closeAfterTransition:!0,BackdropComponent:nt.a,BackdropProps:{timeout:500},children:Object(o.jsx)(at.a,{in:t.show,children:Object(o.jsx)("div",{className:e.paper,children:Object(o.jsx)(F.c,{validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,initialValues:{customer:t.customer},onSubmit:function(e){r.mutate({customer:e.customer,setStatus:c})},validationSchema:st,children:function(n){var a,i,s,c,l,d,u,m,b,p,j,v,f,O=n.values,h=n.errors,g=n.validateField;return Object(o.jsxs)(F.b,{children:[Object(o.jsx)(C.a,{className:e.h2,component:"h2",variant:"h5",children:t.customer.customerName?t.customer.customerName:"\u041d\u043e\u0432\u0438\u0439 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a"}),Object(o.jsxs)("div",{className:"row__one ".concat(e.rowOne),children:[Object(o.jsx)(F.a,{className:e.longTextField,name:"customer.customerName",label:"\u041d\u0430\u0437\u0432\u0430 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430",error:null===h||void 0===h||null===(a=h.customer)||void 0===a?void 0:a.customerName,validator:g,component:ye,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.customerGroup",label:"\u0413\u0440\u0443\u043f\u0430",error:null===h||void 0===h||null===(i=h.customer)||void 0===i?void 0:i.customerGroup,validator:g,component:ye,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(F.a,{className:e.longTextField,name:"customer.info",label:"\u041f\u0440\u0438\u043c\u0456\u0442\u043a\u0430",error:null===h||void 0===h||null===(s=h.customer)||void 0===s?void 0:s.info,validator:g,component:ye,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.city",label:"\u041c\u0456\u0441\u0442\u043e",error:null===h||void 0===h||null===(c=h.customer)||void 0===c?void 0:c.city,validator:g,component:ye,numeric:!1,disabled:r.isLoading})]}),Object(o.jsxs)("div",{className:"".concat(e.rowTwo," row__two"),children:[Object(o.jsx)(F.a,{name:"customer.firstPerson",label:"\u041a\u043e\u043d\u0442. \u041e\u0441\u043e\u0431\u0430 1",error:null===h||void 0===h||null===(l=h.customer)||void 0===l?void 0:l.firstPerson,validator:g,component:ye,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.firstPhone",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d (\u0431\u0435\u0437 +38)",error:null===h||void 0===h||null===(d=h.customer)||void 0===d?void 0:d.firstPhone,validator:g,component:ye,phone:!0,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.firstEmail",label:"Email",error:null===h||void 0===h||null===(u=h.customer)||void 0===u?void 0:u.firstEmail,validator:g,component:ye,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.secondPerson",label:"\u041a\u043e\u043d\u0442. \u041e\u0441\u043e\u0431\u0430 2",error:null===h||void 0===h||null===(m=h.customer)||void 0===m?void 0:m.secondPerson,validator:g,component:ye,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.secondPhone",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d (\u0431\u0435\u0437 +38)",error:null===h||void 0===h||null===(b=h.customer)||void 0===b?void 0:b.secondPhone,validator:g,component:ye,phone:!0,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.secondEmail",label:"Email",error:null===h||void 0===h||null===(p=h.customer)||void 0===p?void 0:p.secondEmail,validator:g,component:ye,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.thirdPerson",label:"\u041a\u043e\u043d\u0442. \u041e\u0441\u043e\u0431\u0430 3",error:null===h||void 0===h||null===(j=h.customer)||void 0===j?void 0:j.thirdPerson,validator:g,component:ye,numeric:!1,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.thirdPhone",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d (\u0431\u0435\u0437 +38)",error:null===h||void 0===h||null===(v=h.customer)||void 0===v?void 0:v.thirdPhone,validator:g,component:ye,phone:!0,disabled:r.isLoading}),Object(o.jsx)(F.a,{name:"customer.thirdEmail",label:"Email",error:null===h||void 0===h||null===(f=h.customer)||void 0===f?void 0:f.thirdEmail,validator:g,component:ye,numeric:!1,disabled:r.isLoading})]}),Object(o.jsxs)("div",{className:e.buttons,children:[Object(o.jsx)(N.a,{style:{gridColumn:2},color:"primary",variant:"contained",className:e.button,disabled:r.isLoading,type:"submit",children:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430"}),O.customer.customerId&&Object(o.jsx)("div",{className:e.switchHolder,children:Object(o.jsx)(Ie,{name:"customer.debtor",label:"\u0411\u043e\u0440\u0436\u043d\u0438\u043a",isChecked:O.customer.debtor,disabled:r.isLoading})})||null]})]})}})})})}),Object(o.jsx)(ge,{type:"success",open:s.success,onClose:l,message:"\u0417\u0430\u043c\u043e\u0432\u0438\u043d\u043a\u0430 \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043e."}),Object(o.jsx)(ge,{type:"error",open:s.error,onClose:l,message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430. \u041c\u043e\u0436\u043b\u0438\u0432\u043e \u043a\u043b\u0456\u0454\u043d\u0442 \u0437\u0456 \u0441\u0445\u043e\u0436\u043e\u044e \u0456\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0456\u0454\u044e \u0432\u0436\u0435 \u0456\u0441\u043d\u0443\u0454."})]})}var lt=r(475),dt=r(487),ut=r(472),mt=(r(407),Object(L.a)((function(){return{root:{flexGrow:1},logoutButton:{padding:0},logoutHolder:{display:"flex",justifyContent:"flex-end",alignItems:"baseline",whiteSpace:"nowrap"},tabs:{margin:"0 auto",cursor:"pointer"}}})));function bt(e){var t=e.radius,r=mt(),n=Object(w.g)(),a=Object(h.b)(),i=p.a.useState(0),s=Object(S.a)(i,2),c=s[0],l=s[1];return Object(o.jsx)("div",{children:Object(o.jsx)("div",{className:"header__container",children:Object(o.jsx)("div",{className:"menu",style:{borderBottomLeftRadius:t,borderBottomRightRadius:t},children:Object(o.jsxs)(ut.a,{children:[Object(o.jsx)(Ze.a,{color:"inherit",href:"https://psdruk.com.ua/",children:Object(o.jsx)("img",{width:"110",height:"50",src:"/img/logo.svg",alt:"logo"})}),Object(o.jsxs)(dt.a,{className:r.tabs,value:c,onChange:function(e,t){switch(l(t),t){case 0:n.push("/");break;case 1:a.invalidateQueries("customers"),n.push("/clients")}},TabIndicatorProps:{style:{background:"white"}},indicatorColor:"secondary","aria-label":"scrollable auto tabs example",children:[Object(o.jsx)(lt.a,{label:"\u0413\u043e\u043b\u043e\u0432\u043d\u0430"}),Object(o.jsx)(lt.a,{label:"\u041a\u043b\u0456\u0454\u043d\u0442\u0438"})]}),Object(o.jsxs)("div",{className:r.logoutHolder,children:[Object(o.jsxs)(C.a,{variant:"body1",style:{fontWeight:300},children:["\u0412\u0456\u0442\u0430\u0454\u043c\u043e, ",Object(o.jsx)("b",{children:localStorage.getItem("username")})]}),Object(o.jsx)(N.a,{color:"inherit",onClick:function(){ie(),n.push("/login")},className:r.logoutButton,children:"\u0412\u0438\u0439\u0442\u0438"})]})]})})})})}var pt=r(493),jt=r(484),vt=r(476),ft=r(477),Ot=r(478),ht=r(236),gt=r.n(ht);function xt(){return Object(o.jsxs)(C.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(o.jsx)(Ze.a,{color:"inherit",href:"https://psdruk.com.ua/",children:"psdruk.com.ua"})," ",(new Date).getFullYear(),"."]})}var yt=Object(L.a)((function(e){return{paper:{marginTop:e.spacing(20),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function wt(){var e=yt(),t=Object(w.g)(),r=Object(x.b)(),n=Object(b.useState)({username:"",password:""}),i=Object(S.a)(n,2),s=i[0],c=i[1],l=Object(b.useState)(!1),d=Object(S.a)(l,2),u=d[0],m=d[1],p=Object(b.useState)(!1),j=Object(S.a)(p,2),v=j[0],f=j[1],O=Object(b.useState)(!1),h=Object(S.a)(O,2),g=h[0],y=h[1],C=function(){m(!1),f(!1)};return Object(o.jsxs)(vt.a,{component:"main",maxWidth:"xs",children:[Object(o.jsx)(ft.a,{}),Object(o.jsxs)("div",{className:e.paper,children:[Object(o.jsx)(pt.a,{className:e.avatar,children:Object(o.jsx)(gt.a,{})}),Object(o.jsxs)("form",{className:e.form,onSubmit:function(e){e.preventDefault(),y(!0),oe(s).then((function(e){e.roles.includes("ROLE_CUSTOMER")?m(!0):(r(q(e.token,e.employee,e.username,e.roles)),t.push("/"))})).catch((function(){y(!1),f(!0)}))},children:[Object(o.jsx)(B.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",onChange:function(e){return c(Object(a.a)(Object(a.a)({},s),{},{username:e.target.value}))},label:"\u041b\u043e\u0433\u0456\u043d",name:"email",autoComplete:"off",autoFocus:!0}),Object(o.jsx)(B.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",id:"password",onChange:function(e){return c(Object(a.a)(Object(a.a)({},s),{},{password:e.target.value}))},autoComplete:"off"}),Object(o.jsx)(N.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,disabled:g,children:"\u0412\u0445\u0456\u0434"}),Object(o.jsxs)(Ot.a,{container:!0,children:[Object(o.jsx)(Ot.a,{item:!0,xs:!0,children:Object(o.jsx)(Ze.a,{href:"http://plg-site.32server.in.ua/",variant:"body2",children:"\u0417\u0430\u0431\u0443\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"})}),Object(o.jsx)(Ot.a,{item:!0,children:Object(o.jsx)(Ze.a,{href:"http://plg-site.32server.in.ua/",variant:"body2",children:"\u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u0443\u0432\u0430\u0442\u0438\u0441\u044c"})})]})]})]}),Object(o.jsx)(jt.a,{mt:8,children:Object(o.jsx)(xt,{})}),Object(o.jsx)(ge,{type:"error",open:u,onClose:C,message:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0449\u0435 \u043d\u0435 \u043f\u0440\u043e\u0439\u0448\u043e\u0432 \u043f\u0435\u0440\u0435\u0432\u0456\u0440\u043a\u0443."}),Object(o.jsx)(ge,{type:"error",open:v,onClose:C,message:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0456 \u0434\u0430\u043d\u0456 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0443."})]})}var St=r(469),Ct=r(479),Nt=r(470),kt=r(480),It=r(471);var Tt=r(248),Lt=Object(L.a)((function(e){return{arrow:{color:e.palette.primary.main},tooltip:{fontSize:12,backgroundColor:e.palette.primary.main}}}));var _t=function(e){var t=e.title,r=(e.value,e.placement),n=void 0===r?"right-start":r,i=e.children,s=Object(A.a)(e,["title","value","placement","children"]),c=Lt();return Object(o.jsx)(Tt.a,Object(a.a)(Object(a.a)({title:t,placement:n,arrow:!0,classes:c},s),{},{children:Object(o.jsx)("div",{className:"value",style:{lineHeight:"1.43"},children:i})}))},Et=Object(L.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"4px",boxShadow:e.shadows[5],padding:e.spacing(2,4),width:"55%"},link:{cursor:"pointer",color:e.palette.primary.main},h2:{top:"-.9rem",position:"relative",marginTop:0,textAlign:"center",fontWeight:"400",gridColumnEnd:4,gridColumnStart:2},buttons:{display:"flex",justifyContent:"flex-end"},clearButton:{backgroundColor:"rgb(210,0,10)",color:"white",marginRight:"1rem","&:hover":{backgroundColor:"rgb(190,0,10)"}},rowOne:{gridTemplateColumns:"1fr 1fr 1fr 1fr"},rowTwo:{gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr 1fr 1fr"},billNo:{gridColumn:4},auxiliaryRow:{display:"grid",gridColumnGap:"20px",gridTemplateRows:"1fr",gridTemplateColumns:"1fr 1fr 1fr 1fr",margin:"2rem auto 1rem auto","& .MuiOutlinedInput-input":{padding:"8px"},"& .MuiButtonBase-root":{padding:"2px !important"},"& .MuiOutlinedInput-adornedEnd":{paddingRight:"3px"},"& #date-picker-inline-label":{transform:"translate(14px, 10px) scale(1)"}}}})),Dt=P.c({order:P.c({entrepreneur:P.c().required(),customer:P.c().required(),date:P.a().required(),orderType:P.c().required(),orderKind:P.c().required(),billNo:P.b().lessThan(2e9).positive().min(0),width:P.b().lessThan(2e9).positive().min(0).required(),height:P.b().lessThan(2e9).positive().min(0).required(),amount:P.b().lessThan(2e9).positive().min(0).required(),price:P.b().lessThan(2e9).positive().min(0).required(),fees:P.b().lessThan(2e9).positive().min(0).required(),finalSum:P.b().lessThan(2e9).positive().min(0).required(),comment:P.d().trim().max(255).required(),payLog:P.d()})});function Rt(e){var t=e.user,r=e.roles,n=e.order,a=Et(),i=Object(h.b)(),s=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.delete("/api/orders/"+e.orderId)}),{onError:function(e,t){t.setStatus(!0)},onSuccess:function(t,r){e.invalidateQueries(["customers"]),e.invalidateQueries(["orders"]),r.setShowModal(!1)}})}(),c=function(){var e=null,t=Object(h.b)();return Object(fe.a)((function(e){return te.a.put("/api/orders/",e.order)}),{onMutate:function(r){t.getQueryCache().findAll(["orders",1]).forEach((function(n){t.setQueryData(n.queryKey,n.state.data.map((function(t){return t.orderId===r.order.orderId?(e=t,r.order):t})))}))},onError:function(r,n){n.setStatus(!0),t.getQueryCache().findAll(["orders",1]).forEach((function(r){t.setQueryData(r.queryKey,r.state.data.map((function(t){return t.orderId===e.orderId?e:t})))}))},onSuccess:function(e,r){t.invalidateQueries(["customers"]),t.invalidateQueries(["orders"]),r.toggleModal()}})}(),l=p.a.useState(!1),d=Object(S.a)(l,2),u=d[0],m=d[1],b=p.a.useState(!1),j=Object(S.a)(b,2),v=j[0],f=j[1],O=p.a.useState(!1),g=Object(S.a)(O,2),x=g[0],y=g[1],w=p.a.useState(!1),k=Object(S.a)(w,2),L=k[0],_=k[1],E=function(){return m(!u)},D=function(){return n.employee.employeeID!==t.employeeID},R=function(e){return r.includes(e)},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ROLE_ADMIN";return!R("ROLE_ADMIN")&&(!R(e)&&D())};return Object(o.jsxs)("div",{children:[Object(o.jsx)(_t,{title:n.employee.name,children:Object(o.jsx)(Ze.a,{className:a.link,onClick:E,children:Object(o.jsx)("b",{children:n.orderId})})}),Object(o.jsx)(ot.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:a.modal,open:u,onClose:E,closeAfterTransition:!0,BackdropComponent:nt.a,BackdropProps:{timeout:500},children:Object(o.jsx)(at.a,{in:u,children:Object(o.jsx)("div",{className:a.paper,children:Object(o.jsx)(F.c,{validateOnChange:!0,validateOnMount:!1,validateOnBlur:!1,initialValues:{order:n},onSubmit:function(e){c.mutate({order:e.order,toggleModal:E,setStatus:y})},validationSchema:Dt,children:function(e){var t,r,s,l,d,u,m,b,p,j,O,h,g,w,S,k,L=e.values,E=e.errors,D=e.validateField;return Object(o.jsxs)(F.b,{children:[Object(o.jsx)(ge,{type:"error",open:v,onClose:function(){return f(!1)},message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u0456 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f."}),Object(o.jsx)(ge,{type:"error",open:x,onClose:function(){return y(!1)},message:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u043d\u0456 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f."}),Object(o.jsxs)("div",{className:a.auxiliaryRow,children:[Object(o.jsx)(F.a,{component:Re,label:"\u0414\u0430\u0442\u0430",name:"order.date",error:null===E||void 0===E||null===(t=E.order)||void 0===t?void 0:t.date,validator:D,disabled:c.isLoading||M()}),Object(o.jsxs)(C.a,{className:a.h2,component:"h2",variant:"h5",children:["\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u044f \u2116 ",Object(o.jsx)("b",{children:n.orderId})]}),Object(o.jsx)(F.a,{className:a.billNo,name:"order.billNo",label:"\u2116 \u0420\u0430\u0445\u0443\u043d\u043a\u0443",disableCalculation:!0,error:null===E||void 0===E||null===(r=E.order)||void 0===r?void 0:r.billNo,validator:D,component:ye,disabled:c.isLoading||M("ROLE_MANAGER")})]}),Object(o.jsxs)("div",{className:"".concat(a.rowOne," row__one"),children:[Object(o.jsx)(F.a,{name:"order.entrepreneur",label:"\u041f\u0456\u0434\u043f\u0440\u0438\u0454\u043c\u0435\u0446\u044c",error:null===E||void 0===E||null===(s=E.order)||void 0===s?void 0:s.entrepreneur,validator:D,component:Z,disabled:c.isLoading||M(),getName:function(e){return e.fullName||""},options:i.getQueryData("entrepreneurs")}),Object(o.jsx)(F.a,{name:"order.customer",label:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",error:null===E||void 0===E||null===(l=E.order)||void 0===l?void 0:l.customer,validator:D,component:Z,disabled:c.isLoading||M(),getName:function(e){return e.customerName||""},options:i.getQueryData("customers")}),Object(o.jsx)(F.a,{name:"order.orderType",label:"\u0412\u0438\u0434",error:null===E||void 0===E||null===(d=E.order)||void 0===d?void 0:d.orderType,validator:D,component:Z,disabled:c.isLoading||M(),getName:function(e){return e.typeName||""},options:i.getQueryData("orderTypes")}),Object(o.jsx)(F.a,{name:"order.orderKind",label:"\u0422\u0438\u043f",error:null===E||void 0===E||null===(u=E.order)||void 0===u?void 0:u.orderKind,validator:D,component:Z,disabled:c.isLoading||M(),getName:function(e){return e.kindName||""},options:(null===(m=L.order)||void 0===m||null===(b=m.orderType)||void 0===b?void 0:b.orderKinds)||[]})]}),Object(o.jsxs)("div",{className:"".concat(a.rowTwo," row__two"),children:[Object(o.jsx)(F.a,{name:"order.width",label:"\u0428\u0438\u0440\u0438\u043d\u0430",error:null===E||void 0===E||null===(p=E.order)||void 0===p?void 0:p.width,validator:D,component:ye,disabled:c.isLoading||M()}),Object(o.jsx)(F.a,{name:"order.height",label:"\u0412\u0438\u0441\u043e\u0442\u0430",error:null===E||void 0===E||null===(j=E.order)||void 0===j?void 0:j.height,validator:D,component:ye,disabled:c.isLoading||M()}),Object(o.jsx)(F.a,{name:"order.amount",label:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c",error:null===E||void 0===E||null===(O=E.order)||void 0===O?void 0:O.amount,validator:D,component:ye,disabled:c.isLoading||M()}),Object(o.jsx)(T.a,{id:"metrics",size:"small",variant:"outlined",value:(L.order.width*L.order.height/1e6*L.order.amount).toFixed(3)||0,endAdornment:Object(o.jsx)(I.a,{position:"end",children:"\u043c\xb2"}),disabled:!0}),Object(o.jsx)(F.a,{name:"order.price",label:"\u0426\u0456\u043d\u0430",error:null===E||void 0===E||null===(h=E.order)||void 0===h?void 0:h.price,validator:D,component:ye,disabled:c.isLoading||M()}),Object(o.jsx)(F.a,{name:"order.fees",label:"\u041f\u043e\u0441\u043b\u0443\u0433\u0438",error:null===E||void 0===E||null===(g=E.order)||void 0===g?void 0:g.fees,validator:D,component:ye,disabled:c.isLoading||M()}),Object(o.jsx)(F.a,{name:"order.finalSum",label:"\u0421\u0443\u043c\u0430",error:null===E||void 0===E||null===(w=E.order)||void 0===w?void 0:w.finalSum,validator:D,component:ye,disableCalculation:!0,disabled:c.isLoading||M()})]}),Object(o.jsx)("div",{className:"row__three",children:Object(o.jsx)(F.a,{name:"order.comment",label:"\u041e\u043f\u0438\u0441 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",error:null===E||void 0===E||null===(S=E.order)||void 0===S?void 0:S.comment,validator:D,numeric:!1,component:ye,disabled:c.isLoading||M("ROLE_MANAGER")})}),Object(o.jsx)("div",{className:"row__three",children:Object(o.jsx)(F.a,{name:"order.payLog",label:"\u0406\u0441\u0442\u043e\u0440\u0456\u044f \u043e\u043f\u043b\u0430\u0442",error:null===E||void 0===E||null===(k=E.order)||void 0===k?void 0:k.payLog,validator:D,numeric:!1,multiline:!0,component:ye,disabled:c.isLoading||M()})}),Object(o.jsxs)("div",{className:a.buttons,children:[Object(o.jsx)(N.a,{className:a.clearButton,disabled:c.isLoading||M(),variant:"contained",type:"button",onClick:function(){return _(!0)},children:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438"}),Object(o.jsx)(N.a,{color:"primary",variant:"contained",className:a.button,disabled:c.isLoading||M("ROLE_MANAGER"),type:"submit",children:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"})]})]})}})})})}),Object(o.jsxs)(St.a,{fullScreen:!1,open:L,onClose:function(){return _(!1)},"aria-labelledby":"responsive-dialog-title",children:[Object(o.jsx)(Ct.a,{id:"responsive-dialog-title",children:"\u0412\u0438 \u0434\u0456\u0439\u0441\u043d\u043e \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0446\u0435 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f?"}),Object(o.jsx)(Nt.a,{children:Object(o.jsx)(kt.a,{children:"\u041f\u043e\u0432\u0435\u0440\u043d\u0443\u0442\u0438 \u0439\u043e\u0433\u043e \u0437\u043c\u0456\u0441\u0442 \u0442\u0430 \u043e\u043f\u043b\u0430\u0442\u0438 \u0431\u0443\u0434\u0435 \u043d\u0435\u043c\u043e\u0436\u043b\u0438\u0432\u043e. \u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438?"})}),Object(o.jsxs)(It.a,{children:[Object(o.jsx)(N.a,{autoFocus:!0,onClick:function(){return _(!1)},variant:"contained",color:"primary",children:"\u041d\u0456"}),Object(o.jsx)(N.a,{onClick:function(){return e=n.orderId,_(!1),void s.mutate({orderId:e,setStatus:y,setShowModal:m});var e},variant:"contained",className:a.clearButton,autoFocus:!0,children:"\u0422\u0430\u043a"})]})]})]})}var Mt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((function(e){return 0===e.orderId?(e.id=t,e.orderId=t):e.id=e.orderId,e.date?e.date=new Date(e.date):e.date=new Date,e}))},Ft=function(){var e=Object(ae.a)(ne.a.mark((function e(t){var r,n,o,i;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={orderId:null,customer:null,entrepreneur:null,employee:null,status:null,dateFrom:null,dateTill:null,payDateFrom:null,payDateTill:null,receiver:null,orderKind:null,orderType:null,details:""},n=Object(a.a)(Object(a.a)({},r),{},{orderId:null===t||void 0===t?void 0:t.orderId,customer:null===t||void 0===t?void 0:t.customer,entrepreneur:null===t||void 0===t?void 0:t.entrepreneur,employee:null===t||void 0===t?void 0:t.employee,status:null===t||void 0===t?void 0:t.status,dateFrom:null===t||void 0===t?void 0:t.dateFrom,dateTill:null===t||void 0===t?void 0:t.dateTill,payDateFrom:null===t||void 0===t?void 0:t.payDateFrom,payDateTill:null===t||void 0===t?void 0:t.payDateTill,receiver:null===t||void 0===t?void 0:t.receiver,orderKind:null===t||void 0===t?void 0:t.orderKind,orderType:null===t||void 0===t?void 0:t.orderType,details:null===t||void 0===t?void 0:t.details}),e.next=4,te.a.post("/api/orders/filter/",n);case 4:if(o=e.sent,!(i=o.data)){e.next=8;break}return e.abrupt("return",Mt(i));case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var Pt=r(180);var At=["","img/on-agreement.svg","img/in-progress.svg","img/ready.svg","img/completed.svg"],Qt=Object(L.a)((function(e){return{container:{padding:e.spacing(1),textAlign:"center",backgroundColor:"#fff",boxShadow:"0 0 14px 2px rgba(0, 0, 0, 0.3)",borderRadius:"4px"},acceptanceButton:{width:"100%",margin:".2rem 0",backgroundColor:"#fff",border:"1px solid",borderColor:"#df16a0",color:"#df16a0","&:hover":{color:"#fff",backgroundColor:"#df16a0"}},inWorkButton:{width:"100%",margin:".2rem 0",backgroundColor:"#fff",border:"1px solid",borderColor:e.palette.primary.main,color:e.palette.primary.main,"&:hover":{color:"#fff",backgroundColor:e.palette.primary.main}},readyButton:{width:"100%",margin:".2rem 0",backgroundColor:"#fff",border:"1px solid",borderColor:"#28a745",color:"#28a745","&:hover":{color:"#fff",backgroundColor:"#28a745"}},completedButton:{width:"100%",margin:".2rem 0",backgroundColor:"#28a745",border:"1px solid",borderColor:"#28a745",color:"#fff","&:hover":{borderColor:"#218838",backgroundColor:"#218838"}},popper:{zIndex:1,marginLeft:"0.5rem",'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.9em",marginTop:"0.45rem",height:"3em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.background.paper," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.9em",marginTop:"0.45rem",height:"3em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.background.paper)}}},arrow:{position:"absolute",fontSize:7,width:"3em",height:"3em","&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}}}));var Bt=function(e){var t=e.orderId,r=e.status,n=Qt(),a=function(){var e=Object(h.b)();return Object(fe.a)((function(e){return te.a.get("/api/orders/statuses/"+e.orderId+"/"+e.statusId)}),{onSuccess:function(t,r){e.invalidateQueries("orders"),r.toggle()}})}(),i=p.a.useRef(null),s=p.a.useState(!0),c=Object(S.a)(s,1)[0],l=p.a.useState(!1),d=Object(S.a)(l,2),u=d[0],m=d[1],b=p.a.useState(null),j=Object(S.a)(b,2),v=j[0],f=j[1],O=u?"scroll-playground":null,g=function(){return m((function(e){return!e}))};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("img",{className:n.img,ref:i,src:At[r],width:"19",height:"19",alt:"on-agreement","aria-describedby":O,variant:"contained",color:"primary",onClick:g}),Object(o.jsxs)(Pt.a,{id:O,open:u,anchorEl:i.current,placement:"right",disablePortal:!0,className:n.popper,modifiers:{flip:{enabled:!0},preventOverflow:{enabled:!0,boundariesElement:"scrollParent"},arrow:{enabled:!0,element:v}},children:[c?Object(o.jsx)("span",{className:n.arrow,ref:f}):null,Object(o.jsxs)("div",{className:n.container,children:[Object(o.jsx)(N.a,{className:n.acceptanceButton,onClick:function(){return a.mutate({orderId:t,statusId:1,toggle:g})},children:"\u041d\u0430 \u043f\u043e\u0433\u043e\u0434\u0436\u0435\u043d\u043d\u0456"}),Object(o.jsx)("br",{}),Object(o.jsx)(N.a,{className:n.inWorkButton,onClick:function(){return a.mutate({orderId:t,statusId:2,toggle:g})},children:"\u0412 \u0440\u043e\u0431\u043e\u0442\u0456"}),Object(o.jsx)("br",{}),Object(o.jsx)(N.a,{className:n.readyButton,onClick:function(){return a.mutate({orderId:t,statusId:3,toggle:g})},children:"\u0413\u043e\u0442\u043e\u0432\u0435"}),Object(o.jsx)("br",{}),Object(o.jsx)(N.a,{className:n.completedButton,o:!0,onClick:function(){return a.mutate({orderId:t,statusId:4,toggle:g})},children:"\u0412\u0456\u0434\u0434\u0430\u043d\u043e"})]})]})]})};r(411);function zt(e,t){return e.localeCompare(t)}var Kt=function(e){return new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(e)};function Ut(e){var t=e.tableID,r=Object(b.useState)({orderId:"desc"}),n=Object(S.a)(r,2),a=n[0],i=n[1],s=Object(b.useState)(""),c=Object(S.a)(s,2),l=c[0],d=c[1],u=Object(x.c)((function(e){return e.sortSelections})),m=Object(x.c)((function(e){return e.auth})),p=function(e,t){return Object(Pe.a)(["orders",e,t],(function(){return Ft(t)}),{initialData:[],initialStale:!0,keepPreviousData:!1})}(t,u[u.active]),j=Object(h.b)(),v=Object(fe.a)((function(e){return te.a.post("api/orders/export/",{orders:e},{responseType:"arraybuffer"})}),{onError:function(e,t){t.setStatus({success:!1,error:!0})},onSuccess:function(e,t){var r=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r);else{var n=window.URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.download="\u0421\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u044c.xlsx",a.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}}),f=function(e){return e.filter((function(e){var t,r,n,a,o,i,s,c,d,u,m,b,p;return(null===(t=e.orderId)||void 0===t?void 0:t.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(r=e.billNo)||void 0===r?void 0:r.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||e.customer.customerName.toString().toLowerCase().indexOf(l.toLowerCase())>-1||(null===(n=Kt(e.date))||void 0===n?void 0:n.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(a=e.fees)||void 0===a?void 0:a.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(o=e.finalSum)||void 0===o?void 0:o.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(i=e.amount)||void 0===i?void 0:i.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(s=e.price)||void 0===s?void 0:s.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(c=e.height)||void 0===c?void 0:c.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(d=e.width)||void 0===d?void 0:d.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(u=e.m2)||void 0===u?void 0:u.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(m=e.orderKind.kindName)||void 0===m?void 0:m.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(b=e.orderType.typeName)||void 0===b?void 0:b.toString().toLowerCase().indexOf(l.toLowerCase()))>-1||(null===(p=e.comment)||void 0===p?void 0:p.toString().toLowerCase().indexOf(l.toLowerCase()))>-1}))};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(B.a,{variant:"outlined",size:"small",placeholder:"\u0428\u0432\u0438\u0434\u043a\u0438\u0439 \u043f\u043e\u0448\u0443\u043a",onChange:function(e){return d(e.target.value)},InputProps:{endAdornment:m.roles.includes("ROLE_ORDERS_EXPORTER")&&Object(o.jsx)(N.a,{className:"export-btn",variant:"outlined",onClick:function(){return v.mutate(f(p.data))},children:"\u0415\u043a\u0441\u043f\u043e\u0440\u0442"})}}),Object(o.jsxs)("div",{className:"x-grid",children:[u[u.active].customer&&Object(o.jsx)("div",{className:"action__bar__stat",children:Object(o.jsxs)("label",{children:["\u0421\u0443\u043c\u0430 \u0431\u043e\u0440\u0433\u0443 : ",Object(o.jsx)("b",{children:function(e){var t=j.getQueryData("customers").find((function(t){return t.customerId===e.customerId}));return p.data.reduce((function(e,t){return e+(t.finalSum-t.paySum)}),0)-t.money}(u[u.active].customer)})," \u0433\u0440\u043d"]})}),Object(o.jsx)("div",{className:"frame",children:Object(o.jsx)("div",{className:"grid-holder",children:Object(o.jsx)(et.a,{rows:f(p.data),columns:function(e){var t=[{field:"orderId",type:"number",headerName:"\u2116",flex:.8,renderCell:function(e){return Object(o.jsx)(Rt,{user:m.loggedUser,roles:m.roles,order:e.row})}},{field:"billNo",type:"number",headerName:"\u0420\u0430\u0445",flex:.6},{field:"customer",headerName:"\u0417\u0430\u043c\u043e\u0432\u043d\u0438\u043a",flex:2.2,sortComparator:function(e,t){return zt(e.customerName,t.customerName)},valueFormatter:function(e){return e.value.customerName},renderCell:function(e){return Object(o.jsx)(Ze.a,{className:"name-link",onClick:function(){return ve.dispatch(W(e.row.customer))},children:e.value.info?Object(o.jsx)(_t,{title:e.value.info,children:Object(o.jsx)("b",{children:e.value.customerName})}):Object(o.jsx)("b",{children:e.value.customerName})})}},{field:"date",type:"dateTime",headerName:"\u0414\u0430\u0442\u0430",flex:1.2,valueFormatter:function(e){return Kt(e.value)}},{field:"width",type:"number",headerName:"\u0428\u0438\u0440\u0438\u043d\u0430",valueFormatter:function(e){return e.value},flex:1.09},{field:"height",type:"number",headerName:"\u0412\u0438\u0441\u043e\u0442\u0430",valueFormatter:function(e){return e.value},flex:1},{field:"amount",type:"number",headerName:"\u041a-\u0441\u0442\u044c",valueFormatter:function(e){return e.value},flex:.85},{field:"m2",type:"number",headerName:"\u041c2",valueFormatter:function(e){return Number.parseFloat(e.value).toFixed(3)},flex:.9},{field:"price",type:"number",headerName:"\u0426\u0456\u043d\u0430",valueFormatter:function(e){return e.value},flex:.8},{field:"fees",type:"number",headerName:"\u041f\u043e\u0441\u043b\u0443\u0433\u0438",valueFormatter:function(e){return e.value},flex:1},{field:"finalSum",type:"number",headerName:"\u0421\u0443\u043c\u0430",flex:.9,renderCell:function(e){return Object(o.jsxs)("b",{children:[" ",e.value," "]})}},{field:"paid",headerName:"\u041e\u043f\u043b\u0430\u0442\u0430",sortable:!1,flex:1.1,cellClassName:"centered",renderCell:function(e){return e.row.paySum===e.row.finalSum?Object(o.jsx)(_t,{title:Kt(new Date(e.row.payDate)),arrow:!0,children:Object(o.jsx)("img",{src:"img/completed.svg",width:"19",height:"19",alt:"paid"})}):e.row.paySum>0?Object(o.jsx)(_t,{title:e.row.paySum+" \u0433\u0440\u043d, "+Kt(new Date(e.row.payDate)),arrow:!0,children:Object(o.jsx)("img",{src:"img/partly_paid.svg",width:"19",height:"19",alt:"partly__paid"})}):void 0}},{field:"status",headerName:"\u0421\u0442\u0430\u0442\u0443\u0441",flex:1.1,cellClassName:"centered",sortComparator:function(e,t){return e.id-t.id},renderCell:function(e){return Object(o.jsx)(Bt,{orderId:e.row.orderId,status:e.row.status.id})}},{field:"orderType",type:"string",headerName:"\u0412\u0438\u0434",flex:1.8,sortComparator:function(e,t){return zt(e.typeName,t.typeName)},valueFormatter:function(e){return e.value.typeName}},{field:"orderKind",headerName:"\u0422\u0438\u043f",flex:1.8,sortComparator:function(e,t){return zt(e.kindName,t.kindName)},valueFormatter:function(e){return e.value.kindName}},{field:"comment",headerName:"\u041e\u043f\u0438\u0441 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",flex:6,sortComparator:function(e,t){return zt(e,t)},renderCell:function(e){return Object(o.jsx)(_t,{title:e.value,placement:"left-start",children:e.value})}}];return Object.keys(e).forEach((function(r){return t.find((function(e){return e.field===r})).sortDirection=e[r]})),Object.values(t)}(a),onSortModelChange:function(e){var t,r,n={};e.sortModel.length>0?n[null===(t=e.sortModel[0])||void 0===t?void 0:t.field]=null===(r=e.sortModel[0])||void 0===r?void 0:r.sort:n.orderId="desc";i(n)},loading:p.isLoading,rowHeight:35,headerHeight:35,pagination:!0,disableSelectionOnClick:!0})})})]})]})}var qt=function(){var e,t=Object(b.useState)(0),r=Object(S.a)(t,2),n=r[0],a=r[1];return Object(Pe.a)("customers",Ae,{refetchOnWindowFocus:!1}),Object(Pe.a)("entrepreneurs",Qe,{initialData:[],initialStale:!0,keepPreviousData:!0,refetchOnWindowFocus:!1}),Object(Pe.a)("orderTypes",Be,{initialData:[],initialStale:!0,keepPreviousData:!0}),Object(Pe.a)("statuses",ze,{initialData:[],initialStale:!0,keepPreviousData:!0,refetchOnWindowFocus:!1}),Object(Pe.a)("ce-links",Ue,{initialData:[],initialStale:!0,keepPreviousData:!0}),Object(Pe.a)("cp-links",qe,{initialData:[],initialStale:!0,keepPreviousData:!0}),Object(b.useEffect)((function(){var e,t;n||a(window.innerHeight-(32+(null===(e=document.getElementsByClassName("action__bar__button")[0])||void 0===e?void 0:e.clientHeight)+(null===(t=document.getElementsByClassName("main__header")[0])||void 0===t?void 0:t.clientHeight)))}),[n]),Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)(y.a,{children:Object(o.jsxs)(w.d,{children:[Object(o.jsx)(w.b,{path:"/login",children:Object(o.jsx)(wt,{})}),Object(o.jsx)(w.b,{exact:!0,path:"/",children:Object(o.jsxs)("div",{className:"main",children:[Object(o.jsxs)("div",{className:"main__header",children:[Object(o.jsx)(bt,{radius:0}),Object(o.jsx)(Xe,{})]}),Object(o.jsx)("div",{className:"main__table",style:{height:n},children:Object(o.jsx)(Ut,{tableID:1})})]})}),Object(o.jsx)(w.b,{path:"/clients",children:Object(o.jsxs)("div",{className:"clients",children:[Object(o.jsx)("div",{className:"clients__header",children:Object(o.jsx)(bt,{radius:4})}),Object(o.jsx)("div",{className:"clients__table",style:{height:window.innerHeight-(62+(null===(e=document.getElementsByClassName("clients__header")[0])||void 0===e?void 0:e.clientHeight))},children:Object(o.jsx)(rt,{})})]})})]})}),Object(o.jsx)(ct,{})]})},Gt=(r(412),r(152));r(413);var Wt,Ht,Vt,Jt,$t,Yt,Xt,Zt,er,tr=function(){return Object(o.jsx)(Gt.a,{elevation:3,className:"blue-holder",children:Object(o.jsxs)(Gt.a,{elevation:3,className:"info",children:[Object(o.jsxs)("div",{className:"blank-page",children:[Object(o.jsx)(C.a,{variant:"h4",component:"h3",children:"\u0421\u0442\u043e\u0440\u0456\u043d\u043a\u0430 \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u0430"})," ",Object(o.jsx)(C.a,{variant:"h2",component:"h3",children:"404"})]}),Object(o.jsx)(jt.a,{mt:8,children:Object(o.jsxs)(C.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(o.jsx)(Ze.a,{color:"inherit",href:"https://psdruk.com.ua/",children:"psdruk.com.ua"})," ",(new Date).getFullYear(),"."]})})]})})},rr=function(e){var t=e.component,r=Object(A.a)(e,["component"]),n=Object(x.c)((function(e){return e.auth})),i=localStorage.getItem("token"),s=localStorage.getItem("username"),c=localStorage.getItem("roles"),l=JSON.parse(localStorage.getItem("loggedUser"));return Object(o.jsx)(w.b,Object(a.a)(Object(a.a)({},r),{},{render:function(e){return n.isAuthenticated?Object(o.jsx)(t,Object(a.a)({},e)):i?(ve.dispatch(q(i,l,s,c)),Object(o.jsx)(t,Object(a.a)({},e))):Object(o.jsx)(w.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},nr=Object(c.a)({palette:{primary:{light:"#fff",main:"rgba(0, 60, 170, 0.95)",dark:"rgba(0, 40, 170, 0.95)"},secondary:{main:"#f44336"}},typography:{useNextVariants:!0,fontSize:11,htmlFontSize:15}},d.ukUA),ar=nr.breakpoints,or=Object(a.a)(Object(a.a)({},nr),{},{overrides:{MuiInputLabel:{root:(Wt={fontSize:11},Object(n.a)(Wt,ar.up("lg"),{fontSize:11}),Object(n.a)(Wt,ar.down(1300),{fontSize:9}),Wt)},MuiInputAdornment:{root:(Ht={fontSize:11},Object(n.a)(Ht,ar.up("lg"),{fontSize:11}),Object(n.a)(Ht,ar.down(1300),{fontSize:9}),Ht)},MuiInputBase:{root:(Vt={fontSize:11},Object(n.a)(Vt,ar.up("lg"),{fontSize:11}),Object(n.a)(Vt,ar.down(1300),{fontSize:9}),Vt)},MuiTypography:{root:(Jt={fontSize:11},Object(n.a)(Jt,ar.up("lg"),{fontSize:11}),Object(n.a)(Jt,ar.down(1300),{fontSize:9}),Jt),subtitle1:($t={fontSize:11},Object(n.a)($t,ar.up("lg"),{fontSize:11}),Object(n.a)($t,ar.down(1300),{fontSize:9}),$t),body1:(Yt={fontSize:12},Object(n.a)(Yt,ar.up("lg"),{fontSize:12}),Object(n.a)(Yt,ar.down(1300),{fontSize:10}),Yt),button:(Xt={fontSize:11},Object(n.a)(Xt,ar.up("lg"),{fontSize:11}),Object(n.a)(Xt,ar.down(1300),{fontSize:9}),Xt)},MuiButton:{root:(Zt={fontSize:11},Object(n.a)(Zt,ar.up("lg"),{fontSize:11}),Object(n.a)(Zt,ar.down(1300),{fontSize:9}),Zt)},MuiTab:{root:(er={fontSize:11},Object(n.a)(er,ar.up("lg"),{fontSize:11}),Object(n.a)(er,ar.down(1300),{fontSize:9}),er)},MuiSvgIcon:{root:Object(n.a)({},ar.down(1300),{fontSize:15})}}});Date.prototype.toISOString=function(){var e=Object(s.a)(this);return e.substr(0,e.indexOf("+"))};var ir=new f.a,sr=new O.a({queryCache:ir});v.a.render(Object(o.jsx)(l.a,{theme:or,children:Object(o.jsxs)(h.a,{client:sr,children:[Object(o.jsx)(u.a,{utils:i.a,locale:m.a,children:Object(o.jsx)(x.a,{store:ve,children:Object(o.jsx)(y.a,{children:Object(o.jsxs)(w.d,{children:[Object(o.jsx)(w.b,{path:"/login",component:wt}),Object(o.jsx)(rr,{path:"/",component:qt}),Object(o.jsx)(w.b,{path:"*",component:tr})]})})})}),Object(o.jsx)(g.ReactQueryDevtools,{})]})}),document.getElementById("root"))}},[[414,1,2]]]);
//# sourceMappingURL=main.8b16959d.chunk.js.map